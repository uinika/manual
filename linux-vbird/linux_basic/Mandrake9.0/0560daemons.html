<!DOCTYPE HTML PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html><head>


   <meta http-equiv="Content-Type" content="text/html; charset=utf8">
   <meta name="Author" content="VBird">
   <meta name="Description" content="daemons 的介绍">
   <title>鸟哥的 Linux 私房菜 -- 认识 Linux 系统服务的 daemons</title>
   	<script src="../../script/SpryMenuBar.js" type="text/javascript"></script>
	<script src="../../script/index.js" type="text/javascript"></script>
	<link href="../../css/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css" />
    <link href="../../css/main.css" rel="stylesheet" type="text/css" />

</head><body style="margin: 0pt; padding: 0pt;" class="table"onload="MM_preloadImages('../../index-2.html','../../index-2.html','../../index-2.html','../../index-2.html','../../index-2.html','../../index-2.html','../../index-2.html','../../index-2.html')">

<center>
<div id="apDiv5" align="left">
<div> <LINK REL="SHORTCUT ICON" HREF="../../index-2.html">
<!-- ImageReady Slices (title3.ai) -->
<table id="___01" width="898" height="81" border="0" align="center" cellpadding="0" cellspacing="0";>
	<tr>
		<td colspan="15">
			<img src="image/title/title_01.png" width="900" height="1" alt=""></td>
	</tr>
	<tr>
		<td rowspan="4" bgcolor="#182448"><p><img src="http://linux.vbird.org/cgi-bin/Count.cgi?dd=C&amp;ft=5&amp;sh=T&amp;md=8&amp;pad=Y&amp;df=vbird.dic.ksu.edu.tw.dat" width="93" align="left" title="計數器" /></p>
	    <p><font color="#FFFFFF" size="-1">since2012/04/23</font></p></td>
		<td rowspan="4" align="left" valign="top"><a href="../../index.html"><img src="image/title/title_03.png" alt="" width="263" height="79" border="0"></a></td>
		<td colspan="13">
			<img src="image/title/title_04.png" alt="" width="535" height="9" border="0"></td>
	</tr>
	<tr>
		<td rowspan="3">
			<img src="image/title/title_05.png" alt="" width="53" height="70" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../0110whatislinux.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image51','','image/title/title_06.png',1)"><img src="image/title/title3_06.png" name="Image51" width="106" height="25" border="0" id="Image51" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_07.png" alt="" width="27" height="37" border="0"></td>
		<td colspan="3" align="left" valign="top"><a href="../../linux_server/0110network_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image52','','image/title/title_08.png',1)"><img src="image/title/title3_08.png" name="Image52" width="107" height="25" border="0" id="Image52" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_09.png" alt="" width="37" height="37" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../../about.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image53','','image/title/title_10.png',1)"><img src="image/title/title3_10.png" name="Image53" width="75" height="25" border="0" id="Image53" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_11.png" alt="" width="35" height="70" border="0"></td>
		<td align="left" valign="top"><a href="mailto:vbird@mail.vbird.idv.tw" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image54','','image/title/title_12.png',1)"><img src="image/title/title3_12.png" name="Image54" width="74" height="25" border="0" id="Image54" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_13.png" alt="" width="21" height="70" border="0"></td>
	</tr>
	<tr>
		<td colspan="2">
			<img src="image/title/title_14.png" alt="" width="106" height="12" border="0"></td>
		<td colspan="3">
			<img src="image/title/title_15.png" alt="" width="107" height="12" border="0"></td>
		<td colspan="2">
			<img src="image/title/title_16.png" width="75" height="12" alt=""></td>
		<td rowspan="2">
			<img src="image/title/title_17.png" alt="" width="74" height="45" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/title_18.png" alt="" width="15" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar1" class="MenuBarHorizontal">
	  <li><a href="../linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image44','','image/title/title_19.png',1)"><img src="image/title/title3_19.png" name="Image44" width="123" height="33" border="0" id="Image44" /></a>
			    <ul>
			      <li><a href="mandrake9.0.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image46','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image46" width="120" height="26" border="0" id="Image46" alt="" /></a></li>
                  <li><a href="../fedora_4/fc4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image47','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image47" width="120" height="26" border="0" id="Image47" alt="" /></a></li>
                  <li><a href="../linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image48','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image48" width="120" height="26" border="0" id="Image48" alt="" /></a></li>
                </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_20.png" alt="" width="42" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar2" class="MenuBarHorizontal">
	  <li><a href="../../linux_server/index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image45','','image/title/title_21.png',1)"><img src="image/title/title3_21.png" name="Image45" width="125" height="33" border="0" id="Image45" /></a>
			    <ul>
			      <li><a href="../../linux_server/linux_redhat9/redhat9.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image43','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image43" width="120" height="26" border="0" id="Image43" alt=""/></a></li>
			      <li><a href="../../linux_server/centos4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image49','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image49" width="120" height="26" border="0" id="Image49" alt="" /></a></li>
			      <li><a href="../../linux_server/index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image50','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image50" width="120" height="26" border="0" id="Image50" alt="" /></a></li>
		        </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_22.png" alt="" width="47" height="33" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/Spacer.gif" width="101" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="263" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="53" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="15" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="91" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="27" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="5" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="42" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="60" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="37" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="28" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="47" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="35" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="74" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="22" height="1" alt=""></td>
	</tr>
</table>
<!-- End ImageReady Slices -->
<script type="text/javascript">
<!--
var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
var MenuBar2 = new Spry.Widget.MenuBar("MenuBar2", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
//-->
</script>
</div>
<div align="center"><font color="#3333ff"><font size="+2"><a href="http://linux.vbird.org/linux_basic/0560daemons/0560daemons.php" target="_self"><font face="标楷体">认识系统服务</font><font face="Times New Roman,Times">
daemons</font></a></font></font><br>
本文已不再维护，更新文章请参考 <a href="http://linux.vbird.org/linux_basic/0560daemons.php">此处</a></div>

<div align="right"><font face="新细明体"><font color="#3333ff"><font size="-1">最近更新日期：2003/02/11</font></font></font></div>
<font color="#000099"><font size="+1"><a href="#daemon">什么是 daemon</a>：</font><a href="#services">/etc/services</a>,
<a href="#name_rule">命名规则</a>,</font>
<br><font color="#000099"><font size="+1"><a href="#Whereisdaemon">系统的
Daemons 放在哪里</a>：</font> <a href="#init.d">/etc/rc.d/init.d/</a>,
<a href="#xinetd.conf">/etc/xinetd.conf</a>,
<a href="#xinetd.d">/etc/xinetd.d</a>,</font>
<br><font color="#000099"><font size="+1"><a href="#xinetd">解析 xinetd.conf</a></font></font>
<br><font color="#000099"><font size="+1"><a href="#tcp_wrappers">TCP_Wrappers
</a></font>：
/etc/hosts.allow, /etc/hosts.deny,</font>
<br><font color="#000099"><font size="+1"><a href="#open_services">系统开启的服务</a>：</font>
netstat, ntsysv, chkconfig,</font>
<br><font color="#000099"><font size="+1"><a href="#illustrations">各个服务的简单说明</a></font></font>
<br>
<hr width="100%"><a name="daemon"></a><font color="#000099"><font size="+1">什么是
daemon</font></font>
<blockquote>如果您常常上网去查看一些数据的话，尤其是关于 Unix-Like 的相关操作系统，如
FreeBSD, Unix, Linux 等等，应该会常常听到 daemons 这个字眼，那么 daemon
是什么东西呀！？怎么这么常被见到？呵呵，Daemon 的字面上的意思就是『守护神、恶魔？』还真是有点奇怪呦！
^_^"" 。基本上，我们的 Linux 主机常常会收到一些要求，不论是来自本机系统的要求或者是网络
Client 端的服务要求，反正只要有要求来的时候，通常就是各式各样的 daemons
负责去唤起应该要工作的 Servers 来工作啦！那么 daemons 目前有两种基本的模式，分别是
stand_alone 与 super daemon 两种方式，底下就来说一说这两种 daemon 的工作型态：
<ul>
<li>
<b><font color="#000099">&nbsp;stand_alone </font></b>： 就字面上的意思来说，stand
alone 就是『独立的启动』的意思，也就是说，该 daemon 启动之后，就直接常驻在内存当中啰！他虽然会一直的占用系统的资源，但最大的优点就是，他会一直启动的啦！所以当有要求来的时候，他就会很快速的响应啰！常常用在这一种
daemon 的网络服务如常见的 httpd 这一个即是一例！</li>
</ul>

<ul>
<li>
<b><font color="#000099">super daemon</font></b> ： 相对于 stand alone
的执行方式，这一种服务的启动方式则是藉由统一的一个 daemon 来负责唤起该服务！这一个统一负责的
daemon 就是 inet 这支服务啦！不过，在后来的 Linux 发展套件中，则是使用
xinet 这个设定啰！我们这里以 Mandrake 的 xinet 来做说明。当有网络的服务要求来的时候，该要求会先送给
xinet 这个服务，然后 xinet 根据该网络要求送来的数据封包的内容 ( 该内容会记录
IP 与 port ) 来将数据封包送给实际运作的服务！而该服务这个时候才会启动的！最常见到的就是
ftp 这支网络服务啦！这种最大的优点就是当没有数据封包来的时候，该服务不会一直占据系统资源
( 该服务会在 sleeping 的状态吧！ ) ，但是相对的，他的反应时间也会比较慢，因为还要花费一段时间去『唤醒』该服务呀！</li>
</ul>
那么这两种启动的方式哪一个比较好呢？见仁见智啦！而且还要看该主机的工作负荷与实际的用途说！例如当你的主机是用来作为
WWW 服务器的，那么 httpd 自然就以 stand alone 的启动方式较佳！事实上，我们常常开玩笑的说明
stand alone 与 super daemon 的情况，可以银行的窗口来作为说明的范例！
<ul>
<li>
<b><font color="#000099">stand alone</font></b> ： 在银行里面，假设有一种单一服务的窗口，例如存钱窗口，所以，当你需要存钱的时候，直接前往该窗口，就有『专人』为您服务啦！</li>
</ul>

<ul>
<li>
<b><font color="#000099">super daemon</font></b> ： 
在银行里面假设还有另外一种复合型态的窗口，同时提供转账、资金调度、提款等等的业务，那当你需要其中一项业务的时候，就需要前往该窗口，但是坐在窗口的
这个营业员，拿到你的需求单之后，往后面一丢『喂！那个转账的仁兄！该你的工作了』那么那个仁兄就开始工作去！然而里头还有资金调度与提款等负责业务的仁
兄呢？他们在干嘛？嘿嘿！看看报、喝喝茶啰！那么这里就会引出另外一个问题啦！假设银行今天的人潮特别的汹涌，所以这个窗口后面除了你之外还有很多的人！
那么想一想，这个窗口是要『一个完成再来下一个』还是『全部都把你们的单据拿来，我全部处理掉』呢？呵呵！是不是不太一样？</li>

<br>　
<ul>
<li>
<b><font color="#000066">multi-threaded</font></b>：就是我们提到的，全部的客户之要求都给他拿来，一次给他交办下去，所以一个服务同时会负责好几个程序。</li>
</ul>
　
<ul>
<li>
<b><font color="#000066">single-threaded</font></b>：这个就是目前我们『人类的银行』最常见的方式啦，不论如何，反正一个一个来，第一个没有处理完之前，后面的请排队！嘿嘿！所以如果
client 的要求突然大增的话，那么这些晚到的 client 可得等上一等！</li>
</ul>
</ul>
另外，需要注意的是，既然银行里头有这两种窗口同时存在，所以啰，在 Linux
系统里面，这两种 daemon 是可以同时存在的啦！也就是说，某些服务可以使用
stand alone 来启动，而有其他的服务则可以使用 xinet ( 或者是 inet ) 大致的情况就是这样啦！了呼！？
<ul>
<hr width="100%">
<li>
<a name="services"></a><b><font face="细明体"><font color="#000099">/etc/services</font></font></b></li>

<br>OOK！这个时候就又发生了另一个问题啰！那么我怎么知道要将我的数据送到那个窗口去！咦！那个窗口不是有写说明说他是干嘛用的吗？所以你要存钱、转账、或者是进行汇款，都可以在不同的窗口来完成，那么换到实际的网络情况来说呢，因为我们的
TCP 封包里面含有 port 与 IP 对吧！将那些已经监听的 port 想成是这些窗口，如此一来你的
TCP 封包便可以依据不同的需求，而到达不一样的 port 来索取服务了！因此，你的联机是
FTP, WWW, smtp 等等都好，绝对不会被搞错啦！
<br>　
<br>好了，如果我想要知道这个 port 是由那个服务所启动的呢？在 Linux 系统里面有个档案在说明那个窗口与服务的&nbsp;
( services and ports ) 对应！呵呵！那就是鼎鼎大名的 <b><font color="#000066">/etc/services
</font></b>这个档案啦！我们取一段常常看到的
port 与相关服务的区段来看一下好了！
<br>　
<table width="600" bgcolor="#000000" border="1" cols="1">
<tbody><tr>
<td><font face="细明体"><font color="#ffffff"><font size="-1">[root @test
root]# vi /etc/services</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">.... 略</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">ftp-data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
20/tcp</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">ftp-data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
20/udp</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">ftp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
21/tcp</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">ftp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
21/udp</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
22/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
#
 SSH Remote Login Protocol</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
22/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
#
 SSH Remote Login Protocol</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">telnet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
23/tcp</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">telnet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
23/udp</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">smtp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
25/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mail</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">smtp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
25/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mail</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">nameserver&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
42/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
# IEN 116</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">nameserver&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
42/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
# IEN 116</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
53/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nameserver&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
# name-domain server</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
53/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nameserver</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">.... 略</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">&lt;daemon
name&gt;&nbsp;&nbsp; &lt;port 与型态&gt;&nbsp;&nbsp; &lt; 该服务的说明 &gt;</font></font></font></td>
</tr>
</tbody></table>
　
<br>像上面说的是，第一栏为 daemon 的名称、第二栏为该 daemon 所使用的 port
号码与其网络数据封包传送时候的类型，主要为较稳定的 tcp 封包与较易破损但较快速之
udp 封包！举个例子说，那个 e-mail 的发信协议为 smtp 这个服务，而这个服务的使用之
port 即为 25 啦！就这样！
<br>　
<ul>
<li>
请特别注意！虽然有的时候您可以藉由修改 /etc/services 来更改一个服务的 port
号，不过并不建议如此做，因为很有可能会造成一些协议的错误情况！这里特此说明一番呦！（除非您要架设一个地下网站，否则的话，使用
/etc/services 原先的设定就好啦！）</li>
</ul>
</ul>

<ul>
<hr width="100%">
<li>
<a name="name_rule"></a><b><font color="#000099">Daemon 的命名规则：</font></b></li>

<br>每一个服务的开发者，当初在开发他们的服务时，都有特别的故事啦！不过，无论如何，这些服务的名称被建立之后，被挂上
Linux 使用时，通常在服务的名称之后会加上一个 d ，例如例行性命令的建立的
at, 与 cron 这两个服务，通常会被称为 atd 与 crond，这个 d 代表的就是 daemon
的意思。所以，在<a href="http://linux.vbird.org/linux_basic/0560daemons/0440processcontrol.php">资源管理</a>那一章中，我们使用了
ps 与 top 来观察程序时，都会发现到很多的 xxxd 的程序，呵呵！通常那就是一些
daemon 的程序啰！</ul>
</blockquote>

<hr width="100%"><a name="Whereisdaemon"></a><font color="#000099"><font size="+1">系统的
Daemons 放在哪里：</font></font>
<blockquote>好了！那么我们已经知道了 daemon 的作用之后，再来要讨论的是，那么他们启动的
scripts 是放在哪里呀！？呵呵！底下就来说一说啰：
<ul>
<li>
<b><font color="#000099">stand alone</font></b> ： 这个放置在 <font color="#000099">/etc/rc.d/init.d/
</font>这个目录里面，几乎所有的
RPM 安装的套件之启动项目都在这里啦！</li>
</ul>

<ul>
<li>
<b><font color="#000099">super daemon</font></b> ： 这个工作的那一支服务其实就是
<b>xinet</b>
或者是 <b>inet</b> 啦！请注意， <b>xinet</b> 也是一个 daemon 呢！他是 stand
alone 启动的，也就是他会一直在监听大家的需求，所以 xinet 的启动 scripts
写在 <font color="#000099">/etc/rc.d/init.d/xinetd</font> 这个 scripts
里面啰！但是挂在这个 daemon 里头的服务之设定项目呢？嗯！就是写在<font color="#000099">
/etc/xinetd.conf </font>与 <font color="#000099">/etc/xinetd.d/</font>
这个目录里面的任何档案！</li>
</ul>

<ul>
<hr width="100%">
<li>
<a name="init.d"></a><b><font face="细明体"><font color="#000099">/etc/rc.d/init.d/*</font></font></b></li>

<br>OK！先来了解一下 stand alone 的 daemon 是怎么启动的呢？！很简单，假如我们要启动
<a href="http://linux.vbird.org/linux_basic/0560daemons/0570syslog.php">syslog</a>
这支记录登录文件的服务，那么要启动他的话，就直接下达：
<ul>
<li>
<font face="细明体"><font color="#3333ff">/etc/rc.d/init.d/syslog start</font></font></li>

<li>
<font face="细明体"><font color="#3333ff">service syslog start</font></font></li>
</ul>
亦即是档名之后加上 start 即可，或者是使用 Red Hat 才有的这个 service script
来进行启动的功能！如果你还记得我们前几节提到过的 <a href="http://linux.vbird.org/linux_basic/0560daemons/0340bashshell-scripts.php">shell
scripts</a> 的话，那么或许还记得 <a href="http://linux.vbird.org/linux_basic/0560daemons/0340bashshell-scripts.php#case">case
..... esac</a> 这个有选择性的项目的语法吧！？没错！这几支服务就是以 bash
scripts 里头的 case 语法写成的！因此，只要加上后面的参数，如此一来， scripts
就会自动的去找寻执行档来执行啰！如果有兴趣的话，可以在你的系统里面的该目录下开一个档案来观看一下，就知道如何写啰！</ul>
</blockquote>

<blockquote>
<ul>
<hr width="100%">
<li>
<a name="xinetd.conf"></a><b><font face="细明体"><font color="#000099">/etc/xinetd.conf</font></font></b></li>

<br>这个档案就是设定 xinet 服务的参数档案啦！</ul>
</blockquote>

<blockquote>
<ul>
<hr width="100%">
<li>
<a name="xinetd.d"></a><b><font face="细明体"><font color="#000099">/etc/xinetd.d/*</font></font></b></li>

<br>这个目录里面的所有档案就是个别挂上 xinet 的所有服务啦！例如赫赫有名的
wu-ftpd 及 telnet 与 pop3 等等！</ul>
</blockquote>

<hr width="100%"><a name="xinetd"></a><font color="#000099"><font size="+1">解析
xinetd.conf</font></font>
<blockquote>一般而言，在 /etc/rc.d/init.d/ 里面的 scripts 都是发展者之
RPM 所提供的，如果您有兴趣自行发展你的软件的话，那么可以直接以这样的方式来独立启动的！不过，我们也可以经由
super daemon 来管理我们的服务，因为这个 super daemon 可以提供相当多的功能，尤其是安全性方面的功能，所以，我们就来谈一谈如何使用这个东西吧！
<br>　
<br>先来看一看预设的 /etc/xinetd.conf 这个档案的内容是什么吧！
<br>　
<table width="500" bgcolor="#000000" border="1" cols="1">
<tbody><tr>
<td><font face="细明体"><font color="#ffffff"><font size="-1">#</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1"># Simple configuration
file for xinetd</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">#</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1"># Some defaults,
and include /etc/xinetd.d/</font></font></font>
<p><font face="细明体"><font color="#ffffff"><font size="-1">defaults</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">{</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
instances&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= 60</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
log_type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= SYSLOG authpriv</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
log_on_success&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =
HOST PID</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
log_on_failure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =
HOST</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cps&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= 25 30</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">}</font></font></font>
</p><p><font face="细明体"><font color="#ffffff"><font size="-1">includedir /etc/xinetd.d</font></font></font></p></td>
</tr>

<tr>
<td><font face="细明体"><font color="#ffff00"><font size="-1">内容格式：</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">service &lt;service_name&gt;</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">{</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;attribute&gt; &lt;assign_op&gt; &lt;value&gt; &lt;value&gt; ...</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
...</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">}</font></font></font></td>
</tr>
</tbody></table>
　
<br>在上面的默认范例当中，说明的是：『<b><font color="#3333ff">如果没有指定的
services ( defaults ) 那么就用 {} 里面的设定来执行之！</font></b>』正常的情况之下有点像上面例子中的黄色字体所示，那个
&lt;&gt; 里头的数据我们先来说明一下：注：那个 <b><font color="#000099">assign_op</font></b>
主要有三种形式，分别如下：
<blockquote><font face="细明体"><font color="#000066">&nbsp;= ： 表示后面的设定参数就是这样啦！</font></font>
<br><font face="细明体"><font color="#000066">+= ： 表示后面的设定为『<b>在原来的设定里头加入新的参数</b>』</font></font>
<br><font face="细明体"><font color="#000066">-+ ： 表示后面的设定为『<b>在原来的参数舍弃这里输入的参数</b>！』</font></font></blockquote>
<font face="细明体">用途不太相同，敬请留意呦！好了！底下再来说一说那些
attribute 与 value ！</font>
<br>&nbsp;
<table width="800" border="1" cols="3">
<tbody><tr>
<td width="150" bgcolor="#ffcccc">
<center><font face="细明体">attribute</font>
<br><font face="细明体">(功能)</font></center>
</td>

<td width="150" bgcolor="#cccccc">
<center><font face="细明体">assing_op</font>
<br><font face="细明体">(允许的动作)</font></center>
</td>

<td bgcolor="#ccffff">
<center><font face="细明体">说明</font>
<br><font face="细明体">(范例)</font></center>
</td>
</tr>

<tr>
<td bgcolor="#ccffff"><b><font color="#000066">一般设定项目：</font></b></td>

<td bgcolor="#ccffff"></td>

<td bgcolor="#ccffff"></td>
</tr>

<tr>
<td>
<center><b><font face="细明体">disable</font></b></center>
</td>

<td>
<center><font face="细明体">yes</font>
<br><font face="细明体">no</font></center>
</td>

<td><font face="细明体">允许该 server 可以执行或者是不能执行！</font>
<br><font face="细明体">当设定为 <b><font color="#3333ff">yes</font></b>
表示该服务不能执行！</font></td>
</tr>

<tr>
<td>
<center><b><font face="细明体">socket_type</font></b></center>
</td>

<td>
<center><b><font face="细明体">stream</font></b>
<br><font face="细明体">dgram</font>
<br><font face="细明体">raw</font></center>
</td>

<td><font face="细明体">当联机为 TCP 封包时，则使用 stream 类型</font>
<br><font face="细明体">当联机为 UDP 封包时，则使用 dgram&nbsp; 类型</font>
<br><font face="细明体">raw 代表 server 需要与 IP 直接对谈！</font></td>
</tr>

<tr>
<td>
<center><font face="细明体">protocol</font></center>
</td>

<td>
<center><font face="细明体">tcp</font>
<br><font face="细明体">udp</font>
<br><font face="细明体">...</font></center>
</td>

<td><font face="细明体">这个东西说的是，联机的状态使用的是哪一种协议！？各个协议的代号可以参考
/etc/protocols 内容！此外，除非是你自己设定的服务，否则这个可以不用设定啦！</font></td>
</tr>

<tr>
<td>
<center><b><font face="细明体">wait</font></b></center>
</td>

<td>
<center><font face="细明体">yes</font>
<br><b><font face="细明体">no</font></b></center>
</td>

<td><font face="细明体">这就是我们刚刚提到的 <b><font color="#3333ff">Multi-threaded</font></b>
与 single-threaded 的方式啦！一般来说，我们希望大家的要求都可以同时被启用，所以可以设定
<b><font color="#3333ff">wait
= no</font></b></font></td>
</tr>

<tr>
<td>
<center><b><font face="细明体">user</font></b></center>
</td>

<td>
<center><font face="细明体">UID</font>
<br><font face="细明体">root</font></center>
</td>

<td><font face="细明体">还记得我们在 <a href="http://linux.vbird.org/linux_basic/0560daemons/0410accountmanager.php">账号管理</a>
那一篇提到的 UID 概念吗？对啦！这个 UID 就是那个 UID 啦！要注意的是，假如你的服务启动者不要以
root 为主的话，那么这个地方就可以改变其他的使用者，例如 nobody ！这个咚咚也会有安全防护的机制存在！此外，需要注意这个
UID 必须存在于 /etc/passwd 。</font></td>
</tr>

<tr>
<td>
<center><font face="细明体">group</font></center>
</td>

<td>
<center>GID</center>
</td>

<td>跟 user 的意思相同！只是这个 GID 的使用者也必须存在于 /etc/group 当中！</td>
</tr>

<tr>
<td>
<center><b><font face="细明体">instances</font></b></center>
</td>

<td>
<center><font face="细明体">number</font>
<br><font face="细明体">UNLIMITED</font></center>
</td>

<td><font face="细明体">这个是『<b><font color="#3333ff">在同一时间之内，同一个服务可以允许的联机数目</font></b>』的意思，你可以写入一个『<b><font color="#3333ff">数字</font></b>』来控制联机数目，也可以使用
<b><font color="#3333ff">UNLIMITED</font></b>
来告诉系统『<b><font color="#3333ff">没有上限</font></b>』啰！例如你在同时段之内仅允许
ftp 联机有 30 个，那么这里就可以输入 30 啦！</font></td>
</tr>

<tr>
<td>
<center><b><font face="细明体">nice</font></b></center>
</td>

<td>
<center><font face="细明体">-19 ~ 19</font></center>
</td>

<td><font face="细明体">还记得我们在 <a href="http://linux.vbird.org/linux_basic/0560daemons/0440processcontrol.php">程序管理</a>
里面谈到的那个 nice 指令吗？！对啦！这里就是这个东西啰！数字越小( 负值
)代表该程序越优先被执行！</font></td>
</tr>

<tr>
<td>
<center><b><font face="细明体">server</font></b></center>
</td>

<td>
<center><font face="细明体">program</font>
<br><font face="细明体">/usr/sbin/in.ftpd</font></center>
</td>

<td><font face="细明体">这个就是指出这个服务的启动程序！例如要启动 ftp
的话，其实就是 in.ftpd 这支程序啦！所以这个时候在这里输入 server = /usr/sbin/in.ftpd</font></td>
</tr>

<tr>
<td>
<center><b><font face="细明体">server_args</font></b></center>
</td>

<td>
<center><font face="细明体">一些参数</font></center>
</td>

<td><font face="细明体">这里应该输入的就是你的 server 那里需要输入的一些参数啦！例如
in.ftpd 当中，我们可能就需要输入 -l -a 这个参数说！</font></td>
</tr>

<tr>
<td>
<center><font face="细明体">log_on_success</font></center>
</td>

<td>
<center><font face="细明体">PID</font>
<br><b><font face="细明体">HOST</font></b>
<br><b><font face="细明体">USERID</font></b>
<br><font face="细明体">EXIT</font>
<br><b><font face="细明体">DURATION</font></b></center>
</td>

<td><font face="细明体">在『成功登入』之后，需要记录的项目：PID为纪录该
server 启动时候的 process ID ，HOST 为远程主机的 IP、USERID 为登入者的账号、EXTI
为离开的时候记录的项目、DURATION 为该用户使用此服务多久？</font></td>
</tr>

<tr>
<td>
<center><font face="细明体">log_on_failure</font></center>
</td>

<td>
<center><b><font face="细明体">HOST</font></b>
<br><b><font face="细明体">USERID</font></b>
<br><font face="细明体">ATTEMPT</font>
<br><font face="细明体">RECORD</font></center>
</td>

<td><font face="细明体">当登入失败之后被 syslog 登入的项目：HOST为远程主机的
IP，USERID为登入者账号、ATTEMPT为记录登入失败者企图的意图为何、RECORD为记录远程主机的信息！以及为何本机
server 不能启动的原因！主要有 login, shell, exec, finger 等指令可以使用在这里！(
基本上，可以在 /etc/hosts.allow 或 /etc/hosts.deny 书写内容 )。</font></td>
</tr>

<tr>
<td bgcolor="#ccffff"><b><font color="#000066">进阶设定项目：</font></b></td>

<td bgcolor="#ccffff"></td>

<td bgcolor="#ccffff"></td>
</tr>

<tr>
<td>
<center><font face="细明体">env</font></center>
</td>

<td>
<center><font face="细明体">'name=value'</font></center>
</td>

<td><font face="细明体">这一个项目可以让你设定环境变量，环境变量的设定规则可以参考
<a href="http://linux.vbird.org/linux_basic/0560daemons/0320bash.php#variable">认识
BASH Shell</a> 。</font></td>
</tr>

<tr>
<td>
<center><font face="细明体">port</font></center>
</td>

<td>
<center><font face="细明体">number</font></center>
</td>

<td><font face="细明体">这里可以设定不同的服务与对应的 port ，但是请记住你的
port 与服务名称必须与 /etc/services 内记载的相同才行！</font></td>
</tr>

<tr>
<td>
<center><font face="细明体">redirect</font></center>
</td>

<td>
<center><font face="细明体">IP_Address port</font></center>
</td>

<td><font face="细明体">将 client 端对我们 server 的要求，转到另一部主机上去！呵呵！这个好玩呦！例如当有人要使用你的
ftp 时，你可以将他转到另一部机器上面去！那个 IP_Address 就代表另一部远程主机的
IP 啰！</font></td>
</tr>

<tr>
<td>
<center><font face="细明体">includedir</font></center>
</td>

<td>
<center><font face="细明体">directory_path</font></center>
</td>

<td><font face="细明体">表示将某个目录底下的所有档案都给他塞进来 xinetd.conf
这个设定里头！这东西有用多了，如此一来我们可以一个一个设定不同的项目！而不需要将所有的服务都写在
xinetd.conf 当中！你可以在 /etc/xinetd.conf 发现这个设定呦！</font></td>
</tr>

<tr>
<td bgcolor="#ccffff"><b><font color="#000066">安全控管项目：</font></b></td>

<td bgcolor="#ccffff"></td>

<td bgcolor="#ccffff"></td>
</tr>

<tr>
<td>
<center><font face="细明体">bind</font></center>
</td>

<td>
<center><font face="细明体">IP_Address</font></center>
</td>

<td><font face="细明体">这个是设定『允许使用此一服务的适配卡』的意思！举个例子来说，你的
Linux 主机上面有两个 IP ，而你只想要让 IP1 可以使用此一服务，但 IP2 不能使用此服务，这里就可以将
IP1 写入即可！那么 IP2 就不可以使用此一 server 啰！</font></td>
</tr>

<tr>
<td>
<center><font face="细明体">interface</font></center>
</td>

<td>
<center><font face="细明体">IP_Address</font></center>
</td>

<td><font face="细明体">跟 bind 相同！</font></td>
</tr>

<tr>
<td>
<center><b><font face="细明体">only_from</font></b></center>
</td>

<td>
<center><font face="细明体">0.0.0.0</font>
<br><font face="细明体">192.168.1.0/24</font>
<br><font face="细明体">host_name</font>
<br><font face="细明体">domain_name</font></center>
</td>

<td><font face="细明体">这东西用在安全机制上面，也就是管制『<b><font color="#3333ff">只有这里面规定的
IP 或者是主机名可以登入！</font></b>』如果是 0.0.0.0 表示所有的 PC 皆可登入，如果是
192.168.1.0/24 则表示为 C class 的网域！亦即由 192.168.1.1 ~ 192.168.1.255
皆可登入！另外，也可以选择 domain name ，例如 .ev.ncku.edu.tw 就可以杜绝成大环工系的网域
IP 登入你的主机使用该 server ！</font></td>
</tr>

<tr>
<td>
<center><font face="细明体">no_access</font></center>
</td>

<td>
<center><font face="细明体">0.0.0.0</font>
<br><font face="细明体">192.168.1.0/24</font>
<br><font face="细明体">host_name</font>
<br><font face="细明体">domain_name</font></center>
</td>

<td><font face="细明体">跟 only_from 差不多啦！就是用来管理可否进入你的
Linux 主机启用你的 server 服务的管理项目！ no_access 表示『不可登入』的
PC 啰！</font></td>
</tr>

<tr>
<td>
<center><b><font face="细明体">access_times</font></b></center>
</td>

<td>
<center><font face="细明体">00:00-12:00</font>
<br><font face="细明体">HH:MM-HH:MM</font></center>
</td>

<td><font face="细明体">这个项目在设定『该服务 server 启动的时间』，使用的是
24 小时的设定！例如你的 ftp 要在 8 点到 16 点开放的话，就是： 08:00-16:00。</font></td>
</tr>

<tr>
<td>
<center><font face="细明体">umask</font></center>
</td>

<td>
<center><font face="细明体">000</font>
<br><font face="细明体">777</font>
<br><font face="细明体">022</font></center>
</td>

<td><font face="细明体">还记得在 <a href="http://linux.vbird.org/linux_basic/0560daemons/0210filepermission.php">档案权限</a>
里面约略提过的 <a href="http://linux.vbird.org/linux_basic/0560daemons/0220filemanager.php#umask">umask</a> 这个东西吗？呵呵！没错！就是那个鬼玩意儿啰！可以设定用户建立目录或者是档案时候的属性！系统建议值是
022 。</font></td>
</tr>
</tbody></table>

<p>当然上面的参数不需要每个都设定啦！只要设定需要的就可以啦！而在 /etc/xinetd.conf
这个档案当中，一定会看到『 includedir = /etc/xinetd.d 』这一行！这说明的是，除了
/etc/xinetd.conf 之外，所有在 /etc/xinetd.d 的档案都是可以用来设定的啦！！好了，我们来举个简单的
telnet 的例子吧！那就是 /etc/xinetd.d/telnet 这个档案，如果你的 Mandrake
9.0 当中没有这个档案，那表示还没有安装telnet-server-krb5-1.2.5-1mdk这个套件，请先安装他吧！然后，他的内容有点像这样：
<br>　
<table width="650" border="1" cols="1">
<tbody><tr>
<td bgcolor="#000000"><font face="细明体"><font color="#ffff00"><font size="-1">service
telnet</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">{</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　disable　　　　
= yes　　　　　　　　 </font><font color="#ff9900">&lt;==服务预设是关闭的</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　flags　　　　　
= REUSE　　　　　　　</font><font color="#ff9900"> &lt;==额外使用的参数</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　socket_type　　
= stream　　　　　　　</font><font color="#ff9900">&lt;==使用 tcp 封包常用的联机型态</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　wait　　　　　　=
no 　　　　　　　　</font><font color="#ff9900"> &lt;==不需等待，可以同时允许多个联机</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　user　　　　　　=
root　　　　　　　</font><font color="#ff9900">　&lt;==启动程序的用户身份</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　server　　　　　=
/usr/sbin/telnetd　</font><font color="#ff9900"> &lt;==服务启动的程序</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　server_args　　
= -a none 　　　　　　</font><font color="#ff9900">&lt;==上面那个程序的参数</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　log_on_failure　+=
USERID 　　　　　　</font><font color="#ff9900">&lt;==错误登入时，要记录下来的内容</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">}</font></font></font></td>
</tr>
</tbody></table>
　
<br>上面的表格中，已经说明了每一项参数的意义！如果原本的默认值你并不满意，那么你可以修改成比较安全与多一点机制。假设你这个
Linux 是一部主机，而且他有两块网络接口，分别是对外的 140.116.44.125 与对内的
192.168.0.254 这两个，如果你想要让对内的接口限制较松，而对外的限制较严格，你可以这样的来设定呢：
<br>　
<table width="700" border="1" cols="1">
<tbody><tr>
<td bgcolor="#000000"><font face="细明体"><font color="#ffffcc"><font size="-1">#
先针对对内的较为松散的限制来设定：</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">service telnet</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">{</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　disable　　　　
= no　　　　　　　　&nbsp; </font><font color="#ff9900">&lt;==预设就是启动
telnet 服务</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　bind
　　　　　 = 192.168.0.254　　　</font><font color="#ff9900"> &lt;==只允许经由这个适配卡的封包进来</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　only_from
　　　= 192.168.0.0/24　　</font><font color="#ff9900">　&lt;==只允许 192.168.0.0/24
这个网段</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　　　　　　　　　　　　　　　　　　　　　
</font><font color="#ff9900">的主机联机进来使用
telnet 的服务</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　instances
　　　= UNLIMITED 　　　　　</font><font color="#ff9900">&lt;==同时允许联机不限制！</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　nice
　　　　　 = 0 　　　　　　　　</font><font color="#ff9900">　&lt;==使用的优先级较高</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　flags　　　　　
= REUSE 　　　　　　</font><font color="#ff9900">　&lt;==额外使用的参数</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　socket_type
　　= stream　　　　　　</font><font color="#ff9900">　&lt;==使用 tcp 封包常用的联机型态</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　wait　　　　　　=
no　　　　　　　　</font><font color="#ff9900">　&lt;==不需等待，可以同时允许多个联机</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　user　　　　　　=
root　　　　　　　</font><font color="#ff9900">　&lt;==启动程序的用户身份</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　server
　　　　 = /usr/sbin/telnetd 　</font><font color="#ff9900">&lt;==服务启动的程序</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　server_args　　
= -a none 　　　　　</font><font color="#ff9900">　&lt;==上面那个程序的参数</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　log_on_failure　+=
USERID 　　　　</font><font color="#ff9900">　　&lt;==错误登入时，要记录下来的内容</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">}</font></font></font>
<p><font face="细明体"><font color="#ffffcc"><font size="-1"># 再针对外部的联机来进行限制呢！</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">service telnet</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">{</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　disable　　　　
= no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">
&lt;==预设就是启动 telnet 服务</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　bind
　　　　　 = 140.116.44.125&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">
&lt;==只允许经由这个适配卡的封包进来</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　only_from
　　　= 140.116.0.0/16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">
&lt;==只允许 140.116.0.0 ~ 140.116.255.255</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">
这个网段联机进来使用 telnet 的服务</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　only_from
　　　= .edu.tw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">
&lt;==重复设定，只有教务界才能联机！</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　no_access
　　　= 140.116.32.{10,26}&nbsp; </font><font color="#ff9900">&lt;==不许这些
PC 登入</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">　　　　access_times　　=
1:00-9:00 20:00-23:59</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">
&lt;==每天只有这两个时段开放服务</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　umask
　　　　　= 022&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">
&lt;==建立档案时的默认属性设定</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　instances
　　　= 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">
&lt;==同时只允许 10 个联机</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　nice　　　　　　=
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">
&lt;==使用的优先级较低</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　flags
　　　　　= REUSE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">
&lt;==额外使用的参数</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　socket_type
　　= stream&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">
&lt;==使用 tcp 封包常用的联机型态</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　wait　　　　　　=
no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">&nbsp;&nbsp;
&lt;==不需等待，可以同时允许多个联机</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　user　　　　　　=
root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">&nbsp;
&lt;==启动程序的用户身份</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　server　　　　　=
/usr/sbin/telnetd&nbsp;&nbsp;</font><font color="#ff9900"> &lt;==服务启动的程序</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　server_args
　　= -a none&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">&nbsp;
&lt;==上面那个程序的参数</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffff00">　　　　log_on_failure　+=
USERID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#ff9900">&nbsp;&nbsp;
&lt;==错误登入时，要记录下来的内容</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">}</font></font></font></p></td>
</tr>
</tbody></table>

</p><p>呵呵！如上面的设定，我们可以将 telnet 的启动项目进行更多的限制！如此一来，将有助于我们的安全防护呢！尤其如果可以针对不同的接口来设定，嘿嘿！就更加的棒啰！不过，请注意喔！如果照上面的设定，那么您的主机上面将会开了两个
23 port 的接口，分别是给两个接口来使用的呢！嗯！真好玩?同样的，你也可以针对自己的喜好来设定你的其他
daemon 使他挂在 xinetd 底下呢！</p></blockquote>

<hr width="100%"><a name="tcp_wrappers"></a><font color="#000099"><font size="+1">TCP_Wrappers</font></font>
<blockquote>好了，接着下来我们要来说一说，除了 xinetd 之外，还有另一个可以抵挡利用某些服务进入
Linux 主机的方法，那就是常常使用的 /etc/hosts.allow 与 /etc/hosts.deny
啰！这个方式是我们常常在使用的方法，这里先提几个比较简单的设定方式！注：
TCP_Wrappers 也可以当成一个最内层的防火墙了，因为是最内层，所以当然要设定的比较严格啰！
<br>　
<br>为什么叫做 TCP_Wrappers 呢？那么 wrappers 有包裹的意思，所以说，这个套件本身的功能就是在分析
TCP 网络数据封包啦！那么刚刚我们稍微提到我们网络的封包数据主要是以 TCP
封包为主，这个 TCP 封包的文件头至少记录了来源与目主机的 IP 与 port ，因此，若藉由分析
TCP 封包，就可以比对看我要不要让这个数据进入到主机里面来啰！所以啦，我们要使用
TCP_Wrappers 来控管的，就是
<ol>
<li>
<font face="细明体"><font color="#000066">来源 IP</font></font></li>

<li>
<font face="细明体"><font color="#000066">port (就是服务啦)</font></font></li>
</ol>
TCP_Wrappers 设定 TCP 封包是否可以进入的配置文件在 /etc/hosts.allow 与 /etc/hosts.deny
当中。因此，基本上，如果一个服务是受到 xinetd 或 TCP_Wrappers 的控制时，那么该服务就会受限于
hosts.allow 与 hosts.deny 的管理了！而如果你自己安装的套件当中( 亦即使用
Tarball 安装的方式之套件 )，除非有自行定义支持 TCP_Wrappers 的功能 ，否则就无法使用这个玩意啰！嘿嘿！
<br>　
<br>那么这两个档案是干嘛用的？刚刚不是提过哪！他主要是用来规范 TCP 封包的规则的，所以呢，里面记录的当然就是：『某些
IP 在特定服务中是否能够进入主机』！那么要怎么写？这两个档案的内容基本的语法是：
<br>　
<table width="500" bgcolor="#000000" border="1" cols="1">
<tbody><tr>
<td><font face="细明体"><font color="#ffffff"><font size="-1">&lt;service&gt;
: &lt;IP, domain, hostname...&gt; : &lt;allow|deny&gt;</font></font></font></td>
</tr>
</tbody></table>
　
<br>所以我们要先找出来那个 service_name 才行，例如以我们刚刚的 telnet 为例，那个
service_name 是什么呢？其实指的就是上表中 server 这个设定后面接的程序名称啦！所以，
telnet 在 Mandrake 底下的名称为 telnetd ( 注意，在其他的 distribution 中，这个名称可能会变，例如
Red Hat 或 OpenLinux 都是以 in.telnetd 为名！所以这里请参考您的系统里面的设定而定！)。
因此，如果你不想让 140.116.44.202 这个地址及 140.116.32.0/255.255.255.0
这个 C class 的网域进入你的主机的话，那么可以这样在 /etc/hosts.deny 里面设定：
<br>　
<table width="500" bgcolor="#000000" border="1" cols="1">
<tbody><tr>
<td><font face="细明体"><font size="-1"><font color="#ffffff">[root @test
root]#</font><font color="#ffff00"> vi /etc/hosts.deny</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">telnetd:&nbsp;
140.116.44.202 : deny</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">telnetd:&nbsp;
140.116.32.0/255.255.255.0 : deny</font></font></font></td>
</tr>
</tbody></table>
　
<br>这样一来，对方就无法以 telnet 进入你的主机啦！方便吧！不过，既然如此，为什么要设定成
/etc/hosts.allow 及 /etc/hosts.deny 两个档案呢？呵呵！基本上，他们两个的关系为：
<ol>
<li>
<font face="细明体"><font color="#000066">当档案 /etc/hosts.allow 存在时，则先以此档案内之设定为准；</font></font></li>

<li>
<font face="细明体"><font color="#000066">而在 /etc/hosts.allow 没有规定到的事项，将在
/etc/hosts.deny 当中继续设定！</font></font></li>
</ol>
也就是说， /etc/hosts.allow 的设定优先于 /etc/hosts.deny 啰！了解了吗？基本上，只要
hosts.allow 也就够了，因为我们可以将 allow 与 deny 都写在同一个档案内，只是这样一来似乎显得有点杂乱无章，因此，通常我们都是：
<ol>
<li>
<font face="细明体"><font color="#000066">允许进入的写在 /etc/hosts.allow
当中；</font></font></li>

<li>
<font face="细明体"><font color="#000066">不许进入的则写在 /etc/hosts.deny
当中。</font></font></li>
</ol>
&nbsp;再强调一次，那个 service_name 『必需』跟你的 xinetd 或者是 /etc/rc.d/init.d/*
里面的程序名称要相同。好了，我们还是以 telnet 为例子来说明好了，现在假设一个比较安全的流程来设定，就是：
<ol>
<li>
<font face="细明体"><font color="#000066">只允许 140.116.44.0/255.255.255.0
与 140.116.79.0/255.255.255.0 这两个网域，及 140.116.141.99 这个主机可以进入我们的
telnet 服务器；</font></font></li>

<li>
<font face="细明体"><font color="#000066">此外，其他的 IP 全部都挡掉！</font></font></li>
</ol>
这样则首先可以设定 /etc/hosts.allow 这个档案成为：
<br>　
<table width="500" bgcolor="#000000" border="1" cols="1">
<tbody><tr>
<td><font face="细明体"><font size="-1"><font color="#ffffff">[root @test
root]# </font><font color="#ffff00">vi /etc/hosts.allo</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">telnetd:&nbsp;
140.116.44.0/255.255.255.0 : allow</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">telnetd:&nbsp;
140.116.79.0/255.255.255.0 : allow</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">telnetd:&nbsp;
140.116.141.99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
: allow</font></font></font></td>
</tr>
</tbody></table>
　
<br>再来，设定 /etc/hosts.deny 成为『全部都挡掉』的状态：
<br>　
<table width="500" bgcolor="#000000" border="1" cols="1">
<tbody><tr>
<td><font face="细明体"><font size="-1"><font color="#ffffff">[root @test
root]# </font><font color="#ffff00">vi /etc/hosts.deny</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">telnetd:&nbsp;
ALL&nbsp;&nbsp;&nbsp;&nbsp; : deny</font></font></font></td>
</tr>
</tbody></table>
　
<br>那个 ALL 代表『全部』的意思！呵呵！很棒吧！那么有没有更安全的设定，例如，当当有其他人扫瞄我的
telnet port 时，我就将他的 IP 记住！以做为未来的查询与认证之用！那么你可以将
/etc/hosts.deny 这个档案改成这个样子：
<br>　
<table width="600" bgcolor="#000000" border="1" cols="1">
<tbody><tr>
<td><font face="细明体"><font size="-1"><font color="#ffffff">[root @test
root]# </font><font color="#ffff00">vi /etc/hosts.deny</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">telnetd: ALL
: spawn (echo Security notice from host `/bin/hostname`; \</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">echo; /usr/sbin/safe_finger
@%h ) | \</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffffff">/bin/mail -s
"%d-%h security" </font><font color="#ffff00">root</font><font color="#ffffff">
&amp; \</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">: twist ( /bin/echo
-e "\n\nWARNING connection not allowed. Your attempt has been logged. \n\n\n警告您尚未允许登入，您的联机将会被纪录，并且作为以后的参考\n\n
". )</font></font></font></td>
</tr>
</tbody></table>
　
<br>在上面的例子中，黄色字体字『 root 』，可以写成你的个人账号或者其他
e-mail ，以免很少以 root 身份登入 Linux 主机时，容易造成不知道的情况，另外，最后几行，亦即
:twist 之后的那几行为同一行。如此一来，当未经允许的计算机尝试登入你的主机时，对方的屏幕上就会显示上面的最后一行，并且将他的
IP 寄到 root （或者是你自己的信箱）那里去！（注：某些没有安装 tcp_wrappers
的套件之 distribution 中，由于没有 safe_finger 等程序，所以无法执行相关的功能，这点还请多加注意呢！）</blockquote>

<hr width="100%"><a name="open_services"></a><font color="#000099"><font size="+1">系统开启的服务</font></font>
<blockquote>好了，现在假设您已经知道了 daemons 的启动档案放置的目录，也知道了服务与
port 的对应，那么要如何查询目前系统上面已经启动了的服务呢？不要再打混了！已经学过了
ps 与 top 应该要会应用才对耶！呵呵！没错，可以使用 ps 与 top 来找寻已经启动了的服务的程序与他的
PID 呢！不过，我们怎么知道该服务启动的 port 是哪一个？呵呵！好问题！可以直接使用
netstat 这个网络状态观察指令来检查我们的 port 呢！甚至他也可以帮我们找到该
port 的程序呢( PID )！好了，那么我们就来试看看这个指令的用法吧！
<ul>
<li>
<a name="netstat"></a><b><font color="#000099">netstat</font></b></li>

<br>　
<table width="700" bgcolor="#000000" border="1" cols="1">
<tbody><tr>
<td><font face="细明体"><font size="-1"><font color="#ffffff">[root @test
/root]#</font><font color="#ffff00"> netstat [-r] [-i interface]&nbsp;</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffffff">[root @test
/root]# </font><font color="#ffff00">netstat [-antulp]&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffcc"><font size="-1">参数说明：&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ff9900"><font size="-1">-r&nbsp; ：显示出
route 的意思；&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ff9900"><font size="-1">-i&nbsp; ：显示出
interface 的内容，跟 ifconfig 类似啦！&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ff9900"><font size="-1">-a&nbsp; ：显示出目前所有的网络联机状态！&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ff9900"><font size="-1">-n&nbsp; ：默认情况中，显示出的
host 会以 host name 来显现，若为 n 则可以使 port 与 host 都以数字显示&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ff9900"><font size="-1">-t&nbsp; ：仅显示
tcp 封包的联机行为&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ff9900"><font size="-1">-u&nbsp; ：仅显示
udp 的封包联机状态&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ff9900"><font size="-1">-l&nbsp; ：仅显示
LISTEN 的内容&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ff9900"><font size="-1">-p&nbsp; ：同时显示此一联机的
PID 喔！(注意：只有 root 才能行使此功能！)&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffcc"><font size="-1">范例：&nbsp;</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffffff">[root @test
/root]# </font><font color="#ffff00">netstat -r</font><font color="#ffffff">

</font><font color="#ff9900">&lt;==嘿嘿！显示出目前的路由表！&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">Kernel IP routing
table&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">Destination&nbsp;&nbsp;&nbsp;&nbsp;
Gateway&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Genmask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Flags&nbsp;&nbsp; MSS Window&nbsp; irtt Iface&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">140.116.141.253
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
255.255.255.255 UH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 40 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0 ppp0&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">192.168.1.0&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
255.255.255.0&nbsp;&nbsp; U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 40
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 eth0&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">192.168.0.0&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
255.255.255.0&nbsp;&nbsp; U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 40
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 eth0&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">127.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
255.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
40 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 lo&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">default&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
140.116.141.253 0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
UG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 40 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0 ppp0&nbsp;</font></font></font>
<p><font face="细明体"><font size="-1"><font color="#ffffff">[root @test
/root]# </font><font color="#ffff00">netstat -i eth0</font><font color="#ffffff">&nbsp;</font><font color="#ffff00">
&lt;==看看底下显示出的内容，是否跟 ifconfig eth0 类似呀！？&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">Kernel Interface
table&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">Iface&nbsp;&nbsp;
MTU Met&nbsp;&nbsp; RX-OK RX-ERR RX-DRP RX-OVR&nbsp;&nbsp; TX-OK TX-ERR
TX-DRP TX-OVR Flg&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">eth0&nbsp;&nbsp;
1500&nbsp;&nbsp; 077199373&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 169616342&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 BMRU&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">lo&nbsp;&nbsp;&nbsp;
16436&nbsp;&nbsp; 0 1130485&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 1130485&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 LRU&nbsp;</font></font></font>
</p><p><font face="细明体"><font size="-1"><font color="#ffffff">[root @test
/root]# </font><font color="#ffff00">netstat -an&nbsp;</font><font color="#ff9900">
&lt;==显示所有的联机状态，并且以数字型态显示&nbsp;</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffffff">[root @test
/root]#</font><font color="#ffff00"> netstat -tul</font><font color="#ff9900">&lt;==显示
LISTEN 的及 tcp 与 udp 的联机状态，如下：&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">Active Internet
connections (only servers)&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">Proto Recv-Q
Send-Q Local Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Foreign Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0 
*:mysql&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:netbios-ssn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0 
*:pop3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0 
*:http&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0 
*:ftp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0 
*:ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0 
*:smtp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:netbios-ns&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ff9900"><font size="-1">注意：上面的
LISTEN 表示该 port 是已经在 监听 网络服务啦！而左边的 tcp 指的是 tcp 封包！&nbsp;</font></font></font>
</p><p><font face="细明体"><font size="-1"><font color="#ffffff">[root @test
/root]# </font><font color="#ffff00">netstat -anp | more</font><b><font color="#ff9900">&lt;==这个指令很常下达！请记得呦！</font></b></font></font>
<br>&nbsp;</p></td>
</tr>
</tbody></table>
　
<br>netstat 可是很了不起的指令，一定要学会的！尤其他可以让我们了解目前的你的主机的联机状态！与开启的
port 有哪些！所以一定得学会才行呀！如果你分别下达：
<br>　
<ul><font face="细明体"><font color="#000066">netstat -a&nbsp; | more</font></font>
<br><font face="细明体"><font color="#000066">netstat -an | more</font></font></ul>
　
<br>一定会发现有点奇怪？怎么有的 port 会以服务名称(例如上面例子里的 pop3
...)有的会以 port 号码来显示呢！？嘿嘿！那就是 /etc/services 以及 -n 这个参数的用途啦！你可以发现的是，如果
netstat -a 时，显示出来的 port 号码在 /etc/services 存在对应的服务名称的时候，那么默认他就会显示出该服务名称啦！但是若在
/etc/services 找不到档案的话，那么自然就还是以 port 号码来显示的！那么加上了
-n 参数后，不论如何，他都会以 port 及 IP 来显示啦！
<br>　
<br>另外，那个 -p 也很有用呦！尤其是在一些莫名其妙的联机出现时，可以用
netstat –anp | more查到 PID ，然后再以我们之前谈到的 系统资源管理 部分，利用
kill 来杀掉该 PID 的程序！ 此外，使用 netstat –tlp 也可以得到目前在 LISTEN
的 port 的服务名称，嘿嘿！那样就可以知道该 port 是那个程序来启动的！很便利ㄋㄟ?
<br>　
<ul>
<li>
<font color="#000099">Proto</font>：指的是封包或者是通讯协议啦！ tcp ,
udp 是常见的呦！</li>

<li>
<font color="#000099">Local Address</font>：本地端的 IP 与 Port 号，如果
/etc/services 存在对应服务名称，就以服务名称显示；</li>

<li>
<font color="#000099">Foreign Address</font> ：监听哪一个地区与 port ；</li>

<li>
<font color="#000099">state</font>：状态栏就很多啦！基本的有：</li>

<ul>
<li>
<font color="#000066">LISTEN </font>：亦即监听状态中的 port ！</li>

<li>
<font color="#000066">ESTABLISHED</font>：已建立联机的联机情况</li>

<li>
<font color="#000066">TIME_WAIT</font>：该联机在目前已经是等待的状态了！随时有可能会断线呦！</li>
</ul>
</ul>
　
<br>善用 netstat 可以查得相当多的网络信息！尤其在关闭本机的 port 时！假设我要将
ftp 关闭掉，那么要使用 <a href="http://linux.vbird.org/linux_basic/0560daemons/0550setup.php#ntsysv">ntsysv</a>, <a href="http://linux.vbird.org/linux_basic/0560daemons/0550setup.php#chkconfig">chkconfig</a>
以及看一下 /etc/rc.d/rc.local 里头的设定啰！请注意，这个时候仅是将『<b><font color="#000066">开机预设启动关闭』</font></b>而已，并没有实际关闭目前的服务，假设您发现
ftp 还在启动的项目，你要将他关闭，那么就必须：　</ul>
</blockquote>

<blockquote>
<ol>
<ol>
<li>
<font face="细明体"><font color="#000066">使用 ntsysv 或 chkconfig 将 wu-ftpd
前面的符号关闭掉；</font></font></li>

<li>
<font face="细明体"><font color="#000066">跳出之后，以 /etc/rc.d/init.d/xinet
restart 或者是 service xinet restart 来重新启动 xinet 这个服务；</font></font></li>

<li>
<font face="细明体"><font color="#000066">再以 netstat -a | more 看一下
ftp 是否还在 LISTEN 呢？</font></font></li>
</ol>
　
<br>这样才能关闭呢！同理可证啰！要关闭 sshd 怎么关？！嘿嘿！自己测试看看啰！(<i><font color="#000066">注意：事实上，在
Linux 系统中，要『开或关某个 port 』，就是需要『启动或关闭某个服务』啦！因此，你可以找出某个
port 对应的服务，程序对应的服务，进而启动或关闭他，那么那个经由该服务而启动的
port ，自然就会关掉了！</font></i>)</ol>
</blockquote>

<hr width="100%"><a name="illustrations"></a><font color="#000099"><font size="+1">各个服务的简单说明</font></font>
<blockquote>底下是一些 linux 系统上面常见的 daemons ，大家可以参考看看呦！
<br>&nbsp;
<table width="700" border="1" cols="2">
<tbody><tr>
<td width="150" bgcolor="#ffcccc">
<center>服务名称</center>
</td>

<td width="550" bgcolor="#ffcccc">
<blockquote>
<li>
参数档</li>

<li>
预设使用 port 号</li>

<li>
说明</li>

<li>
是否需要执行</li>
</blockquote>
</td>
</tr>

<tr>
<td>
<center>anacron</center>
</td>

<td>
<blockquote>
<li>
<b>/etc/anacrontab</b></li>

<li>
没有使用 port 号</li>

<li>
当你的 Linux 主机并不是全天候开机的时候，这个 anacron 就可以帮你执行在『
<a href="http://linux.vbird.org/linux_basic/0560daemons/0430cron.php#crontab">crontab</a>
』既定的时间内没有执行的工作！举个例子来说，当你的主机在晚上 12:00 会自动关闭，但是偏偏
crontab 这个例行性工作是在 4:00 工作，这个时候例行性工作不是都没有做到吗？嗯！
anacron 就可以使用啦！</li>

<li>
如果主机已经 24 小时开机，而且执行了 <a href="http://linux.vbird.org/linux_basic/0560daemons/0430cron.php">cron</a> ，那么这个程序就不需要启动了。</li>
</blockquote>
</td>
</tr>

<tr>
<td>
<center>apmd</center>
</td>

<td>
<ul>
<li>
<b>/etc/sysconfig/apmd</b></li>

<li>
没有使用 port 号</li>

<li>
apmd 是 Adventage Power Management daemon 的缩写，顾名思义，可以用来了解系统的『电池电量』，如果对于手提式计算机才有需要吧我想！</li>

<li>
基本上，我们使用的桌上型或者是一直开机的机型，大致上不需要使用此一 daemon。</li>
</ul>
</td>
</tr>

<tr>
<td>
<center>arpwatch</center>
</td>

<td>
<ul>
<li>
<b>/etc/sysconfig/arpwatch</b></li>

<li>
没有使用</li>

<li>
这是用来持续监测网络卡的『 Hardware IP (MAC) 与 Software IP (TCP/IP 那个
IP) 』对应的 daemon，还可以提供 e-mail 通知系统管理员呦！</li>

<li>
一般的主机<b>不太需要这个 daemon 啦</b>！</li>
</ul>
</td>
</tr>

<tr>
<td>
<center><b><font color="#3333ff">atd</font></b></center>
</td>

<td>
<ul>
<li>
<b>/etc/at.allow, /etc/at.deny</b></li>

<li>
没有使用 port 号</li>

<li>
这个总该不陌生了吧！就是单一使用的<a href="http://linux.vbird.org/linux_basic/0560daemons/0430cron.php">例行性命令</a>啰！如果忘记了！赶紧去查看一下！</li>

<li>
这个通常需要启动啦！不过，如果你一般都是使用 cron ，那么这个东西不启动影响也不很大！</li>
</ul>
</td>
</tr>

<tr>
<td>
<center>autofs</center>
</td>

<td>
<ul>
<li>
<b>/etc/rc.d/init.d/autofs</b></li>

<li>
没有使用 port 号</li>

<li>
这个东西使用在自动挂载一些装置的 daemon</li>

<li>
<b>不需要开启</b>！</li>
</ul>
</td>
</tr>

<tr>
<td><b><font size="-1">xinet</font></b>
<center>chargen&nbsp;
<br>chargen-udp</center>
</td>

<td>
<ul>
<li>
这东西主要的 port 号是 19 号；</li>

<li>
主要的功能在于提供类似远程打字的咚咚吧！我也不是很懂说....</li>

<li>
一般来说，不用启动啦！</li>
</ul>
</td>
</tr>

<tr>
<td>
<center><b><font color="#3333ff">crond</font></b></center>
</td>

<td>
<ul>
<li>
<b>/etc/crontab</b></li>

<li>
没有使用 port</li>

<li>
用来执行 <a href="http://linux.vbird.org/linux_basic/0560daemons/0430cron.php">例行性命令</a> 的 daemon！</li>

<li>
<b>务必启动</b>！</li>
</ul>
</td>
</tr>

<tr>
<td><b><font size="-1">xinet</font></b>
<center>daytime&nbsp;
<br>daytime-udp</center>
</td>

<td>
<ul>
<li>
这东西使用 13 port 号！</li>

<li>
用来作为 daytime 的服务，这是 NTP (Network Time Protocol) 的上一代，
目的在进行时间的校正工作。不过，因为他不会计算网络联机过程当中的迟滞时间，
并且是以名码传送，因此除了特殊目的外，目前已经很少使用这玩意儿了！</li>

<li>
<b>不用启动</b></li>
</ul>
</td>
</tr>

<tr>
<td><b><font size="-1">xinet</font></b>
<center>echo&nbsp;
<br>echo-udp</center>
</td>

<td>
<ul>
<li>
使用 port 7&nbsp;</li>

<li>
<b>不用启动啦</b>！</li>
</ul>
</td>
</tr>

<tr>
<td><b><font size="-1">xinet</font></b>
<center>finger</center>
</td>

<td>
<ul>
<li>
<b>/etc/xinetd.d/finger</b></li>

<li>
port 79</li>

<li>
最大的功能就是让远程的用户可以查看本地端的用户信息</li>

<li>
由于有安全上的顾虑，没有必要的话，<b>不要启动</b>！</li>
</ul>
</td>
</tr>

<tr>
<td>
<center>gpm</center>
</td>

<td>
<ul>
<li>
<b>/etc/sysconfig/mouse</b></li>

<li>
没有使用 port 号</li>

<li>
在文本模式里面可以使用 mouse 来从事『复制、贴上、移动光标』等等的功能！</li>

<li>
没必要的话，建议是『<b>关闭</b>』！</li>
</ul>
</td>
</tr>

<tr>
<td>
<center>httpd</center>
</td>

<td>
<ul>
<li>
<b>/etc/httpd/conf/httpd.conf</b></li>

<li>
使用 80 port 以及(或) 443&nbsp;</li>

<li>
这个就是鼎鼎大名的 WWW 主机服务开启的程序啦！</li>

<li>
看你的需求啰！有 WWW 则必须要启动！</li>
</ul>
</td>
</tr>
</tbody></table>
</blockquote>

<hr width="100%"><font face="新细明体"><font color="#000066"><font size="-1">2002/07/10：第一次完成</font></font></font>
<br>
<hr width="100%">
<center>
<font color="#000066"><font size="-1">Designed by <a href="mailto:vbird@mail.vbird.idv.tw">VBird</a>
during 2001-2004.&nbsp; Aerosol Lab.</font></font>
﻿<div id="apDiv4">
      <p>本网页主要以Firefox配合解析度 1024x768 作为设计依据&nbsp;&nbsp;&nbsp;&nbsp; 鸟哥自由软件整合应用研究室</p></div></center>
</div></center>
</body></html>
