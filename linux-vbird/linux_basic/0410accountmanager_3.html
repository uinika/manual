<html><head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf8">
	<meta name="Author" content="2011/04/19,lee">
	<meta name="Description" content="在 Linux 系统下管理用户的身份与账号！">
	<title>鸟哥的 Linux 私房菜 -- Linux 账号管理</title>
    <script src="../script/SpryMenuBar.js" type="text/javascript"></script>
	<script src="../script/index.js" type="text/javascript"></script>
	<link href="../css/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css" />
    <link href="../css/main.css" rel="stylesheet" type="text/css" />
    </head><body style="margin: 0pt; padding: 0pt;" class="table"onload="MM_preloadImages('../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html')">

<center>
<div id="apDiv5">
<div> <LINK REL="SHORTCUT ICON" HREF="../index-2.html">
<!-- ImageReady Slices (title3.ai) -->
<table id="___01" width="898" height="81" border="0" align="center" cellpadding="0" cellspacing="0";>
	<tr>
		<td colspan="15">
			<img src="image/title/title_01.png" width="900" height="1" alt=""></td>
	</tr>
	<tr>
		<td rowspan="4" bgcolor="#182448"><p><img src="http://linux.vbird.org/cgi-bin/Count.cgi?dd=C&amp;ft=5&amp;sh=T&amp;md=8&amp;pad=Y&amp;df=vbird.dic.ksu.edu.tw.dat" width="93" align="left" title="計數器" /></p>
	    <p><font color="#FFFFFF" size="-1">since2012/04/23</font></p></td>
		<td rowspan="4" align="left" valign="top"><a href="../index.html"><img src="image/title/title_03.png" alt="" width="263" height="79" border="0"></a></td>
		<td colspan="13">
			<img src="image/title/title_04.png" alt="" width="535" height="9" border="0"></td>
	</tr>
	<tr>
		<td rowspan="3">
			<img src="image/title/title_05.png" alt="" width="53" height="70" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="0110whatislinux.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image51','','image/title/title_06.png',1)"><img src="image/title/title3_06.png" name="Image51" width="106" height="25" border="0" id="Image51" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_07.png" alt="" width="27" height="37" border="0"></td>
		<td colspan="3" align="left" valign="top"><a href="../linux_server/0110network_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image52','','image/title/title_08.png',1)"><img src="image/title/title3_08.png" name="Image52" width="107" height="25" border="0" id="Image52" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_09.png" alt="" width="37" height="37" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../about.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image53','','image/title/title_10.png',1)"><img src="image/title/title3_10.png" name="Image53" width="75" height="25" border="0" id="Image53" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_11.png" alt="" width="35" height="70" border="0"></td>
		<td align="left" valign="top"><a href="mailto:vbird@mail.vbird.idv.tw" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image54','','image/title/title_12.png',1)"><img src="image/title/title3_12.png" name="Image54" width="74" height="25" border="0" id="Image54" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_13.png" alt="" width="21" height="70" border="0"></td>
	</tr>
	<tr>
		<td colspan="2">
			<img src="image/title/title_14.png" alt="" width="106" height="12" border="0"></td>
		<td colspan="3">
			<img src="image/title/title_15.png" alt="" width="107" height="12" border="0"></td>
		<td colspan="2">
			<img src="image/title/title_16.png" width="75" height="12" alt=""></td>
		<td rowspan="2">
			<img src="image/title/title_17.png" alt="" width="74" height="45" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/title_18.png" alt="" width="15" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar1" class="MenuBarHorizontal">
	  <li><a href="linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image44','','image/title/title_19.png',1)"><img src="image/title/title3_19.png" name="Image44" width="123" height="33" border="0" id="Image44" /></a>
			    <ul>
			      <li><a href="Mandrake9.0/mandrake9.0.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image46','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image46" width="120" height="26" border="0" id="Image46" alt="" /></a></li>
                  <li><a href="fedora_4/fc4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image47','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image47" width="120" height="26" border="0" id="Image47" alt="" /></a></li>
                  <li><a href="linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image48','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image48" width="120" height="26" border="0" id="Image48" alt="" /></a></li>
                </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_20.png" alt="" width="42" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar2" class="MenuBarHorizontal">
	  <li><a href="../linux_server/index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image45','','image/title/title_21.png',1)"><img src="image/title/title3_21.png" name="Image45" width="125" height="33" border="0" id="Image45" /></a>
			    <ul>
			      <li><a href="../linux_server/linux_redhat9/redhat9.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image43','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image43" width="120" height="26" border="0" id="Image43" alt=""/></a></li>
			      <li><a href="../linux_server/centos4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image49','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image49" width="120" height="26" border="0" id="Image49" alt="" /></a></li>
			      <li><a href="../linux_server/index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image50','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image50" width="120" height="26" border="0" id="Image50" alt="" /></a></li>
		        </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_22.png" alt="" width="47" height="33" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/Spacer.gif" width="101" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="263" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="53" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="15" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="91" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="27" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="5" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="42" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="60" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="37" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="28" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="47" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="35" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="74" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="22" height="1" alt=""></td>
	</tr>
</table>
<!-- End ImageReady Slices -->
<script type="text/javascript">
<!--
var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
var MenuBar2 = new Spry.Widget.MenuBar("MenuBar2", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
//-->
</script>
</div>
<table summary="本文内容的排版" style="width: 898px;" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
<tr><td style="width: 16px; font-size: 6px;">　</td>
    <td width="866">

<!-- 本文的档头部分 -->
<div style="text-align: center;">
    <a href="0410accountmanager.html">
    <span class="text_head0">第十四章、<span class="text_head_en">Linux </span>账号管理与<span class="text_head_en"> ACL </span>权限配置</span></a><br>
</div>
    <div style="text-align: right;">
        <span class="text_history">最近升级日期：2009/09/09</span>
    </div>
<!-- 本文的连结区部分 -->
<div class="block1">
<span class="text_h1">
3. <a href="#acl_talk">主机的细部权限规划：ACL 的使用</a><br>
	<span class="text_h2">
	　　3.1 <a href="#acl_talk_what">什么是 ACL</a><br>
	　　3.2 <a href="#acl_talk_how">如何启动 ACL</a><br>
	　　3.3 <a href="#acl_talk_cmd">ACL 的配置技巧</a>：
		<a href="#setfacl">setfacl</a>, <a href="#getfacl">getfacl</a>,
		ACL 的配置(<a href="#acl_user">user</a>, <a href="#acl_group">group</a>
		<a href="#acl_mask">mask</a>, <a href="#acl_default">default</a>)<br>
	</span>
</span></div>
<!-- 本文的正式部分 -->
<hr><a name="acl_talk"></a><img src="../image/logo.png" alt="大标题的图示" width="35" align="middle" height="34"><span class="text_h1">主机的细部权限规划：ACL 的使用</span><br>
<div class="block1">
	<p>从<a href="0210filepermission.html">第六章</a>开始，我们就一直强调 Linux 的权限概念是非常重要的！
	但是传统的权限仅有三种身份 (owner, group, others) 搭配三种权限 (r,w,x) 
	而已，并没有办法单纯的针对某一个使用者或某一个群组来配置特定的权限需求，例如前一小节最后的那个任务！
	此时就得要使用 ACL 这个机制啦！这玩意挺有趣的，底下我们就来谈一谈：<br><br></p>

	<hr><a name="acl_talk_what"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">什么是 ACL</span>
	<div class="block2">
		<p class="text_import2">ACL 是 Access Control List 的缩写，主要的目的是在提供传统的 
		owner,group,others 的 read,write,execute 权限之外的细部权限配置。ACL 
		可以针对单一使用者，单一文件或目录来进行 r,w,x 的权限规范，对于需要特殊权限的使用状况非常有帮助。</p>

		<p>那 ACL 主要可以针对哪些方面来控制权限呢？他主要可以针对几个项目：</p>

		<ul>
		<li>使用者 (user)：可以针对使用者来配置权限；</li>
		<li>群组 (group)：针对群组为对象来配置其权限；</li>
		<li>默认属性 (mask)：还可以针对在该目录下在创建新文件/目录时，规范新数据的默认权限；</li>
		</ul>

		<p>好了，再来看看如何让你的文件系统可以支持 ACL 吧！</p>
	</div>

	<hr><a name="acl_talk_how"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">如何启动 ACL</span><br>
	<div class="block2">
		<p>由于 ACL 是传统的 Unix-like 操作系统权限的额外支持项目，因此要使用 ACL 
		必须要有文件系统的支持才行。目前绝大部分的文件系统都有支持 ACL 的功能，包括 ReiserFS, EXT2/EXT3, JFS, XFS 
		等等。在我们的 CentOS 5.x 当中，默认使用 Ext3 是启动 ACL 支持的！至于察看你的文件系统是否支持 ACL 可以这样看：</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">mount</span>  <span class="term_note">&lt;==直接查阅挂载参数的功能</span>
/dev/hda2 on / type ext3 <span class="term_write">(rw)</span>
/dev/hda3 on /home type ext3 (rw)
<span class="term_say"># 其他项目鸟哥都将他省略了！假设我们只要看这两个装置。但没有看到 acl 喔！</span>

[root@www ~]# <span class="term_command">dumpe2fs -h /dev/hda2</span>  <span class="term_note">&lt;==由 superblock 内容去查询</span>
<span class="term_say">....(前面省略)....</span>
Default mount options:    user_xattr <span class="term_write">acl</span>
<span class="term_say">....(后面省略)....</span>
</pre></td></tr></tbody></table>

		<p>由 mount 单纯去查阅不见得可以看到实际的项目，由于目前新的 distributions 常常会主动加入某些默认功能，
		如上表所示，其实 CentOS 5.x 在默认的情况下 (Default mount options:) 就帮你加入 acl 的支持了！
		那如果你的系统默认不会帮你加上 acl 的支持呢？那你可以这样做：</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">mount -o remount,acl /</span>
[root@www ~]# <span class="term_command">mount</span>
/dev/hda2 on / type ext3 <span class="term_write">(rw,acl)</span>
<span class="term_say"># 这样就加入了！但是如果想要每次启动都生效，那就这样做：</span>

[root@www ~]# <span class="term_command">vi /etc/fstab</span>
LABEL=/1   /   ext3    defaults<span class="term_write">,acl</span>    1 1
</pre></td></tr></tbody></table>

		<p>如果你不确定或者是不会使用 dumpe2fs 观察你的文件系统，那么建议直接将上述的 /etc/fstab 里面的内容修改一下即可！</p>
	</div>

	<hr><a name="acl_talk_cmd"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">ACL 的配置技巧： getfacl, setfacl</span><br>
	<div class="block2">
		<p>好了，让你的 filesystem 启动 ACL 支持后，接下来该如何配置与观察 ACL 呢？ 很简单，利用这两个命令就可以了：</p>
		<ul>
		<li>getfacl：取得某个文件/目录的 ACL 配置项目；</li>
		<li>setfacl：配置某个目录/文件的 ACL 规范。</li>
		</ul>
		<p>先让我们来瞧一瞧 setfacl 如何使用吧！<br><br></p>

		<a name="setfacl"></a>
		<hr><ul class="list1"><li class="text_import1">setfacl 命令用法</li></ul>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">setfacl [-bkRd] [{-m|-x} acl参数] 目标文件名</span>
<span class="term_say">选项与参数：
-m ：配置后续的 acl 参数给文件使用，不可与 -x 合用；
-x ：删除后续的 acl 参数，不可与 -m 合用；
-b ：移除所有的 ACL 配置参数；
-k ：移除默认的 ACL 参数，关于所谓的『默认』参数于后续范例中介绍；
-R ：递归配置 acl ，亦即包括次目录都会被配置起来；
-d ：配置『默认 acl 参数』的意思！只对目录有效，在该目录新建的数据会引用此默认值</span>
</pre></td></tr></tbody></table>

		<p>上面谈到的是 acl 的选项功能，那么如何配置 ACL 的特殊权限呢？特殊权限的配置方法有很多，
		我们先来谈谈最常见的，就是针对单一使用者的配置方式：</p>

<a name="acl_user"></a>
<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd"># 1. 针对特定使用者的方式：</span>
<span class="term_say"># 配置规范：『 u:[使用者账号列表]:[rwx] 』，例如针对 vbird1 的权限规范 rx ：</span>
[root@www ~]# <span class="term_command">touch acl_test1</span>
[root@www ~]# <span class="term_command">ll acl_test1</span>
-rw-r--r-- 1 root root 0 Feb 27 13:28 acl_test1
[root@www ~]# <span class="term_command">setfacl -m u:vbird1:rx acl_test1</span>
[root@www ~]# <span class="term_command">ll acl_test1</span>
<span class="term_write">-rw-r-xr--+</span> 1 root root 0 Feb 27 13:28 acl_test1
<span class="term_say"># 权限部分多了个 + ，且与原本的权限 (644) 看起来差异很大！但要如何查阅呢？</span>

[root@www ~]# <span class="term_command">setfacl -m u::rwx acl_test1</span>
[root@www ~]# <span class="term_command">ll acl_test1</span>
-rwxr-xr--+ 1 root root 0 Feb 27 13:28 acl_test1
<span class="term_say"># 无使用者列表，代表配置该文件拥有者，所以上面显示 root 的权限成为 rwx 了！</span>
</pre></td></tr></tbody></table>

		<p>上述动作为最简单的 ACL 配置，利用『 u:使用者:权限 』的方式来配置的啦！配置前请加上 -m 这个选项。
		如果一个文件配置了 ACL 参数后，他的权限部分就会多出一个 + 号了！但是此时你看到的权限与实际权限可能就会有点误差！
		那要如何观察呢？就透过 getfacl 吧！<br><br></p>

		<a name="getfacl"></a>
		<hr><ul class="list1"><li class="text_import1">getfacl 命令用法</li></ul>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">getfacl filename</span>
<span class="term_say">选项与参数：
getfacl 的选项几乎与 setfacl 相同！所以鸟哥这里就免去了选项的说明啊！</span>

<span class="term_hd"># 请列出刚刚我们配置的 acl_test1 的权限内容：</span>
[root@www ~]# <span class="term_command">getfacl acl_test1</span>
# file: acl_test1   <span class="term_note">&lt;==说明档名而已！</span>
# owner: root       <span class="term_note">&lt;==说明此文件的拥有者，亦即 ll 看到的第三使用者字段</span>
# group: root       <span class="term_note">&lt;==此文件的所属群组，亦即 ll 看到的第四群组字段</span>
user::rwx           <span class="term_note">&lt;==使用者列表栏是空的，代表文件拥有者的权限</span>
<span class="term_write">user:vbird1:r-x</span>     <span class="term_note">&lt;==针对 vbird1 的权限配置为 rx ，与拥有者并不同！</span>
group::r--          <span class="term_note">&lt;==针对文件群组的权限配置仅有 r </span>
mask::r-x           <span class="term_note">&lt;==此文件默认的有效权限 (mask)</span>
other::r--          <span class="term_note">&lt;==其他人拥有的权限啰！</span>
</pre></td></tr></tbody></table>

		<p>上面的数据非常容易查阅吧？显示的数据前面加上 # 的，代表这个文件的默认属性，包括文件名、文件拥有者与文件所属群组。
		底下出现的 user, group, mask, other 则是属于不同使用者、群组与有效权限(mask)的配置值。
		以上面的结果来看，我们刚刚配置的 vbird1 对于这个文件具有 r 与 x 的权限啦！这样看的懂吗？
		如果看的懂的话，接下来让我们在测试其他类型的 setfacl 配置吧！</p>

<a name="acl_group"></a>
<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd"># 2. 针对特定群组的方式：</span>
<span class="term_say"># 配置规范：『 g:[群组列表]:[rwx] 』，例如针对 mygroup1 的权限规范 rx ：</span>
[root@www ~]# <span class="term_command">setfacl -m g:mygroup1:rx acl_test1</span>
[root@www ~]# <span class="term_command">getfacl acl_test1</span>
# file: acl_test1
# owner: root
# group: root
user::rwx
user:vbird1:r-x
group::r--
<span class="term_write">group:mygroup1:r-x</span>  <span class="term_note">&lt;==这里就是新增的部分！多了这个群组的权限配置！</span>
mask::r-x
other::r--
</pre></td></tr></tbody></table>

		<a name="acl_mask"></a>
		<p>基本上，群组与使用者的配置并没有什么太大的差异啦！如上表所示，非常容易了解意义。不过，你应该会觉得奇怪的是，
		那个 mask 是什么东西啊？其实他有点像是『有效权限』的意思！他的意义是：<span class="text_import2">
		使用者或群组所配置的权限必须要存在于 mask 的权限配置范围内才会生效，此即『有效权限 (effective permission)』</span>
		我们举个例子来看，如下所示：</p>

<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd"># 3. 针对有效权限 mask 的配置方式：</span>
<span class="term_say"># 配置规范：『 m:[rwx] 』，例如针对刚刚的文件规范为仅有 r ：</span>
[root@www ~]# <span class="term_command">setfacl -m m:r acl_test1</span>
[root@www ~]# <span class="term_command">getfacl acl_test1</span>
# file: acl_test1
# owner: root
# group: root
user::rwx
<span class="term_write">user:vbird1:r-x        #effective:r--</span> <span class="term_note">&lt;==vbird1+mask均存在者，仅有 r 而已！</span>
group::r--
<span class="term_write">group:mygroup1:r-x     #effective:r--
mask::r--</span>
other::r--
</pre></td></tr></tbody></table>

		<p>您瞧，vbird1 与 mask 的集合发现仅有 r 存在，因此 vbird1 仅具有 r 的权限而已，并不存在 x 权限！这就是 mask 
		的功能了！我们可以透过使用 mask 来规范最大允许的权限，就能够避免不小心开放某些权限给其他使用者或群组了。
		不过，通常鸟哥都是将 mask 配置为 rwx 啦！然后再分别依据不同的使用者/群组去规范她们的权限就是了。</p>

<table border="1" cellpadding="5" cellspacing="0" width="90%"><tbody><tr><td>
例题：<div class="block2">
将前一小节任务二中 /srv/projecta 这个目录，让 myuser1 可以进入查阅，但 myuser1 不具有修改的权力。
</div>
答：<div class="block2">
由于 myuser1 是独立的使用者与群组，而 /srv 是附属于 / 之下的，因此 /srv 已经具有 acl 的功能。
透过如下的配置即可搞定：<br>

<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd"># 1. 先测试看看，使用 myuser1 能否进入该目录？</span>
[myuser1@www ~]$ <span class="term_command">cd /srv/projecta</span>
-bash: cd: /srv/projecta: Permission denied  <span class="term_note">&lt;==确实不可进入！</span>

<span class="term_hd"># 2. 开始用 root 的身份来配置一下该目录的权限吧！</span>
[root@www ~]# <span class="term_command">setfacl -m u:myuser1:rx /srv/projecta</span>
[root@www ~]# <span class="term_command">getfacl /srv/projecta</span>
# file: srv/projecta
# owner: root
# group: projecta
user::rwx
<span class="term_write">user:myuser1:r-x</span>  <span class="term_note">&lt;==还是要看看有没有配置成功喔！</span>
group::rwx
mask::rwx
other::---

<span class="term_hd"># 3. 还是得要使用 myuser1 去测试看看结果！</span>
[myuser1@www ~]$ <span class="term_command">cd /srv/projecta</span>
[myuser1@www projecta]$ <span class="term_command">ll -a</span>
drwxrws---+ 2 root projecta 4096 Feb 27 11:29 .  <span class="term_note">&lt;==确实可以查询档名</span>
drwxr-xr-x  4 root root     4096 Feb 27 11:29 ..

[myuser1@www projecta]$ <span class="term_command">touch testing</span>
touch: cannot touch `testing': Permission denied <span class="term_note">&lt;==确实不可以写入！</span>
</pre></td></tr></tbody></table>
请注意，上述的 1, 3 步骤使用 myuser1 的身份，2步骤才是使用 root 去配置的！
</div>
</td></tr></tbody></table><br>

		<p>上面的配置我们就完成了之前任务二的后续需求喔！这么简单呢！接下来让我们来测试一下，如果我用 root 
		或者是 pro1 的身份去 /srv/projecta 添加文件或目录时，该文件或目录是否能够具有 ACL 的配置？
		意思就是说，<span class="text_import2">ACL 的权限配置是否能够被次目录所『继承？』</span>先试看看：</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">cd /srv/projecta</span>
[root@www ~]# <span class="term_command">touch abc1</span>
[root@www ~]# <span class="term_command">mkdir abc2</span>
[root@www ~]# <span class="term_command">ll -d abc*</span>
-rw-r--r-- 1 root projecta    0 Feb 27 14:37 abc1
drwxr-sr-x 2 root projecta 4096 Feb 27 14:37 abc2
</pre></td></tr></tbody></table>

		<p>你可以明显的发现，权限后面都没有 + ，代表这个 acl 属性并没有继承喔！如果你想要让 acl 
		在目录底下的数据都有继承的功能，那就得如下这样做了！</p>

<a name="acl_default"></a>
<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd"># 4. 针对默认权限的配置方式：</span>
<span class="term_say"># 配置规范：『 d:[ug]:使用者列表:[rwx] 』</span>

<span class="term_hd"># 让 myuser1 在 /srv/projecta 底下一直具有 rx 的默认权限！</span>
[root@www ~]# <span class="term_command">setfacl -m d:u:myuser1:rx /srv/projecta</span>
[root@www ~]# <span class="term_command">getfacl /srv/projecta</span>
# file: srv/projecta
# owner: root
# group: projecta
user::rwx
user:myuser1:r-x
group::rwx
mask::rwx
other::---
default:user::rwx
<span class="term_write">default:user:myuser1:r-x</span>
default:group::rwx
default:mask::rwx
default:other::---

[root@www ~]# <span class="term_command">cd /srv/projecta</span>
[root@www projecta]# <span class="term_command">touch zzz1</span>
[root@www projecta]# <span class="term_command">mkdir zzz2</span>
[root@www projecta]# <span class="term_command">ll -d zzz*</span>
<span class="term_write">-rw-rw----+</span> 1 root projecta    0 Feb 27 14:57 zzz1
<span class="term_write">drwxrws---+</span> 2 root projecta 4096 Feb 27 14:57 zzz2
<span class="term_say"># 看吧！确实有继承喔！然后我们使用 getfacl 再次确认看看！</span>

[root@www projecta]# <span class="term_command">getfacl zzz2</span>
# file: zzz2
# owner: root
# group: projecta
user::rwx
user:myuser1:r-x
group::rwx
mask::rwx
other::---
default:user::rwx
default:user:myuser1:r-x
default:group::rwx
default:mask::rwx
default:other::---
</pre></td></tr></tbody></table>

		<p>透过这个『针对目录来配置的默认 ACL 权限配置值』的项目，我们可以让这些属性继承到次目录底下呢！
		非常方便啊！那如果想要让 ACL 的属性全部消失又要如何处理？透过『 setfacl -b 檔名 』即可啦！
		太简单了！鸟哥就不另外介绍了！请自行测试测试吧！</p>
	</div>
</div>
<hr />
    </td>
    <td style="width: 16px; font-size: 6px;">　</td></tr>
<tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
</tbody></table>

<div style="padding-top: 0px; text-align: center;">
<span style="font-size: 80%;">
	<a href="http://linux.vbird.org/" target="_top" title="前往鸟哥的首页">http://linux.vbird.org</a>
	is designed by <a href="mailto:vbird@mail.vbird.idv.tw" title="联络鸟哥(我不要广告信！)">VBird</a>
		during 2001-2011. <a href="http://www.ksu.edu.tw/" target="_blank">ksu.edu</a></span>
         ﻿<div id="apDiv4">
      <p>本网页主要以Firefox配合解析度 1024x768 作为设计依据&nbsp;&nbsp;&nbsp;&nbsp; 鸟哥自由软件整合应用研究室</p></div></div>
</div>
</center>
</body></html>
