<html><head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="Author" content="2011/04/20,white">
	<meta name="Description" content="包括了 crontab 与 at 这两支程序啦！">
	<title>鸟哥的 Linux 私房菜 -- 例行性工作排程的创建</title>
    <script src="../script/SpryMenuBar.js" type="text/javascript"></script>
	<script src="../script/index.js" type="text/javascript"></script>
	<link href="../css/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css" />
    <link href="../css/main.css" rel="stylesheet" type="text/css" />
    </head><body style="margin: 0pt; padding: 0pt;" class="table"onload="MM_preloadImages('../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html')">

<center>
<div id="apDiv5">
<div> <LINK REL="SHORTCUT ICON" HREF="../index-2.html">
<!-- ImageReady Slices (title3.ai) -->
<table id="___01" width="898" height="81" border="0" align="center" cellpadding="0" cellspacing="0";>
	<tr>
		<td colspan="15">
			<img src="image/title/title_01.png" width="900" height="1" alt=""></td>
	</tr>
	<tr>
		<td rowspan="4" bgcolor="#182448"><p><img src="http://linux.vbird.org/cgi-bin/Count.cgi?dd=C&amp;ft=5&amp;sh=T&amp;md=8&amp;pad=Y&amp;df=vbird.dic.ksu.edu.tw.dat" width="93" align="left" title="計數器" /></p>
	    <p><font color="#FFFFFF" size="-1">since2012/04/23</font></p></td>
		<td rowspan="4" align="left" valign="top"><a href="../index.html"><img src="image/title/title_03.png" alt="" width="263" height="79" border="0"></a></td>
		<td colspan="13">
			<img src="image/title/title_04.png" alt="" width="535" height="9" border="0"></td>
	</tr>
	<tr>
		<td rowspan="3">
			<img src="image/title/title_05.png" alt="" width="53" height="70" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="0110whatislinux.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image51','','image/title/title_06.png',1)"><img src="image/title/title3_06.png" name="Image51" width="106" height="25" border="0" id="Image51" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_07.png" alt="" width="27" height="37" border="0"></td>
		<td colspan="3" align="left" valign="top"><a href="../linux_server/0110network_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image52','','image/title/title_08.png',1)"><img src="image/title/title3_08.png" name="Image52" width="107" height="25" border="0" id="Image52" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_09.png" alt="" width="37" height="37" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../about.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image53','','image/title/title_10.png',1)"><img src="image/title/title3_10.png" name="Image53" width="75" height="25" border="0" id="Image53" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_11.png" alt="" width="35" height="70" border="0"></td>
		<td align="left" valign="top"><a href="mailto:vbird@mail.vbird.idv.tw" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image54','','image/title/title_12.png',1)"><img src="image/title/title3_12.png" name="Image54" width="74" height="25" border="0" id="Image54" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_13.png" alt="" width="21" height="70" border="0"></td>
	</tr>
	<tr>
		<td colspan="2">
			<img src="image/title/title_14.png" alt="" width="106" height="12" border="0"></td>
		<td colspan="3">
			<img src="image/title/title_15.png" alt="" width="107" height="12" border="0"></td>
		<td colspan="2">
			<img src="image/title/title_16.png" width="75" height="12" alt=""></td>
		<td rowspan="2">
			<img src="image/title/title_17.png" alt="" width="74" height="45" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/title_18.png" alt="" width="15" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar1" class="MenuBarHorizontal">
	  <li><a href="linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image44','','image/title/title_19.png',1)"><img src="image/title/title3_19.png" name="Image44" width="123" height="33" border="0" id="Image44" /></a>
			    <ul>
			      <li><a href="Mandrake9.0/mandrake9.0.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image46','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image46" width="120" height="26" border="0" id="Image46" alt="" /></a></li>
                  <li><a href="fedora_4/fc4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image47','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image47" width="120" height="26" border="0" id="Image47" alt="" /></a></li>
                  <li><a href="linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image48','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image48" width="120" height="26" border="0" id="Image48" alt="" /></a></li>
                </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_20.png" alt="" width="42" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar2" class="MenuBarHorizontal">
	  <li><a href="../linux_server/index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image45','','image/title/title_21.png',1)"><img src="image/title/title3_21.png" name="Image45" width="125" height="33" border="0" id="Image45" /></a>
			    <ul>
			      <li><a href="../linux_server/linux_redhat9/redhat9.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image43','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image43" width="120" height="26" border="0" id="Image43" alt=""/></a></li>
			      <li><a href="../linux_server/centos4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image49','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image49" width="120" height="26" border="0" id="Image49" alt="" /></a></li>
			      <li><a href="../linux_server/index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image50','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image50" width="120" height="26" border="0" id="Image50" alt="" /></a></li>
		        </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_22.png" alt="" width="47" height="33" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/Spacer.gif" width="101" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="263" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="53" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="15" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="91" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="27" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="5" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="42" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="60" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="37" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="28" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="47" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="35" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="74" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="22" height="1" alt=""></td>
	</tr>
</table>
<!-- End ImageReady Slices -->
<script type="text/javascript">
<!--
var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
var MenuBar2 = new Spry.Widget.MenuBar("MenuBar2", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
//-->
</script>
</div>
<table summary="本文内容的排版" style="width: 898px;" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
<tr><td style="width: 16px; font-size: 6px;">　</td>
    <td width="866">

<!-- 本文的档头部分 -->
<div style="text-align: center;">
    <a href="0430cron.html">
    <span class="text_head0">第十六章、例行性工作排程<span class="text_head_en"> (crontab)</span></span></a><br>
</div>
    <div style="text-align: right;">
        <span class="text_history">最近升级日期：2009/09/11</span>
    </div>
<!-- 本文的连结区部分 -->
<div class="block1">
<span class="text_h1">
2. <a href="#atjob">仅运行一次的工作排程</a><br>
	<span class="text_h2">
	　　2.1 <a href="#atjob_how">atd 的启动与 at 运行的方式</a>： <a href="#at_deny">/etc/at.deny</a><br>
	　　2.2 <a href="#atjob_work">实际运行单一工作排程</a>： <a href="#at">at</a>,
		<a href="#atq_atrm">atq &amp; atrm</a>, <a href="#batch">batch</a><br>
	</span>
</span></div>
<!-- 本文的正式部分 -->
<hr><a name="atjob"></a><img src="../image/logo.png" alt="大标题的图示" width="35" align="middle" height="34"><span class="text_h1">仅运行一次的工作排程</span><br>
<div class="block1">
	<p>首先，我们先来谈谈单一工作排程的运行，那就是 at 这个命令的运行！<br><br></p>

	<hr><a name="atjob_how"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">atd 的启动与 at 运行的方式</span><br>
	<div class="block2">
		<p>要使用单一工作排程时，我们的 Linux 系统上面必须要有负责这个排程的服务，那就是 atd 这个玩意儿。
		不过并非所有的 Linux distributions 都默认会把他打开的，所以呢，某些时刻我们必须要手动将他激活才行。
		激活的方法很简单，就是这样：</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">/etc/init.d/atd restart</span>
正在停止 atd:                          [  确定  ]
正在启动 atd:                          [  确定  ]

<span class="term_hd"># 再配置一下启动时就启动这个服务，免得每次重新启动都得再来一次！</span>
[root@www ~]# <span class="term_command">chkconfig atd on</span>
</pre></td></tr></tbody></table>

		<p>重点是那个『正在启动(或 starting)』项目的 OK 啦！那表示启动是正常的！这部份我们在<a href="0560daemons.html">第十八章</a>会谈及。
		如果您真的有兴趣，那么可以自行到 /etc/init.d/atd 这个 shell script 内去瞧一瞧先！ ^_^。
		至於那个 chkconfig ，你也可以使用 man 先查阅一下啊！我们<a href="0560daemons.html#chkconfig">第十八章</a>再介绍啦！<br><br></p>

		<hr><ul class="list1"><li class="text_import1">at 的运行方式</li></ul>

		<p>既然是工作排程，那么应该会有产生工作的方式，并且将这些工作排进行程表中罗！OK！那么产生工作的方式是怎么进行的？
		事实上，<span class="text_import2">我们使用 at 这个命令来产生所要运行的工作，并将这个工作以文字档的方式写入
		/var/spool/at/ 目录内，该工作便能等待 atd 这个服务的取用与运行了</span>。就这么简单。</p>

		<p>不过，并不是所有的人都可以进行 at 工作排程喔！为什么？因为安全的理由啊～
		很多主机被所谓的『绑架』后，最常发现的就是他们的系统当中多了很多的怪客程序 (cracker program)，
		这些程序非常可能运用工作排程来运行或搜集系统资讯，并定时的回报给怪客团体！
		所以罗，除非是你认可的帐号，否则先不要让他们使用 at 吧！那怎么达到使用 at 的列管呢？</p>

		<a name="at_deny"></a>
		<p>我们可以利用 /etc/at.allow 与 /etc/at.deny 这两个文件来进行 at 的使用限制呢！
		加上这两个文件后， at 的工作情况其实是这样的：</p>

		<ol class="text_import2">
		<li>先找寻 <b>/etc/at.allow</b> 这个文件，写在这个文件中的使用者才能使用 at
		，没有在这个文件中的使用者则不能使用 at (即使没有写在 at.deny 当中)；<br><br></li>
		<li>如果 /etc/at.allow 不存在，就寻找<b> /etc/at.deny</b> 这个文件，若写在这个
		at.deny 的使用者则不能使用 at ，而没有在这个 at.deny 文件中的使用者，就可以使用
		at 咯；<br><br></li>
		<li>如果两个文件都不存在，那么只有 root 可以使用 at 这个命令。</li>
		</ol>

		<p>透过这个说明，我们知道 /etc/at.allow 是管理较为严格的方式，而 /etc/at.deny 则较为松散 
		(因为帐号没有在该文件中，就能够运行 at 了)。在一般的 distributions 当中，由於假设系统上的所有用户都是可信任的，
		因此系统通常会保留一个空的 /etc/at.deny 文件，意思是允许所有人使用 at 命令的意思 (您可以自行检查一下该文件)。
		不过，万一你不希望有某些使用者使用 at 的话，将那个使用者的帐号写入 /etc/at.deny 即可！
		一个帐号写一行。</p>
	</div>


	<hr><a name="atjob_work"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">实际运行单一工作排程</span><br>
	<div class="block2">
		<a name="at"></a>
		<p>单一工作排程的进行就使用 at 这个命令罗！这个命令的运行非常简单！将 at 加上一个时间即可！基本的语法如下：</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">at [-mldv] TIME</span>
[root@www ~]# <span class="term_command">at -c 工作号码</span>
<span class="term_say">选项与参数：
-m  ：当 at 的工作完成后，即使没有输出信息，亦以 email 通知使用者该工作已完成。
-l  ：at -l 相当於 atq，列出目前系统上面的所有该使用者的 at 排程；
-d  ：at -d 相当於 atrm ，可以取消一个在 at 排程中的工作；
-v  ：可以使用较明显的时间格式列出 at 排程中的工作列表；
-c  ：可以列出后面接的该项工作的实际命令内容。

TIME：时间格式，这里可以定义出『什么时候要进行 at 这项工作』的时间，格式有：
  HH:MM				ex&gt; 04:00
	在今日的 HH:MM 时刻进行，若该时刻已超过，则明天的 HH:MM 进行此工作。
  HH:MM YYYY-MM-DD		ex&gt; 04:00 2009-03-17
	强制规定在某年某月的某一天的特殊时刻进行该工作！
  HH:MM[am|pm] [Month] [Date]	ex&gt; 04pm March 17
	也是一样，强制在某年某月某日的某时刻进行！
  HH:MM[am|pm] + number [minutes|hours|days|weeks]
	ex&gt; now + 5 minutes	ex&gt; 04pm + 3 days
	就是说，在某个时间点『再加几个时间后』才进行。</span>
</pre></td></tr></tbody></table>

		<p>老实说，这个 at 命令的下达最重要的地方在於『时间』的指定了！鸟哥喜欢使用『 now + ... 』
		的方式来定义现在过多少时间再进行工作，但有时也需要定义特定的时间点来进行！底下的范例先看看罗！</p>

<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd">范例一：再过五分钟后，将 /root/.bashrc 寄给 root 自己</span>
[root@www ~]# <span class="term_command">at now + 5 minutes</span>  <span class="term_note">&lt;==记得单位要加 s 喔！</span>
at&gt; <span class="term_command">/bin/mail root -s "testing at job" &lt; /root/.bashrc</span>
at&gt; &lt;EOT&gt;   <span class="term_note">&lt;==这里输入 [ctrl] + d 就会出现 &lt;EOF&gt; 的字样！代表结束！</span>
job 4 at 2009-03-14 15:38
<span class="term_say"># 上面这行资讯在说明，第 4 个 at 工作将在 2009/03/14 的 15:38 进行！
# 而运行 at 会进入所谓的 at shell 环境，让你下达多重命令等待运行！</span>

<span class="term_hd">范例二：将上述的第 4 项工作内容列出来查阅</span>
[root@www ~]# <span class="term_command">at -c 4</span>
#!/bin/sh               <span class="term_note">&lt;==就是透过 bash shell 的啦！</span>
# atrun uid=0 gid=0
# mail     root 0
umask 22
<span class="term_say">....(中间省略许多的环境变量项目)....</span>
cd /root || {           <span class="term_note">&lt;==可以看出，会到下达 at 时的工作目录去运行命令</span>
         echo 'Execution directory inaccessible' &gt;&amp;2
         exit 1
}

/bin/mail root -s "testing at job" &lt; /root/.bashrc
<span class="term_say"># 你可以看到命令运行的目录 (/root)，还有多个环境变量与实际的命令内容啦！</span>

<span class="term_hd">范例三：由於机房预计於 2009/03/18 停电，我想要在 2009/03/17 23:00 关机？</span>
[root@www ~]# <span class="term_command">at 23:00 2009-03-17</span>
at&gt; <span class="term_write">/bin/sync</span>
at&gt; <span class="term_write">/bin/sync</span>
at&gt; <span class="term_write">/sbin/shutdown -h now</span>
at&gt; &lt;EOT&gt;
job 5 at 2009-03-17 23:00
<span class="term_say"># 您瞧瞧！ at 还可以在一个工作内输入多个命令呢！不错吧！</span>
</pre></td></tr></tbody></table>

		<p>事实上，当我们使用 at 时会进入一个 at shell 的环境来让使用者下达工作命令，此时，<span class="text_import2">建议你最好使用绝对路径来下达你的命令，比较不会有问题喔</span>！由於命令的下达与 PATH 变量有关，
		同时与当时的工作目录也有关连 (如果有牵涉到文件的话)，因此使用绝对路径来下达命令，会是比较一劳永逸的方法。
		为什么呢？举例来说，你在 /tmp 下达『 at now 』然后输入『 mail root -s "test" &lt; .bashrc 』，
		问一下，那个 .bashrc 的文件会是在哪里？答案是『 /tmp/.bashrc 』！因为<span class="text_import2">
		at 在运行时，会跑到当时下达 at 命令的那个工作目录</span>的缘故啊！</p>

		<p>有些朋友会希望『我要在某某时刻，在我的终端机显示出 Hello 的字样』，然后就在 at 里面下达这样的资讯『
		echo "Hello" 』。等到时间到了，却发现没有任何信息在萤幕上显示，这是啥原因啊？<span class="text_import2">这是因为 at 的运行与终端机环境无关，而所有 standard output/standard error output
		都会传送到运行者的 mailbox 去</span>啦！所以在终端机当然看不到任何资讯。那怎办？没关系，
		可以透过终端机的装置来处理！假如你在 tty1 登陆，则可以使用『 echo "Hello" &gt; /dev/tty1 』来取代。</p>

		<div style="padding: 10pt 0pt;" align="right"><table width="90%"><tbody><tr><td><b>Tips:</b><br><span style="color: rgb(0, 144, 0);"><font size="-1">		要注意的是，如果在 at shell 内的命令并没有任何的信息输出，那么 at 默认不会发 email 给运行者的。
		如果你想要让 at 无论如何都发一封 email 告知你是否运行了命令，那么可以使用『 at -m 时间格式 』来下达命令喔！
		at 就会传送一个信息给运行者，而不论该命令运行有无信息输出了！
		</font></span></td><td><img src="0430cron_files/vbird_face.gif" alt="鸟哥的图示" title="鸟哥的图示"></td></tr></tbody></table></div>
		<p>at 有另外一个很棒的优点，那就是『背景运行』的功能了！什么是背景运行啊？很难了解吗？其实与 bash 的 nohup 
		(<a href="0440processcontrol.html#nohup">第十七章</a>) 类似啦！
		鸟哥提我自己的几个例子来给您听听，您就了了！</p>

		<ul>
		<li><span class="text_import2">离线继续工作的任务</span>：鸟哥初次接触 Unix 为的是要跑空气品质模式，
		那是一种大型的程序，这个程序在当时的硬件底下跑，一个案例要跑 3 天！由於鸟哥也要进行其他研究工作，因此常常使用 Windows
		98 来连线到 Unix 工作站跑那个 3 天的案例！结果你也该知道， Windows 98 连开三天而不死机的机率是很低的～@_@～
		而死机时，所有在 Windows 上的连线都会中断！包括鸟哥在跑的那个程序也中断了～呜呜～明明再三个钟头就跑完的程序，
		由於死机害我又得跑 3 天！<br><br></li>


		<li>另一个常用的时刻则是例如上面的范例三，由於某个突发状况导致你必须要进行某项工作时，这个 at 就很好用啦！</li>
		</ul>

		<p><span class="text_import2">由於 at 工作排程的使用上，系统会将该项 at 工作独立出你的 bash 环境中，
		直接交给系统的 atd 程序来接管，因此，当你下达了 at 的工作之后就可以立刻离线了，
		剩下的工作就完全交给 Linux 管理即可</span>！所以罗，如果有长时间的网络工作时，嘿嘿！
		使用 at 可以让你免除网络断线后的困扰喔！ ^_^<br><br></p>

		<a name="atq_atrm"></a>
		<hr><ul class="list1"><li class="text_import1">at 工作的管理</li></ul>

		<p>那么万一我下达了 at 之后，才发现命令输入错误，该如何是好？就将他移除啊！利用 atq 与 atrm 吧！</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">atq</span>
[root@www ~]# <span class="term_command">atrm (jobnumber)</span>

<span class="term_hd">范例一：查询目前主机上面有多少的 at 工作排程？</span>
[root@www ~]# <span class="term_command">atq</span>
5       2009-03-17 23:00 a root
<span class="term_say"># 上面说的是：『在 2009/03/17 的 23:00 有一项工作，该项工作命令下达者为 
# root』而且，该项工作的工作号码 (jobnumber) 为 5 号喔！</span>

<span class="term_hd">范例二：将上述的第 5 个工作移除！</span>
[root@www ~]# <span class="term_command">atrm 5</span>
[root@www ~]# <span class="term_command">atq</span>
<span class="term_say"># 没有任何资讯，表示该工作被移除了！</span>
</pre></td></tr></tbody></table>

		<p>如此一来，你可以利用 atq 来查询，利用 atrm 来删除错误的命令，利用 at 来直接下达单一工作排程！很简单吧！
		不过，有个问题需要处理一下。<span class="text_import2">如果你是在一个非常忙碌的系统下运行 at ，
		能不能指定你的工作在系统较闲的时候才进行</span>呢？可以的，那就使用 batch 命令吧！<br><br></p>

		<a name="batch"></a>
		<hr><ul class="list1"><li class="text_import1">batch：系统有空时才进行背景任务</li></ul>

		<p>其实 batch 是利用 at 来进行命令的下达啦！只是加入一些控制参数而已。这个 batch 神奇的地方在於：<span class="text_import2">他会在 CPU 工作负载小於 0.8 的时候，才进行你所下达的工作任务</span>啦！
		那什么是负载 0.8 呢？这个负载的意思是： CPU 在单一时间点所负责的工作数量。不是 CPU 的使用率喔！
		举例来说，如果我有一只程序他需要一直使用 CPU 的运算功能，那么此时 CPU 的使用率可能到达 100% ，
		但是 CPU 的工作负载则是趋近於『 1 』，因为 CPU 仅负责一个工作嘛！如果同时运行这样的程序两支呢？
		CPU 的使用率还是 100% ，但是工作负载则变成 2 了！了解乎？</p>

		<p>所以也就是说，当 CPU 的工作负载越大，代表 CPU 必须要在不同的工作之间进行频繁的工作切换。
		这样的 CPU 运行情况我们在第零章有谈过，忘记的话请回去瞧瞧！因为一直切换工作，所以会导致系统忙碌啊！
		系统如果很忙碌，还要额外进行 at ，不太合理！所以才有 batch 命令的产生！</p>

		<p>那么 batch 如何下达命令呢？很简单啊！与 at 相同啦！例如下面的范例：</p>

<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd">范例一：同样是机房停电在 2009/3/17 23:00 关机，但若当时系统负载太高，则暂缓运行</span>
[root@www ~]# <span class="term_command">batch 23:00 2009-3-17</span>
at&gt; <span class="term_command">sync</span>
at&gt; <span class="term_command">sync</span>
at&gt; <span class="term_command">shutdown -h now</span>
at&gt; &lt;EOT&gt;
job 6 at 2009-03-17 23:00

[root@www ~]# <span class="term_command">atq</span>
6       2009-03-17 23:00 b root
[root@www ~]# <span class="term_command">atrm 6</span>
</pre></td></tr></tbody></table>

		<p>你会发现其实 batch 也是使用 atq/atrm 来管理的！这样了解乎？</p>
	</div>
</div>
<hr />
    </td>
    <td style="width: 16px; font-size: 6px;">　</td></tr>
<tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
</tbody></table>

<div style="padding-top: 0px; text-align: center;">
<span style="font-size: 80%;">
	<a href="http://linux.vbird.org/" target="_top" title="前往鸟哥的首页">http://linux.vbird.org</a>
	is designed by <a href="mailto:vbird@mail.vbird.idv.tw" title="联络鸟哥(我不要广告信！)">VBird</a>
		during 2001-2011. <a href="http://www.ksu.edu.tw/" target="_blank">ksu.edu</a></span>
         ﻿<div id="apDiv4">
      <p>本网页主要以Firefox配合解析度 1024x768 作为设计依据&nbsp;&nbsp;&nbsp;&nbsp; 鸟哥自由软件整合应用研究室</p></div></div>
</div>
</center>
</body></html>
