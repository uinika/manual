<html><head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="Author" content="2011/04/20,Airman">
	<meta name="Description" content="利用 RPM 来管理整个 Linux 的软件，同时以一个简单的范例来操纵 SRPM 的创建">
	<title>鸟哥的 Linux 私房菜 -- RPM 与 SRPM 软件管理员</title>
    <script src="../script/SpryMenuBar.js" type="text/javascript"></script>
	<script src="../script/index.js" type="text/javascript"></script>
	<link href="../css/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css" />
    <link href="../css/main.css" rel="stylesheet" type="text/css" />
    </head><body style="margin: 0pt; padding: 0pt;" class="table"onload="MM_preloadImages('../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html')">

<center>
<div id="apDiv5">
<div> <LINK REL="SHORTCUT ICON" HREF="../index-2.html">
<!-- ImageReady Slices (title3.ai) -->
<table id="___01" width="898" height="81" border="0" align="center" cellpadding="0" cellspacing="0";>
	<tr>
		<td colspan="15">
			<img src="image/title/title_01.png" width="900" height="1" alt=""></td>
	</tr>
	<tr>
		<td rowspan="4" bgcolor="#182448"><p><img src="http://linux.vbird.org/cgi-bin/Count.cgi?dd=C&amp;ft=5&amp;sh=T&amp;md=8&amp;pad=Y&amp;df=vbird.dic.ksu.edu.tw.dat" width="93" align="left" title="計數器" /></p>
	    <p><font color="#FFFFFF" size="-1">since2012/04/23</font></p></td>
		<td rowspan="4" align="left" valign="top"><a href="../index.html"><img src="image/title/title_03.png" alt="" width="263" height="79" border="0"></a></td>
		<td colspan="13">
			<img src="image/title/title_04.png" alt="" width="535" height="9" border="0"></td>
	</tr>
	<tr>
		<td rowspan="3">
			<img src="image/title/title_05.png" alt="" width="53" height="70" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="0110whatislinux.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image51','','image/title/title_06.png',1)"><img src="image/title/title3_06.png" name="Image51" width="106" height="25" border="0" id="Image51" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_07.png" alt="" width="27" height="37" border="0"></td>
		<td colspan="3" align="left" valign="top"><a href="../linux_server/0110network_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image52','','image/title/title_08.png',1)"><img src="image/title/title3_08.png" name="Image52" width="107" height="25" border="0" id="Image52" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_09.png" alt="" width="37" height="37" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../about.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image53','','image/title/title_10.png',1)"><img src="image/title/title3_10.png" name="Image53" width="75" height="25" border="0" id="Image53" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_11.png" alt="" width="35" height="70" border="0"></td>
		<td align="left" valign="top"><a href="mailto:vbird@mail.vbird.idv.tw" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image54','','image/title/title_12.png',1)"><img src="image/title/title3_12.png" name="Image54" width="74" height="25" border="0" id="Image54" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_13.png" alt="" width="21" height="70" border="0"></td>
	</tr>
	<tr>
		<td colspan="2">
			<img src="image/title/title_14.png" alt="" width="106" height="12" border="0"></td>
		<td colspan="3">
			<img src="image/title/title_15.png" alt="" width="107" height="12" border="0"></td>
		<td colspan="2">
			<img src="image/title/title_16.png" width="75" height="12" alt=""></td>
		<td rowspan="2">
			<img src="image/title/title_17.png" alt="" width="74" height="45" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/title_18.png" alt="" width="15" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar1" class="MenuBarHorizontal">
	  <li><a href="linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image44','','image/title/title_19.png',1)"><img src="image/title/title3_19.png" name="Image44" width="123" height="33" border="0" id="Image44" /></a>
			    <ul>
			      <li><a href="Mandrake9.0/mandrake9.0.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image46','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image46" width="120" height="26" border="0" id="Image46" alt="" /></a></li>
                  <li><a href="fedora_4/fc4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image47','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image47" width="120" height="26" border="0" id="Image47" alt="" /></a></li>
                  <li><a href="linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image48','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image48" width="120" height="26" border="0" id="Image48" alt="" /></a></li>
                </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_20.png" alt="" width="42" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar2" class="MenuBarHorizontal">
	  <li><a href="../linux_server/index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image45','','image/title/title_21.png',1)"><img src="image/title/title3_21.png" name="Image45" width="125" height="33" border="0" id="Image45" /></a>
			    <ul>
			      <li><a href="../linux_server/linux_redhat9/redhat9.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image43','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image43" width="120" height="26" border="0" id="Image43" alt=""/></a></li>
			      <li><a href="../linux_server/centos4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image49','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image49" width="120" height="26" border="0" id="Image49" alt="" /></a></li>
			      <li><a href="../linux_server/index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image50','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image50" width="120" height="26" border="0" id="Image50" alt="" /></a></li>
		        </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_22.png" alt="" width="47" height="33" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/Spacer.gif" width="101" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="263" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="53" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="15" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="91" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="27" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="5" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="42" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="60" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="37" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="28" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="47" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="35" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="74" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="22" height="1" alt=""></td>
	</tr>
</table>
<!-- End ImageReady Slices -->
<script type="text/javascript">
<!--
var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
var MenuBar2 = new Spry.Widget.MenuBar("MenuBar2", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
//-->
</script>
</div>
<table summary="本文内容的排版" style="width: 898px;" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
<tr><td style="width: 16px; font-size: 6px;">　</td>
    <td width="866">

<!-- 本文的档头部分 -->
<div style="text-align: center;">
    <a href="0520rpm_and_srpm.html">
    <span class="text_head0">第二十三章、软件安装：<span class="text_head_en"> RPM, SRPM </span>与<span class="text_head_en"> YUM </span>功能</span></a><br>
</div>
    <div style="text-align: right;">
        <span class="text_history">最近升级日期：2009/09/18</span>
    </div>
<!-- 本文的连结区部分 -->
<div class="block1">
<span class="text_h1">
6. <a href="#hint">重点回顾</a><br>
7. <a href="#ex">本章习题</a><br>
8. <a href="#reference">参考数据与延伸阅读</a><br>
<span class="text_h2">
9. <a href="http://phorum.vbird.org/viewtopic.php?t=23893" target="_blank">针对本文的建议：http://phorum.vbird.org/viewtopic.php?t=23893</a>
</span>
</span></div>
<!-- 本文的正式部分 -->
<hr><a name="hint"></a><img src="../image/logo.png" alt="大标题的图示" width="35" align="middle" height="34"><span class="text_h1">重点回顾</span><br>
<div class="block1">
<ul class="text_import2">
	<li>为了避免使用者自行编译的困扰，开发商自行在特定的硬件与操作系统平台上面预先编译好软件，
	并将软件以特殊格式封包成文件，提供终端用户直接安装到固定的操作系统上，并提供简单的查询/安装/移除等流程。
	此称为软件管理员。常见的软件管理员有 RPM 与 DPKG 两大主流。</li>
	<li>RPM 的全名是 RedHat Package Manager，原本是由 Red Hat 公司所发展的，流传甚广；</li>
	<li>RPM 类型的软件中，所含有的软件是经过编译后的 binary program ，所以可以直接安装在使用者端的系统上，
	不过，也由於如此，所以 RPM 对於安装者的环境要求相当严格；</li>
	<li>RPM 除了将软件安装至使用者的系统上之外，还会将该软件的版本、名称、文件与目录配置、系统需求等等均记录於数据库
	(/var/lib/rpm) 当中，方便未来的查询与升级、移除；</li>
	<li>RPM 可针对不同的硬件等级来加以编译，制作出来的文件可於扩展名 (i386, i586, i686, x86_64) 来分辨；</li>
	<li>RPM 最大的问题为软件之间的相依性问题；</li>
	<li>SRPM 为 Source RPM ，内含的文件为 Source code 而非为 binary file ，所以安装 SRPM 时还需要经过 
	compile ，不过，SRPM 最大的优点就是可以让使用者自行修改配置参数 (makefile/configure 的参数)
	，以符合使用者自己的 Linux 环境；</li>
	<li>RPM 软件的属性相依问题，已经可以藉由  yum 或者是 APT 等方式加以克服。 CentOS 使用的就是 yum 机制。</li>
	<li>yum 服务器提供多个不同的容器放置个别的软件，以提供用户端分别管理软件类别。</li>
</ul>
</div>


<hr><a name="ex"></a><img src="../image/logo.png" alt="大标题的图示" width="35" align="middle" height="34"><span class="text_h1">本章习题</span><br>
<div class="block1">
<ul style="padding-left: 10px;">
	<li>情境模拟题一：实际安装 php, php-mysql, php-devel, httpd-devel 等软件的方式<br><br>
	<ul>
		<li>目标：利用 rpm 查询软件是否已安装，利用 yum 进行线上查询；</li>
		<li>目标：你的 Linux 必须要已经接上 Internet 才行；</li>
		<li>需求：最好了解磁碟容量是否够用，以及如何启动服务等。</li>
	</ul><br>

	这个模拟题的目的是想要安装一套较为完整的 WWW 服务器，并且此服务器可以支持外挂的其他网页服务器模块。
	所以需要安装的就会有网页程序语言 php 与数据库软件 MySQL ，以及未来开发用的 php-devel, httpd-devel 等软件。
	整个流程会有点像这样：<br><br>

	<ol>
		<li>检查所需要的软件是否存在？最好直接使用 rpm ，因为可以直接取得 RPM 的数据库内容：<br>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">rpm -q httpd httpd-devel php php-devel php-mysql</span>
httpd-2.2.3-22.el5.centos
package httpd-devel is not installed  <span class="term_note">&lt;==没有安装的软件！</span>
php-5.1.6-23.el5
package php-devel is not installed    <span class="term_note">&lt;==没有安装的软件！</span>
package php-mysql is not installed    <span class="term_note">&lt;==没有安装的软件！</span>
</pre></td></tr></tbody></table>

		经过上面的分析，我们知道 httpd-devel, php-devel, php-mysql 等软件并没有安装！那么该如何安装
		可以使用 yum  直接线上安装。不过我们必须要先有网络才行！<br><br></li>

		<li>确认网络的可行性：<br>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">ifconfig eth0</span>
eth0      Link encap:Ethernet  HWaddr 08:00:27:11:3B:75
          inet addr:<span class="term_write">192.168.201.201</span>  Bcast:192.168.201.255  Mask:<span class="term_write">255.255.255.0</span>
<span class="term_say">....(底下省略)....
# 你可以看到我们的主机是有 IP 存在的！再来看看有没有路由配置存在？</span>

[root@www ~]# <span class="term_command">route -n</span>
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
192.168.201.0   0.0.0.0         255.255.255.0   U     0      0        0 eth0
0.0.0.0         <span class="term_write">192.168.201.254</span> 0.0.0.0         UG    0      0        0 eth0
<span class="term_say"># 确实是有路由器 (Gateway) 存在的！那么该路由器是否配置正确呢？</span>

[root@www ~]# <span class="term_command">ping -c 2 192.168.201.254</span>
PING 192.168.201.254 (192.168.201.254) 56(84) bytes of data.
64 bytes from 192.168.201.254: icmp_seq=1 ttl=64 <span class="term_write">time=0.325 ms</span>
64 bytes from 192.168.201.254: icmp_seq=2 ttl=64 <span class="term_write">time=0.281 ms</span>
<span class="term_say"># 路由器有回应！表示可以连接到路由器！那么 TCP/IP 设好了，
# 但是主机名称解析器统 (DNS) 该如何处理？</span>

[root@www ~]# <span class="term_command">dig www.google.com</span>

; &lt;&lt;&gt;&gt; DiG 9.3.4-P1 &lt;&lt;&gt;&gt; www.google.com
;; global options:  printcmd
<span class="term_say">....(中间省略)....</span>
;; QUESTION SECTION:
;www.google.com.                        IN      A
<span class="term_say">....(中间省略)....</span>
;; ANSWER SECTION:
www.google.com.         522933  IN      CNAME   www.l.google.com.
www.l.google.com.       107     IN      A       <span class="term_write">72.14.203.103</span>
<span class="term_say">....(中间省略)....</span>
;; Query time: 5 msec
;; SERVER: <span class="term_write">120.114.150.1#53(120.114.150.1)</span>
;; WHEN: Fri Sep 18 13:14:45 2009
;; MSG SIZE  rcvd: 340
<span class="term_say"># 确实有查到 Google 的 IP ，且是由 120.114.150.1 那部 DNS 主机帮忙解析的！</span>
</pre></td></tr></tbody></table></li>

		<li>网络配置妥当之后，那我们就能够直接使用 yum 罗！可以这样直接进行安装的：<br>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">yum install httpd httpd-devel php php-devel php-mysql</span>
</pre></td></tr></tbody></table>

		然后接著一步一步进行安装即可。</li>
	</ol><br></li>
</ul>

<hr>简答题部分：
<ul>
	<li>如果你曾经修改过 yum 配置档内的容器配置 (/etc/yum.repos.d/*.repo) ，导致下次使用 yum 进行安装时老是发现错误，
	此时你该如何是好？
	<div class="blockex">
		先确认你的配置档确实是正确的，如果没问题，可以将 yum 的缓存清除，使用『yum clean all』即可。
		事实上， yum 的所有缓存、下载软件、下载软件的表头数据，都放置於 /var/cache/yum/ 目录下。
	</div></li>

	<li>简单说明 RPM 与 SRPM 的异同？
	<div class="blockex">
	RPM 文件是由程序打包者 (通常是由 distribution 的开发商) 藉由程序的原始码，在特定的平台上面所编译成功的
	binary program 的数据，并将该数据制作成为 RPM 的格式，以方便相同软、硬件平台的使用者之安装使用。
	在安装时显的很简单，因为程序打包者的平台与使用者所使用的平台默认为相同。<br>
	至於 SRPM 则是藉由与 RPM 相同的配置档数据，不过将原始码直接包在 SRPM 文件当中，而不经过编译。
	因为 SRPM 所内含的数据为原始码，所以安装时必须要再经过编译的行为才能成为 RPM 并提供使用者安装。
	</div></li>

	<li>假设我想要安装一个软件，例如 pkgname.i386.rpm ，但却老是发生无法安装的问题，请问我可以加入哪些参数来强制安装他？
	<div class="blockex">
	可以加入 --nodeps 等参数。例如 rpm -ivh --nodeps pkgname.i386.rpm
	</div></li>

	<li>承上题，你认为强制安装之后，该软件是否可以正常运行？为什么？
	<div class="blockex">
	一般来说，应该是『不能运行』的，因为该软件具有相依属性的问题，
	某些时刻该软件的程序可能需要呼叫外部的函式库，但函式库可能未安装，因此当然无法运行成功。
	</div></li>

	<li>有些人使用 OpenLinux 3.1 Server 安装在自己的 P-166 MMX ，却发现无法安装，在查询了该原版光盘的内容，发现里面的文件名称为
	***.i686.rpm 。请问，无法安装的可能原因为何？
	<div class="blockex">
	因为 P-166MMX 为 i586 的硬件平台，而 OpenLinux 为针对 i686 的硬件平台进行最佳化，
	因此很可能由於下达的参数无法支持的问题，导致无法安装成功。
	</div></li>

	<li>请问我使用 rpm -Fvh *.rpm 及 rpm -Uvh *.rpm 来升级时，两者有何不同？
	<div class="blockex">
	-Uvh 后面接的软件，如果原本未安装，则直接安装，原本已安装时，则直接升级；<br>
	-Fvh 后面接的软件，如果原本未安装，则不安装，原本已安装时，则直接升级；
	</div></li>

	<li>假设有一个厂商推出软件时，自行处理了数码签章，你想要安装他们的软件所以需要使用数码签章，假设数码签章的档名为 signe，
	那你该如何安装？
	<div class="blockex">
		rpm --import signe
	</div></li>

	<li>承上，假设该软件厂商提供了 yum 的安装网址为： http://their.server.name/path/ ，那你该如何处理 yum 的配置档？
	<div class="blockex">
		可以自行取个档名，在此例中我们使用『 vim /etc/yum.repos.d/their.repo 』，扩展名要正确！
		内容有点像这样即可：<pre>[their]
name=their server name
baseurl=http://their.server.name/path/
enable=1
gpgcheck=0</pre>然后使用 yum 去安装该软件看看。
	</div></li>
</ul>
</div>


<hr><a name="reference"></a><img src="../image/logo.png" alt="大标题的图示" width="35" align="middle" height="34"><span class="text_h1">参考数据与延伸阅读</span><br>
<div class="block1">
<ul>
	<li><a name="ps1"></a>注1：GNU Privacy Guard (GPG) 官方网站的介绍：<a href="http://www.gnupg.org/" target="_blank">http://www.gnupg.org/</a></li>
	<li>RPM 包装文件管理程序：<a href="http://www.study-area.org/tips/rpm.htm" target="_blank">http://www.study-area.org/tips/rpm.htm</a></li>
	<li>中文 RPM HOW-TO：<a href="http://www.linux.org.tw/CLDP/RPM-HOWTO.html" target="_blank">http://www.linux.org.tw/CLDP/RPM-HOWTO.html</a></li>
	<li>RPM 的使用：<a href="http://linux.tnc.edu.tw/techdoc/rpm-howto.htm" target="_blank">http://linux.tnc.edu.tw/techdoc/rpm-howto.htm</a></li>
	<li>大家来作 RPM ：<a href="http://freebsd.ntu.edu.tw/bsd/4/3/2/29.html" target="_blank">http://freebsd.ntu.edu.tw/bsd/4/3/2/29.html</a></li>
	<li>一本 RPM 的原文书：<a href="http://linux.tnc.edu.tw/techdoc/maximum-rpm/rpmbook/" target="_blank">http://linux.tnc.edu.tw/techdoc/maximum-rpm/rpmbook/</a></li>
	<li>台湾网络危机处理小组：<a href="http://www.cert.org.tw/" target="_blank">http://www.cert.org.tw/</a></li>
</ul>
</div>
<hr />
    </td>
    <td style="width: 16px; font-size: 6px;">　</td></tr>
<tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
</tbody></table>

<div style="padding-top: 0px; text-align: center;">
<span style="font-size: 80%;">
	<a href="http://linux.vbird.org/" target="_top" title="前往鸟哥的首页">http://linux.vbird.org</a>
	is designed by <a href="mailto:vbird@mail.vbird.idv.tw" title="联络鸟哥(我不要广告信！)">VBird</a>
		during 2001-2011. <a href="http://www.ksu.edu.tw/" target="_blank">ksu.edu</a></span>
         ﻿<div id="apDiv4">
      <p>本网页主要以Firefox配合解析度 1024x768 作为设计依据&nbsp;&nbsp;&nbsp;&nbsp; 鸟哥自由软件整合应用研究室</p></div></div>
</div>
</center>
</body></html>
