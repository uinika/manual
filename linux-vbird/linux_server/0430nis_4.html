<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-TW" lang="zh-TW"><head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf8">
	<meta name="Author" content="VBird, 鸟哥">
	<meta name="Description" content="Network Information Service, NIS 服务器">
	<title>鸟哥的 Linux 私房菜 -- NIS 服务器</title>
    <script src="../script/SpryMenuBar.js" type="text/javascript"></script>
	<script src="../script/index.js" type="text/javascript"></script>
	<link href="../css/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css" />
    <link href="../css/main.css" rel="stylesheet" type="text/css" />
    </head><body style="margin: 0pt; padding: 0pt;" class="table"onload="MM_preloadImages('../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html')">

<center>
<div id="apDiv5">
<div> <LINK REL="SHORTCUT ICON" HREF="../index-2.html">
<!-- ImageReady Slices (title3.ai) -->
<table id="___01" width="898" height="81" border="0" align="center" cellpadding="0" cellspacing="0";>
	<tr>
		<td colspan="15">
			<img src="image/title/title_01.png" width="900" height="1" alt=""></td>
	</tr>
	<tr>
		<td rowspan="4" bgcolor="#182448"><p><img src="http://linux.vbird.org/cgi-bin/Count.cgi?dd=C&amp;ft=5&amp;sh=T&amp;md=8&amp;pad=Y&amp;df=vbird.dic.ksu.edu.tw.dat" width="93" align="left" title="計數器" /></p>
	    <p><font color="#FFFFFF" size="-1">since2012/04/23</font></p></td>
		<td rowspan="4" align="left" valign="top"><a href="../index.html"><img src="image/title/title_03.png" alt="" width="263" height="79" border="0"></a></td>
		<td colspan="13">
			<img src="image/title/title_04.png" alt="" width="535" height="9" border="0"></td>
	</tr>
	<tr>
		<td rowspan="3">
			<img src="image/title/title_05.png" alt="" width="53" height="70" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../linux_basic/0110whatislinux.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image51','','image/title/title_06.png',1)"><img src="image/title/title3_06.png" name="Image51" width="106" height="25" border="0" id="Image51" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_07.png" alt="" width="27" height="37" border="0"></td>
		<td colspan="3" align="left" valign="top"><a href="0110network_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image52','','image/title/title_08.png',1)"><img src="image/title/title3_08.png" name="Image52" width="107" height="25" border="0" id="Image52" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_09.png" alt="" width="37" height="37" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../about.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image53','','image/title/title_10.png',1)"><img src="image/title/title3_10.png" name="Image53" width="75" height="25" border="0" id="Image53" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_11.png" alt="" width="35" height="70" border="0"></td>
		<td align="left" valign="top"><a href="mailto:vbird@mail.vbird.idv.tw" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image54','','image/title/title_12.png',1)"><img src="image/title/title3_12.png" name="Image54" width="74" height="25" border="0" id="Image54" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_13.png" alt="" width="21" height="70" border="0"></td>
	</tr>
	<tr>
		<td colspan="2">
			<img src="image/title/title_14.png" alt="" width="106" height="12" border="0"></td>
		<td colspan="3">
			<img src="image/title/title_15.png" alt="" width="107" height="12" border="0"></td>
		<td colspan="2">
			<img src="image/title/title_16.png" width="75" height="12" alt=""></td>
		<td rowspan="2">
			<img src="image/title/title_17.png" alt="" width="74" height="45" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/title_18.png" alt="" width="15" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar1" class="MenuBarHorizontal">
	  <li><a href="../linux_basic/linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image44','','image/title/title_19.png',1)"><img src="image/title/title3_19.png" name="Image44" width="123" height="33" border="0" id="Image44" /></a>
			    <ul>
			      <li><a href="../linux_basic/Mandrake9.0/mandrake9.0.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image46','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image46" width="120" height="26" border="0" id="Image46" alt="" /></a></li>
                  <li><a href="../linux_basic/fedora_4/fc4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image47','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image47" width="120" height="26" border="0" id="Image47" alt="" /></a></li>
                  <li><a href="../linux_basic/linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image48','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image48" width="120" height="26" border="0" id="Image48" alt="" /></a></li>
                </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_20.png" alt="" width="42" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar2" class="MenuBarHorizontal">
	  <li><a href="index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image45','','image/title/title_21.png',1)"><img src="image/title/title3_21.png" name="Image45" width="125" height="33" border="0" id="Image45" /></a>
			    <ul>
			      <li><a href="linux_redhat9/redhat9.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image43','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image43" width="120" height="26" border="0" id="Image43" alt=""/></a></li>
			      <li><a href="centos4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image49','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image49" width="120" height="26" border="0" id="Image49" alt="" /></a></li>
			      <li><a href="index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image50','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image50" width="120" height="26" border="0" id="Image50" alt="" /></a></li>
		        </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_22.png" alt="" width="47" height="33" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/Spacer.gif" width="101" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="263" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="53" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="15" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="91" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="27" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="5" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="42" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="60" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="37" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="28" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="47" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="35" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="74" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="22" height="1" alt=""></td>
	</tr>
</table>
<!-- End ImageReady Slices -->
<script type="text/javascript">
<!--
var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
var MenuBar2 = new Spry.Widget.MenuBar("MenuBar2", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
//-->
</script>
</div>
<table summary="本文内容的排版" style="width: 898px;" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
<tr><td style="width: 16px; font-size: 6px;">　</td>
    <td width="866">

<!-- 本文的档头部分 -->
<div style="text-align:center">
    <a href="http://linux.vbird.org/linux_server/0430nis.php">
    <span class="text_head0">第十四章、账号控管：<span class="text_head_en"> NIS </span>服务器</span></a><br>
</div>
    <div style="text-align:right">
        <span class="text_history">最近更新日期：2011/07/28</span>
    </div>
<!-- 本文的连结区部分 -->
<div class="block1">
<span class="text_h1">
14.4 <a href="#nis_nfs">NIS 搭配 NFS 的设定在丛集计算机上的应用</a><br>
</span></div>
<!-- 本文的正式部分 -->
<hr><a name="nis_nfs"></a><img src="../image/logo.png" alt="大标题的图示" width="35" align="middle" height="34"><span class="text_h1">14.4 NIS 搭配 NFS 的设定在丛集计算机上的应用</span><br>
<div class="block1">
	<p>刚刚在 NIS 客户端的 nisuser1 登入测试中，你应该已经发现了一件事，那就是<span class="text_import2">怎么
	nisuser1 没有家目录啊？</span>这很正常啊！因为 nisuser1 的家目录是在服务器端的 /home 上头，而你在客户端登入时，
	在客户端的 /home 底下根本不可能有 nisuser1 的家目录嘛！那怎办？很简单，将服务器端的 /home 挂载到客户端上面即可啊！
	那这个观念跟丛集计算机有啥关系啊？就让我们来谈谈吧！</p>

	<div class="block2">
	<ul class="list1"><li class="text_import1"><hr>什么是丛集计算机？</li></ul>

	<p>因为个人计算机的 CPU 速度越来越快，核心数目越来越多，因此个人计算机的效能已经不比服务器等级的大型计算机差了！
	不过，如果要用来作为计算大型数值模式的应用，即使是最快的个人计算机，还是没有办法有效的负荷的。此时你可能就得要考虑一下，
	是要买超级计算机 (Top 500) 还是要自己组一部 PC 丛集计算机 (PC cluster)。</p>

	<p>超级计算机的结构中，主要是透过内部电路将好多颗 CPU 与内存连接在一块，因为是特殊设计，因此价格非常昂贵。
	如果我们可以将较便宜的个人计算机串接在一块，然后将数值运算的任务分别丢给每一部串接在一块的个人计算机，
	那不就很像超级计算机了吗？没错！这就是 PC cluster 最早的想法。</p>

	<p>但是这个作法当中有几个限制喔，因为每部计算机都需要运算相同的程序，而我们知道运算的数据都在内存当中，
	而程序启动时需要给予一个身份，而程序读取的程序在每部计算机上面都需要是相同的！同时，每部计算机都需要支持平行化运算！
	所以，在 PC cluster 上面的所有计算机就得要有：</p>

	<ul class="text_import2">
		<li>相同的用户帐户信息，包括账号、密码、家目录等等一大堆信息；</li>
		<li>相同的文件系统，例如 /home, /var/spool/mail 以及数值程序放置的位置</li>
		<li>可以搭配的平行化函式库，常见的有 MPICH, PVM...</li>
	</ul>

	<p>上面的三个项目中，第一个项目我们可以透过 NIS 来处理，第二个项目则可以使用 NFS 来搞定～所以啰，你说， NIS 与 NFS 
	有没有可使用的空间啊？ ^_^</p>

	<div style="padding: 10pt 0pt 10pt 0pt ;" align="right"><table width="90%"><tbody><tr><td><b>Tips:</b><br><span style="color : #009000"><font size="-1">	由于『预测』这个玩意儿越来越重要，比如说气象预报、空气质量预报等等，而预测需要一个很庞大的模式来进行仿真的工作，
	这么庞大的模拟工作需要大量的运算，在学校单位要买一部很贵的大型主机实在很不容易！不过，如果能够串接十部四核心的个人计算机的话，
	那么可能只需要不到 20 万便能够组成相当于具有 40 颗 CPU 的大型主机的运算能力了！所以说，在未来 PC cluster 
	是一个可以发展的课题喔！
	</font></span></td><td><img src="0430nis_files/vbird_face.gif" alt="鸟哥的图示" title="鸟哥的图示"></td></tr></tbody></table></div>
	<ul class="list1"><li class="text_import1"><hr>另一个不成材的实例</li></ul>

	<p>那我们有没有办法来实作一下平行化的丛集架构呢？老实说，很麻烦～不过，至少我们可以先完成前面谈到的两个组件！
	分别是 NIS 与 NFS 嘛！但是，在我们目前这个网络环境中，用户账号实在是太紊乱了～所以，如果想要将服务器的 /home 
	挂载到客户端的 /home，那么那个测试用的客户端可能很多本地用户都无法登入了～因此，在这个测试练习中，
	我们打算这样做：</p>

	<ul class="text_import2">
		<li>账号：建立大于 2000 以上的账号，账号名称为 cluser1, cluser2, cluser3 (将 cluster user 缩写为 
		cluser，不是少写一个 t  喔！)，且这些账号的家目录预计放置于 /rhome 目录内，以与 NIS client 本地的用户分开；</li>
		<li>NIS 服务器：领域名为 vbirdcluster，服务器是 www.centos.vbird (192.168.100.254)，客户端是
		clientlinux.centos.vbird (192.168.100.10)；</li>
		<li>NFS 服务器：服务器分享了 /rhome 给 192.168.100.0/24 这个网域，且预计将所有程序放置于 /cluster 目录中。
		此外，假设所有客户端都是很干净的系统，因此不需要压缩客户端 root 的身份。</li>
		<li>NFS 客户端：将来自 server 的文件系统都挂载到相同目录名称底下！</li>
	</ul>

	<p>那就分别来实作一下啰！<br><br></p>

	<ul class="list1"><li class="text_import1"><hr>NIS 实作阶段</li></ul>

<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd"># 1. 建立此次任务所需要的账号数据：</span>
[root@www ~]# <span class="term_command">mkdir /rhome</span>
[root@www ~]# <span class="term_command">useradd -u 2001 -d /rhome/cluser1 cluser1</span>
[root@www ~]# <span class="term_command">useradd -u 2002 -d /rhome/cluser2 cluser2</span>
[root@www ~]# <span class="term_command">useradd -u 2003 -d /rhome/cluser3 cluser3</span>
[root@www ~]# <span class="term_command">echo password | passwd --stdin cluser1</span>
[root@www ~]# <span class="term_command">echo password | passwd --stdin cluser2</span>
[root@www ~]# <span class="term_command">echo password | passwd --stdin cluser3</span>

<span class="term_hd"># 2. 修改 NISDOMAIN 的名称</span>
[root@www ~]# <span class="term_command">vim /etc/sysconfig/network</span>
NISDOMAIN=vbirdcluster  <span class="term_note">&lt;==重点在改这个项目喔！</span>
</pre></td></tr></tbody></table>

	<p>这个案例中，你只要做完上述的动作就即将完成了，其他的配置文件请参考前面 14.2 节所谈到的各个必要项目。
	接下来当然就是重新启动 ypserv 以及制作数据库啰！</p>

<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd"># 3. 制作数据库以及重新启动所需要的服务：</span>
[root@www ~]# <span class="term_command">nisdomainname vbirdcluster</span>
[root@www ~]# <span class="term_command">/etc/init.d/ypserv restart</span>
[root@www ~]# <span class="term_command">/etc/init.d/yppasswdd restart</span>
[root@www ~]# <span class="term_command">/usr/lib64/yp/ypinit -m</span>
</pre></td></tr></tbody></table>

	<p>依序一个一个指令下达！上述的这四个指令稍微有相依性关系的！所以不要错乱了顺序喔！接下来，请换到客户端进行：</p>

	<ol>
		<li>以 setup 进行 NIS 的设定，在领域的部分请转为 vbirdcluster 才对！</li>
		<li>做完后再以 id cluser1 确认看看。</li>
	</ol>

	<p>作法太简单了，鸟哥这里就不示范啰。<br><br></p>

	<ul class="list1"><li class="text_import1"><hr>NFS 服务器的设定</li></ul>

<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd"># 1. 设定 NFS 服务器开放的资源：</span>
[root@www ~]# <span class="term_command">mkdir /cluster</span>
[root@www ~]# <span class="term_command">vim /etc/exports</span>
<span class="term_write">/rhome          192.168.100.0/24(rw,no_root_squash)
/cluster        192.168.100.0/24(rw,no_root_squash)</span>

<span class="term_hd"># 2. 重新启动 NFS 啰：</span>
[root@www ~]# <span class="term_command">/etc/init.d/nfs restart</span>
[root@www ~]# <span class="term_command">showmount -e localhost</span>
Export list for localhost:
/rhome       192.168.100.0/24
/cluster     192.168.100.0/24
</pre></td></tr></tbody></table>

	<p>服务器的设定是很单纯的～客户端的设定得要注意啰！</p>

<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd"># 1. 设定 NIS Client 的 mount 数据！</span>
[root@clientlinux ~]# <span class="term_command">mkdir /rhome /cluster</span>
[root@clientlinux ~]# <span class="term_command">mount -t nfs 192.168.100.254:/rhome   /rhome</span>
[root@clientlinux ~]# <span class="term_command">mount -t nfs 192.168.100.254:/cluster /cluster</span>
<span class="term_say"># 如果上述两个指令没有问题，可以将他加入 /etc/rc.d/rc.local 当中啊！</span>

[root@clientlinux ~]# <span class="term_command">su - cluser1</span>
[<u>cluser1</u>@clientlinux ~]$ <span class="term_command"></span>
</pre></td></tr></tbody></table>

	<p>最后你应该就能够在客户端以 cluser1 登入系统！就这么简单的将账号与文件系统同步做完啦！如果你真的想要玩一下 PC Cluster
	的话，鸟哥也有写过一篇不是很成熟的 PC cluster 简易架设，有兴趣的话请自行参考：</p>

	<ul><li><a href="http://linux.vbird.org/linux_server/0600cluster.php" target="_blank">http://linux.vbird.org/linux_server/0600cluster.php</a></li></ul>
	</div>
</div>
<hr />
    </td>
    <td style="width: 16px; font-size: 6px;">　</td></tr>
<tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
</tbody></table>

<div style="padding-top: 0px; text-align: center;">
<span style="font-size: 80%;">
	<a href="http://linux.vbird.org/" target="_top" title="前往鸟哥的首页">http://linux.vbird.org</a>
	is designed by <a href="mailto:vbird@mail.vbird.idv.tw" title="联络鸟哥(我不要广告信！)">VBird</a>
		during 2001-2011. <a href="http://www.ksu.edu.tw/" target="_blank">ksu.edu</a></span>
         ﻿<div id="apDiv4">
      <p>本网页主要以Firefox配合解析度 1024x768 作为设计依据&nbsp;&nbsp;&nbsp;&nbsp; 鸟哥自由软件整合应用研究室</p></div></div>
</div>
</center>
</body></html>
