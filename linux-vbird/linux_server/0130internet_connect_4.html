<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-TW" lang="zh-TW"><head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf8">
	<meta name="Author" content="VBird, 鸟哥">
	<meta name="Description" content="网络卡的安装，与连接上 Internet 的方法介绍">
	<title>鸟哥的 Linux 私房菜 -- 连上 Internet 的方法与步骤</title>
    <script src="../script/SpryMenuBar.js" type="text/javascript"></script>
	<script src="../script/index.js" type="text/javascript"></script>
	<link href="../css/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css" />
    <link href="../css/main.css" rel="stylesheet" type="text/css" />
    </head><body style="margin: 0pt; padding: 0pt;" class="table"onload="MM_preloadImages('../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html')">

<center>
<div id="apDiv5">
<div> <LINK REL="SHORTCUT ICON" HREF="../index-2.html">
<!-- ImageReady Slices (title3.ai) -->
<table id="___01" width="898" height="81" border="0" align="center" cellpadding="0" cellspacing="0";>
	<tr>
		<td colspan="15">
			<img src="image/title/title_01.png" width="900" height="1" alt=""></td>
	</tr>
	<tr>
		<td rowspan="4" bgcolor="#182448"><p><img src="http://linux.vbird.org/cgi-bin/Count.cgi?dd=C&amp;ft=5&amp;sh=T&amp;md=8&amp;pad=Y&amp;df=vbird.dic.ksu.edu.tw.dat" width="93" align="left" title="計數器" /></p>
	    <p><font color="#FFFFFF" size="-1">since2012/04/23</font></p></td>
		<td rowspan="4" align="left" valign="top"><a href="../index.html"><img src="image/title/title_03.png" alt="" width="263" height="79" border="0"></a></td>
		<td colspan="13">
			<img src="image/title/title_04.png" alt="" width="535" height="9" border="0"></td>
	</tr>
	<tr>
		<td rowspan="3">
			<img src="image/title/title_05.png" alt="" width="53" height="70" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../linux_basic/0110whatislinux.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image51','','image/title/title_06.png',1)"><img src="image/title/title3_06.png" name="Image51" width="106" height="25" border="0" id="Image51" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_07.png" alt="" width="27" height="37" border="0"></td>
		<td colspan="3" align="left" valign="top"><a href="0110network_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image52','','image/title/title_08.png',1)"><img src="image/title/title3_08.png" name="Image52" width="107" height="25" border="0" id="Image52" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_09.png" alt="" width="37" height="37" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../about.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image53','','image/title/title_10.png',1)"><img src="image/title/title3_10.png" name="Image53" width="75" height="25" border="0" id="Image53" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_11.png" alt="" width="35" height="70" border="0"></td>
		<td align="left" valign="top"><a href="mailto:vbird@mail.vbird.idv.tw" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image54','','image/title/title_12.png',1)"><img src="image/title/title3_12.png" name="Image54" width="74" height="25" border="0" id="Image54" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_13.png" alt="" width="21" height="70" border="0"></td>
	</tr>
	<tr>
		<td colspan="2">
			<img src="image/title/title_14.png" alt="" width="106" height="12" border="0"></td>
		<td colspan="3">
			<img src="image/title/title_15.png" alt="" width="107" height="12" border="0"></td>
		<td colspan="2">
			<img src="image/title/title_16.png" width="75" height="12" alt=""></td>
		<td rowspan="2">
			<img src="image/title/title_17.png" alt="" width="74" height="45" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/title_18.png" alt="" width="15" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar1" class="MenuBarHorizontal">
	  <li><a href="../linux_basic/linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image44','','image/title/title_19.png',1)"><img src="image/title/title3_19.png" name="Image44" width="123" height="33" border="0" id="Image44" /></a>
			    <ul>
			      <li><a href="../linux_basic/Mandrake9.0/mandrake9.0.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image46','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image46" width="120" height="26" border="0" id="Image46" alt="" /></a></li>
                  <li><a href="../linux_basic/fedora_4/fc4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image47','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image47" width="120" height="26" border="0" id="Image47" alt="" /></a></li>
                  <li><a href="../linux_basic/linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image48','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image48" width="120" height="26" border="0" id="Image48" alt="" /></a></li>
                </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_20.png" alt="" width="42" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar2" class="MenuBarHorizontal">
	  <li><a href="index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image45','','image/title/title_21.png',1)"><img src="image/title/title3_21.png" name="Image45" width="125" height="33" border="0" id="Image45" /></a>
			    <ul>
			      <li><a href="linux_redhat9/redhat9.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image43','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image43" width="120" height="26" border="0" id="Image43" alt=""/></a></li>
			      <li><a href="centos4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image49','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image49" width="120" height="26" border="0" id="Image49" alt="" /></a></li>
			      <li><a href="index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image50','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image50" width="120" height="26" border="0" id="Image50" alt="" /></a></li>
		        </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_22.png" alt="" width="47" height="33" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/Spacer.gif" width="101" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="263" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="53" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="15" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="91" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="27" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="5" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="42" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="60" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="37" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="28" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="47" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="35" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="74" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="22" height="1" alt=""></td>
	</tr>
</table>
<!-- End ImageReady Slices -->
<script type="text/javascript">
<!--
var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
var MenuBar2 = new Spry.Widget.MenuBar("MenuBar2", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
//-->
</script>
</div>
<table summary="本文内容的排版" style="width: 898px;" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
<tr><td style="width: 16px; font-size: 6px;">　</td>
    <td width="866">

<!-- 本文的档头部分 -->
<div style="text-align:center">
    <a href="http://linux.vbird.org/linux_server/0130internet_connect.php">
    <span class="text_head0">第四章、连上 <span class="text_head_en"> Internet</span></span></a><br>
</div>
    <div style="text-align:right">
        <span class="text_history">最近更新日期：2011/07/20</span>
    </div>
<!-- 本文的连结区部分 -->
<div class="block1">
<span class="text_h1">
4.4 <a href="#problem">常见问题说明</a><br>
	<span class="text_h2">
	　　4.4.1 <a href="#problem_hosts">内部网域使用某些联机服务(如 FTP, POP3)所遇到的联机延迟问题</a><br>
	　　4.4.2 <a href="#problem_dns">网址列无法解析问题</a><br>
	　　4.4.3 <a href="#problem_route">预设路由的问题</a><br>
	</span>
</span></div>
<!-- 本文的正式部分 -->
<hr><a name="problem"></a><img src="../image/logo.png" alt="大标题的图示" width="35" align="middle" height="34"><span class="text_h1">4.4 常见问题说明</span><br>
<div class="block1">
	<p>其实这个小节也很重要的！因为可以让你在念完理论后，了解一下如何利用那些概念来查询你的网络设定问题喔！
	底下我们就针对几个常见的问题来说说看吧！<br><br></p>

	<hr><a name="problem_hosts"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">4.4.1 内部网域使用某些联机服务(如 FTP, 
	POP3)所遇到的联机延迟问题</span><br>
	<div class="block2">
		<p>你或许曾经听过这样的问题：『<span class="text_import2">我在我的内部区域网域内有几部计算机，
		这几部计算机明明都是在同一个网域之内，而且系统通通没有问题，为什么我使用 pop3 或者是
		ftp 连上我的 Linux 主机会停顿好久才连上？但是连上之后，速度就又恢复正常！</span>』</p>

		<p>由于网络在联机时，两部主机之间会互相询问对方的主机名配合的 IP ，以确认对方的身份。
		在目前的因特网上面，我们大多使用 Domain Name System (DNS) 系统做为主机名与 IP 
		对应的查询，那就是我们在上面提到的 /etc/resolv.conf 档案内设定的 IP 由来，
		如果没有指定正确的 DNS IP 的话，那么我们就无法查询到主机名与 IP 的对应了。</p>

		<p>公开的因特网可以这样设定，但是如果是我们内部网域的私有 IP 主机呢？
		因为是私有 IP 的主机，所以当然无法使用 /etc/resolv.conf 的设定来查询到这部主机的名称啊！
		那怎么办？要知道，<span class="text_import2">如果两部主机之间无法查询到正确的主机名与 IP 的对应，
		那么将『可能』发生持续查询主机名对应的动作，这个动作一般需要持续 30-60 
		秒，因此，你的该次联机将会持续检查主机名 30 秒钟，也就会造成奇怪的 delay 的情况</span>。</p>

		<p>这个问题最常发生在内部的 LAN ，例如使用 192.168.1.1 的主机联机到 192.168.1.2 的主机。
		这个问题虽然可以透过修改软件的设定来略过主机名的检查，但是绝大多数的软件都是默认启用这个机制的，
		因此，内部主机『<span class="text_import2">老是联机时期很慢，联机成功后速度就会恢复正常</span>』
		时，通常就是这个问题啦！尤其是在 FTP 及 POP3 等网络联机软件上最常见。</p>

		<p>那么如何避过这个情况？最简单的方法就是『<span class="text_import2">给予内部的主机每部主机一个名称与 
		IP 的对应</span>』即可。举例来说，我们知道每部主机都有一个主机名为 localhost ，对应到 
		127.0.0.1 ，为什么呢？因为这个 127.0.0.1 与 localhost 的对应就被写到 /etc/hosts 内嘛！
		当我们需要主机名与 IP 的对应时，系统就会先到 /etc/hosts 找寻对应的设定值，
		如果找不到，才会使用 /etc/resolv.conf 的设定去因特网找。这样说，你明白了吧？
		也就是说，只要修改了 <span class="text_import1">/etc/hosts</span>，加入每部主机与 IP 的对应，
		就能够加快主机名的检查啰！</p>

		<p>了解了吗？所以说，你就要将你的 私有 IP 的计算机与计算机名称写入你的 
		<span class="text_import1">/etc/hosts</span> 当中了！这也是为啥我们在主机名设定的地方，
		特别强调第五个检查步骤的缘故。我们来看一看 /etc/hosts 原本的设定内容吧！</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">cat /etc/hosts</span>
# Do not remove the following line, or various programs
# that require network functionality will fail.
127.0.0.1               localhost.localdomain   localhost
<span class="term_say"># 主机的 IP             主机的名称              主机的别名</span>
</pre></td></tr></tbody></table>

		<p>在上面的情况中很容易就发现了设定的方法了吧！很简单吧！没错！那就是 IP 对应主机名啦！
		那么现在知道为什么我们给他 ping localhost 的时候，地址会写出 127.0.0.1 了吧！
		那就是写在这个档案中的啦！<span class="text_import2">而且 localhost 那一行不能拿掉呦！
		否则系统的某些服务可能就会无法被启动</span>！好了！那么将我局域网络内的所有的计算机 IP 
		都给他写进去！并且，每一部给他取一个你喜欢的名字，
		<span class="text_import2">即使与 client 的计算机名称设定不同也没关系啦</span>！
		以鸟哥为例，如果我还额外加设了 DHCP 的时候，那么我就干脆将所有的 C Class 
		的所有网段全部给他写入 /etc/hosts 当中，有点像底下这样：</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">vim /etc/hosts</span>
# Do not remove the following line, or various programs
# that require network functionality will fail.
127.0.0.1               localhost.localdomain   localhost
<span class="term_write">192.168.1.1　　linux001
192.168.1.2　　linux002
192.168.1.3　　linux003
.........
.........
192.168.1.254　linux254</span>
</pre></td></tr></tbody></table>

		<p>如此一来，不论我哪一部计算机连上来，不论是在同一个网段的哪一个 IP ，
		我都可以很快速的追查到！嘿嘿！那么区内网络互连的时候，就不会多等个好几时秒钟啰！</p>
	</div>

	<hr><a name="problem_dns"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">4.4.2 网址列无法解析问题</span><br>
	<div class="block2">
		<p>很多朋友常问的一个问题『<span class="text_import2">咦！我可以拨接上网了，也可以 ping 
		到奇摩雅虎的 IP ，但为何就是无法直接以网址连上 Internet 呢！</span>』嘿！被气死！
		前面不是一直强调那个 DNS 解析的问题吗？对啦！就是名称解析不对啦！赶快改一下 
		/etc/resolv.conf 这个档案吧！改成上层 ISP 给你的 DNS 主机的 IP 就可以啦！例如 Hinet 的 
		168.95.1.1 及 Seednet 的 139.175.10.20 啰！例如底下的范例(这个范例就可以照抄了！ ^_^)：</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">vi /etc/resolv.conf</span>
<span class="term_write">nameserver 168.95.1.1
nameserver 139.175.10.20</span>
</pre></td></tr></tbody></table>

		<p>朋友们常常会在这个地方写错，因为很多书上都说这里要设定成为 NAT 主机的 IP ，
		那根本就是不对的！你应该要将所有管理的计算机内，关于 DNS 的设定都直接使用上面的设定值即可！
		除非你的上层环境有使用防火墙，那才另外考虑！</p>
	</div>

	<hr><a name="problem_route"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">4.4.3 预设路由的问题</span><br>
	<div class="block2">
		<p>记得我们在前两章提到的网络基础当中，不是讲了很多预设路由 (default gateway) 相关的说明吗？
		预设路由通常仅有一个，用来做为同一网域的其他主机传递非本网域的封包网关。
		但我们也知道在每个网络配置文件案 (/etc/sysconfig/network-scripts/ifcfg-ethx)
		内部都可以指定『 GATEWAY 』这个参数，若这个参数重复设定的话，那可就麻烦啦！</p>

		<p>举例来说，你的 ifcfg-eth0 用来做为内部网域的沟通，所以你在该档案内设定 GATEWAY 为你自己的 IP ，
		但是该主机为使用 ADSL 拨接，所以当拨接成功后会产生一个 ppp0 的接口，这个 ppp0 接口也有自己的 
		default gateway ，好了，那么当你要将封包传送到 Yahoo 这个非为本网域的主机时，
		这个封包是要传到 eth0 还是 ppp0 呢？因为两个都有 default gateway 啊！</p>

		<p>没错！很多朋友就是这里搞不懂啦！常常会错乱～所以，请注意，
		<span class="text_import2">你的 default gateway 应该只能有一个，
		如果是拨接，请不要在 ifcfg-eth0 当中指定 GATEWAY或 GATEWAYDEV 等变量</span>，重要重要！</p>

		<p>更多的网络除错请参考后续<a href="http://linux.vbird.org/linux_server/0150detect_network.php">第六章 Linux 网络侦错</a>的说明。</p>
	</div>
</div><hr />
    </td>
    <td style="width: 16px; font-size: 6px;">　</td></tr>
<tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
</tbody></table>

<div style="padding-top: 0px; text-align: center;">
<span style="font-size: 80%;">
	<a href="http://linux.vbird.org/" target="_top" title="前往鸟哥的首页">http://linux.vbird.org</a>
	is designed by <a href="mailto:vbird@mail.vbird.idv.tw" title="联络鸟哥(我不要广告信！)">VBird</a>
		during 2001-2011. <a href="http://www.ksu.edu.tw/" target="_blank">ksu.edu</a></span>
         ﻿<div id="apDiv4">
      <p>本网页主要以Firefox配合解析度 1024x768 作为设计依据&nbsp;&nbsp;&nbsp;&nbsp; 鸟哥自由软件整合应用研究室</p></div></div>
</div>
</center>
</body></html>
