<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-TW" lang="zh-TW"><head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf8">
	<meta name="Author" content="VBird, 鸟哥">
	<meta name="Description" content="关于文字接口登入主机的 ssh 及图形接口登入主机的 VNC/XDMCP 等方法">
	<title>鸟哥的 Linux 私房菜 -- 远程联机服务器 SSH/XDMCP/VNC/RDP</title>
    <script src="../script/SpryMenuBar.js" type="text/javascript"></script>
	<script src="../script/index.js" type="text/javascript"></script>
	<link href="../css/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css" />
    <link href="../css/main.css" rel="stylesheet" type="text/css" />
    </head><body style="margin: 0pt; padding: 0pt;" class="table"onload="MM_preloadImages('../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html')">

<center>
<div id="apDiv5">
<div> <LINK REL="SHORTCUT ICON" HREF="../index-2.html">
<!-- ImageReady Slices (title3.ai) -->
<table id="___01" width="898" height="81" border="0" align="center" cellpadding="0" cellspacing="0";>
	<tr>
		<td colspan="15">
			<img src="image/title/title_01.png" width="900" height="1" alt=""></td>
	</tr>
	<tr>
		<td rowspan="4" bgcolor="#182448"><p><img src="http://linux.vbird.org/cgi-bin/Count.cgi?dd=C&amp;ft=5&amp;sh=T&amp;md=8&amp;pad=Y&amp;df=vbird.dic.ksu.edu.tw.dat" width="93" align="left" title="計數器" /></p>
	    <p><font color="#FFFFFF" size="-1">since2012/04/23</font></p></td>
		<td rowspan="4" align="left" valign="top"><a href="../index.html"><img src="image/title/title_03.png" alt="" width="263" height="79" border="0"></a></td>
		<td colspan="13">
			<img src="image/title/title_04.png" alt="" width="535" height="9" border="0"></td>
	</tr>
	<tr>
		<td rowspan="3">
			<img src="image/title/title_05.png" alt="" width="53" height="70" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../linux_basic/0110whatislinux.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image51','','image/title/title_06.png',1)"><img src="image/title/title3_06.png" name="Image51" width="106" height="25" border="0" id="Image51" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_07.png" alt="" width="27" height="37" border="0"></td>
		<td colspan="3" align="left" valign="top"><a href="0110network_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image52','','image/title/title_08.png',1)"><img src="image/title/title3_08.png" name="Image52" width="107" height="25" border="0" id="Image52" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_09.png" alt="" width="37" height="37" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../about.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image53','','image/title/title_10.png',1)"><img src="image/title/title3_10.png" name="Image53" width="75" height="25" border="0" id="Image53" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_11.png" alt="" width="35" height="70" border="0"></td>
		<td align="left" valign="top"><a href="mailto:vbird@mail.vbird.idv.tw" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image54','','image/title/title_12.png',1)"><img src="image/title/title3_12.png" name="Image54" width="74" height="25" border="0" id="Image54" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_13.png" alt="" width="21" height="70" border="0"></td>
	</tr>
	<tr>
		<td colspan="2">
			<img src="image/title/title_14.png" alt="" width="106" height="12" border="0"></td>
		<td colspan="3">
			<img src="image/title/title_15.png" alt="" width="107" height="12" border="0"></td>
		<td colspan="2">
			<img src="image/title/title_16.png" width="75" height="12" alt=""></td>
		<td rowspan="2">
			<img src="image/title/title_17.png" alt="" width="74" height="45" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/title_18.png" alt="" width="15" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar1" class="MenuBarHorizontal">
	  <li><a href="../linux_basic/linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image44','','image/title/title_19.png',1)"><img src="image/title/title3_19.png" name="Image44" width="123" height="33" border="0" id="Image44" /></a>
			    <ul>
			      <li><a href="../linux_basic/Mandrake9.0/mandrake9.0.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image46','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image46" width="120" height="26" border="0" id="Image46" alt="" /></a></li>
                  <li><a href="../linux_basic/fedora_4/fc4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image47','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image47" width="120" height="26" border="0" id="Image47" alt="" /></a></li>
                  <li><a href="../linux_basic/linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image48','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image48" width="120" height="26" border="0" id="Image48" alt="" /></a></li>
                </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_20.png" alt="" width="42" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar2" class="MenuBarHorizontal">
	  <li><a href="index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image45','','image/title/title_21.png',1)"><img src="image/title/title3_21.png" name="Image45" width="125" height="33" border="0" id="Image45" /></a>
			    <ul>
			      <li><a href="linux_redhat9/redhat9.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image43','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image43" width="120" height="26" border="0" id="Image43" alt=""/></a></li>
			      <li><a href="centos4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image49','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image49" width="120" height="26" border="0" id="Image49" alt="" /></a></li>
			      <li><a href="index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image50','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image50" width="120" height="26" border="0" id="Image50" alt="" /></a></li>
		        </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_22.png" alt="" width="47" height="33" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/Spacer.gif" width="101" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="263" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="53" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="15" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="91" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="27" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="5" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="42" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="60" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="37" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="28" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="47" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="35" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="74" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="22" height="1" alt=""></td>
	</tr>
</table>
<!-- End ImageReady Slices -->
<script type="text/javascript">
<!--
var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
var MenuBar2 = new Spry.Widget.MenuBar("MenuBar2", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
//-->
</script>
</div>
<table summary="本文内容的排版" style="width: 898px;" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
<tr><td style="width: 16px; font-size: 6px;">　</td>
    <td width="866">

<!-- 本文的档头部分 -->
<div style="text-align:center">
    <a href="http://linux.vbird.org/linux_server/0310telnetssh.php">
    <span class="text_head0">第十一章、远程联机服务器<span class="text_head_en">SSH / XDMCP / VNC / RDP</span></span></a><br>
</div>
    <div style="text-align:right">
        <span class="text_history">最近更新日期：2011/11/24</span>
    </div>
<!-- 本文的连结区部分 -->
<div class="block1">
<span class="text_h1">
11.4 <a href="#vnc">华丽的图形接口： VNC 服务器</a><br>
	<span class="text_h2">
	　　11.4.1 <a href="#vnc_simple">预设的 VNC 服务器：使用 twm window manager</a>：
		<a href="#vncserver">vncserver</a>, <a href="#vncpasswd">vncpasswd</a><br>
	　　11.4.2 <a href="#vnc_client">VNC 的客户端联机软件</a>： <a href="#vncviewer">vncviewer</a>,
		<a href="#realvnc">realvnc</a><br>
	　　11.4.3 <a href="#vnc_xdmcp">VNC 搭配本机的 Xdmcp 画面</a><br>
	　　11.4.4 <a href="#vnc_init">开机就启动 VNC server 的方法</a><br>
	　　11.4.5 <a href="#vnc_xorg">同步的 VNC ：可以透过图示同步教学</a><br>
	</span>
</span></div>
<!-- 本文的正式部分 -->
<hr><a name="vnc"></a><img src="../image/logo.png" alt="大标题的图示" width="35" align="middle" height="34"><span class="text_h1">11.4 华丽的图形接口： VNC 服务器</span><br>
<div class="block1">
	<p>就如同刚刚上头讲到的，使用 xdmcp 可能会启动多个不同的埠口，导致防火墙设定上面比较困扰些。那有没有简单一点的图形接口连接方式？
	其实还有很多啦，在这里我们先来讲一个比较简单的，那就是 VNC (Virtual Network Computing) 这玩意儿啦！(<a href="#ps6">注6</a>)<br><br></p>

	<hr><a name="vnc_simple"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">11.4.1 预设的 VNC 服务器：使用 
	twm window manager</span><br>
	<div class="block2">
		<p>VNC server 会在服务器端启动一个监听用户要求的端口，一般端口号码在 5901 ~ 5910 之间。当客户端启动 X server 联机到 5901 之后，
		VNC server 再将一堆预先设定好的 X client 透过这个联机传递到客户端上，最终就能够在客户端显示服务器的图形接口了。</p>

		<p>不过需要注意的是，预设的 VNC server 都是独立提供给『单一』一个客户端来联机的，因此当你要使用 VNC 时，
		再联机到服务器去启动 VNC server 即可。所以，一般来说， VNC server 都是使用手动启动的，然后使用完毕后，
		再将 VNC server 关闭即可。整个作法其实很简单喔！你可以这样作：</p>
<a name="vncserver"></a>
<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">vncserver [:号码] [-geometry 分辨率] [options]</span>
[root@www ~]# <span class="term_command">vncserver [-kill :号码]</span>
<span class="term_say">选项与参数：
:号码     ：就是将 VNC server 开在哪个埠口，如果是 :1 则代表 VNC 5901 埠口
-geometry ：就是分辨率，例如 1024x768 或 800x600 之类的
options   ：其他 X 相关的选项，例如 -query localhost 之类的
-kill     ：将已经启动的 VNC 埠口删除！依据身份控制喔。</span>

[root@www ~]# <span class="term_command">yum install tigervnc-server</span>
<span class="term_say"># 这个是必须要的服务器软件，注意软件的名称喔！与之前的版本不同！</span>

<span class="term_hd"># 将 VNC server 启动在 5903 埠口</span>
[root@www ~]# <span class="term_command">vncserver :3</span>

You will require a password to access your desktops.

Password:  <span class="term_note">&lt;==输入 VNC 的联机密码，这是建立 VNC 时所需要的</span>
Verify:    <span class="term_note">&lt;==再输入一次相同的密码</span>
xauth:  creating new authority file /root/.Xauthority

New 'www.centos.vbird:3 (root)' desktop is www.centos.vbird:3

Creating default startup script <span class="term_write">/root/.vnc/xstartup</span>
Starting applications specified in /root/.vnc/xstartup
Log file is /root/.vnc/www.centos.vbird:3.log

[root@www ~]# <span class="term_command">netstat -tulnp | grep X</span>
tcp        0      0 0.0.0.0:5903   0.0.0.0:*      LISTEN      4361/Xvnc
tcp        0      0 0.0.0.0:6000   0.0.0.0:*      LISTEN      1755/Xorg
tcp        0      0 0.0.0.0:6003   0.0.0.0:*      LISTEN      4361/Xvnc
tcp        0      0 :::6000        :::*           LISTEN      1755/Xorg
tcp        0      0 :::6003        :::*           LISTEN      4361/Xvnc
<span class="term_say"># 已经启动所需要的埠口啰！</span>
</pre></td></tr></tbody></table>

		<p>在上述的指令操作中，你要知道的几个项目是： </p>
		<ol class="text_import2">
		<li>密码至少需要六个字符</li>
		<li>依据使用 vncserver 的身份，将刚刚建立的密码放置于该账号家目录下。例如上述的身份是使用 root 身份，因此密码文件会放在 
		/root/.vnc/passwd 这个档案中但是若该档案已经存在，则不会出现建立密码的画面。</li>
		<li>当客户端联机成功后，服务器将会传送 /root/.vnc/startx 内的 X client 给客户端喔！</li>
		</ol>

		<p>那如果你想要修改 VNC 密码呢？很简单，那就使用 vncpasswd 吧！</p>
<a name="vncpasswd"></a>
<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">ls -l /root/.vnc/passwd</span>
-rw-------. 1 root root 8 Jul 26 15:08 /root/.vnc/passwd
[root@www ~]# <span class="term_command">vncpasswd</span>
Password:  <span class="term_note">&lt;==就是这里开始输入新的密码啊！</span>
Verify:
[root@www ~]# <span class="term_command">ls -l /root/.vnc/passwd</span>
-rw-------. 1 root root 8 Jul 26 15:15 /root/.vnc/passwd
<span class="term_say"># 看吧！时间有更新喔！这个档案的内容更动过啰！</span>
</pre></td></tr></tbody></table>

		<p>接下来开始放行 5903 这个埠口的联机防火墙规则吧！因为预计可能会开放 11 个 VNC 的埠口，所以干脆一口气开放 11 个埠口吧！</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">vim /usr/local/virus/iptables/iptables.allow</span>
iptables -A INPUT -i $EXTIF -s 192.168.100.0/24 -p tcp --dport 5900:5910 -j ACCEPT

[root@www ~]# <span class="term_command">/usr/local/virus/iptables/iptables.rule</span>
[root@www ~]# <span class="term_command">iptables-save</span>
-A INPUT -s 192.168.100.0/24 -i eth0 -p tcp -m tcp --dport 5900:5910 -j ACCEPT
<span class="term_say"># 要看得到上面这行才 OK 喔！</span>
</pre></td></tr></tbody></table>
	</div>

	<hr><a name="vnc_client"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">11.4.2 VNC 的客户端联机软件</span><br>
	<div class="block2">
		<p>与 xdmcp 很类似啦， VNC 客户端在 Linux 系统上面有默认的软件，但是在 Windows 系统上面则必须要额外安装其他软件。
		我们先来谈谈 Linux 的 VNC 用户软件吧！<br><br></p>

		<a name="vncviewer"></a>
		<ul class="list1"><li class="text_import1"><hr>Linux 客户端程序： vncviewer</li></ul>

		<p>用在 Linux 客户端的 VNC 程序，那就是 vncviewer。只是，这个软件默认没有安装，所以你得要使用 yum
		安装完毕后再来联机吧！不过一样要注意，服务器端的防火墙一样要设定妥当喔！然后开始在客户端的图形接口上执行底下数据：</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@clientlinux ~]# <span class="term_command">yum install tigervnc</span>
[root@clientlinux ~]# <span class="term_command">vncviewer 192.168.10.254:3</span>
<span class="term_say"># 这个指令请一定一定要在图形接口上面执行才行喔！很重要！别忘了！</span>
</pre></td></tr></tbody></table>

		<center><img src="0310telnetssh_files/centos6_vncviewer_1.gif" alt="在 Linux 客户端执行 vncviewer 程序示意" title="在 Linux 客户端执行 vncviewer 程序示意" border="1"><br>
		图 11.4-1、在 Linux 客户端执行 vncviewer 程序示意<br></center>

		<p>在上图当中输入刚刚的 root 的 VNC 联机密码，请注意喔，是 VNC 的联机密码，而不是 root 的登入密码！
		这两者是差很多的！也由于启动 VNC 的身份是 root ，因此这里才使用 root 的 VNC 联机密码。
		所以，很多时刻，我们都是建议使用一般身份来启动 VNC server 的啦！当你输入正确的 VNC 联机密码后，
		会出现如下的图示啰：</p>

		<center><img src="0310telnetssh_files/centos6_vncviewer_2.gif" alt="在 Linux 客户端执行 vncviewer 程序示意" title="在 Linux 客户端执行 vncviewer 程序示意" border="1"><br>
		图 11.4-2、在 Linux 客户端执行 vncviewer 程序示意<br></center>

		<p>与以前的 VNC server 较大的差异，在 CentOS 6.x 当中，tigervnc-server 
		这套软件会主动的依据服务器端的图形接口登入方式给予正确的图形显示接口，而不是以前那样给予一个丑丑的 twm 而已！
		这样我们就可以减少还得要修改一些有的没有的配置文件了！真是棒！
		联机成功后，<span class="text_import2">请在客户端关闭这个 vncviewer 的联机</span>，因为接下来我们要准备由 
		Windows 联机到服务器的 port 5903 啰！<br><br></p>

		<a name="realvnc"></a>
		<ul class="list1"><li class="text_import1"><hr>Windows 客户端程序： realvnc</li></ul>

		<p>Windows 底下可用的 vnc client 软件不少，但是鸟哥比较熟悉的是 realvnc 这家公司出品的 GNU 的自由软件！
		你可以在底下的连结下载到最简单的版本，是不用钱的自由软件版本喔！(鸟哥仅下载不用安装的 viewer 版本而已！)</p>

		<ul><li><a href="http://www.realvnc.com/download.html" target="_blank">http://www.realvnc.com/download.html</a></li></ul>

		<p>直接执行 vnc-viewer 软件，然后就会看到如下的画面：</p>

		<center><img src="0310telnetssh_files/centos6_realvnc_1.gif" alt="Windows Real VNC 客户端联机示意图" title="Windows Real VNC 客户端联机示意图" border="1"><br>
		图 11.4-3、Windows Real VNC 客户端联机示意图<br></center>

		<p>如上图所示，你在 server 字段填上 IP:port 的数据即可，然后按下『OK』吧！</p>

		<center><img src="0310telnetssh_files/centos6_realvnc_2.gif" alt="Windows Real VNC 客户端联机示意图" title="Windows Real VNC 客户端联机示意图" border="1"><br>
		图 11.4-4、Windows Real VNC 客户端联机示意图<br></center>

		<p>由于 VNC server 需要的仅是联机的 VNC 密码而已，因此上图中的 Username 可以不用填，老实说，这个程序它也不会让你填～
		呵呵！填完按下『OK』即可！接下来就会出现正确的画面啰！</p>

		<center><img src="0310telnetssh_files/centos6_realvnc_3.gif" alt="Windows Real VNC 客户端联机示意图" title="Windows Real VNC 客户端联机示意图" border="1"><br>
		图 11.4-5、Windows Real VNC 客户端联机示意图<br></center>
	</div>

	<hr><a name="vnc_xdmcp"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">11.4.3 VNC 搭配本机的 Xdmcp 画面</span><br>
	<div class="block2">
		<p>如果因为某些特殊因素，你得要使用 VNC 来搭配 xdmcp 的输出时，那就直接在服务器透过底下的指令来处理即可！
		要注意喔，你必须要已经启动了 xdmcp 了喔！而且，我们底下使用 student 的身份来启动这个 VNC 吧！</p>

<table class="term"><tbody><tr><td class="term"><pre><span class="term_hd"># 1. 要确定 xdmcp 已经启动了才可以：</span>
[root@www ~]# <span class="term_command">netstat -tlunp | grep 177</span>
udp        0      0 0.0.0.0:177   0.0.0.0:*      1734/gdm-binary
<span class="term_say"># OK 的！确实有启动的啦！如果没有看到 177 的话，回到 <a href="#xdmcp">11.3</a> 去处理处理</span>

<span class="term_hd"># 2. 切换成 student，并且启动 VNC server 在 :5</span>
[root@www ~]# <span class="term_command">su - student</span>
[student@www ~]$ <span class="term_command">vncserver :5 -query localhost</span>
You will require a password to access your desktops.

Password:
Verify:
xauth:  creating new authority file /home/student/.Xauthority

New 'www.centos.vbird:5 (student)' desktop is www.centos.vbird:5

Creating default startup script <u>/home/student/.vnc/xstartup</u>
Starting applications specified in /home/student/.vnc/xstartup
Log file is /home/student/.vnc/www.centos.vbird:5.log

<span class="term_hd"># 3. 取消 xstartup 的启动内容</span>
[student@www ~]$ <span class="term_command">vim /home/student/.vnc/xstartup</span>
<span class="term_say">....(前面省略)....</span>
#xterm -geometry 80x24+10+10 -ls -title "$VNCDESKTOP Desktop" &amp;
#twm &amp;
<span class="term_say"># 将这个档案的内容，全部都加上 # 批注掉</span>

<span class="term_hd"># 4. 重新启动 vncserver 喔！</span>
[student@www ~]$ <span class="term_command">vncserver -kill :5</span>
[student@www ~]$ <span class="term_command">vncserver :5 -query localhost</span>
</pre></td></tr></tbody></table>

		<p>接下来<span class="text_import2">请使用 root 的身份加入 5905 的端口防火墙规则</span>，然后自行使用 Linux 的 
		vncviewer 或 Windows 的 RealVNC 来联机，你就会发现如下的画面：</p>

		<center><img src="0310telnetssh_files/centos6_vnc_xdmcp_1.gif" alt="透过 VNC 通道取得 xdmcp 画面" title="透过 VNC 通道取得 xdmcp 画面" border="1"><br>
		图 11.4-6、透过 VNC 通道取得 xdmcp 画面<br></center>

		<p>我们这只 VNC 的联机程序是 student 身份，但是我们却可以透过 xdmcp 的登入功能来登入 root 身份喔！
		因为在服务器上面的 Xvnc 程序是 student 拥有，这样会比较好啦！了解呼？</p>
	</div>

	<hr><a name="vnc_init"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">11.4.4 开机就启动 VNC server 的方法</span><br>
	<div class="block2">
		<p>请注意，你不要将 vncserver 的指令写入在 /etc/rc.d/rc.local 中，否则可能会产生 localhost 无法登入的问题。
		那该如何让你的 VNC server 在一开机就启动而不须要登入执行指令呢？可以的，但是你得要修改一下配置文件。
		我们底下使用 student 的身份启动 VNC server，而启动的方式为使用 xdmcp 登入画面，启动的埠口就定在 5901 好了。
		那你应该这样作：</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">vim /etc/sysconfig/vncservers</span>
<span class="term_write">VNCSERVERS="1:student"
VNCSERVERARGS[1]="-query localhost"</span>
<span class="term_say"># 上述两行的 1 指的就是那个埠口 5901 喔！要注意！</span>

[root@www ~]# <span class="term_command">/etc/init.d/vncserver restart</span>
[root@www ~]# <span class="term_command">chkconfig vncserver on</span>
</pre></td></tr></tbody></table>

		<p>有够好简单吧！这样每次开机就搞定你的 VNC server 啰！</p>
	</div>

	<hr><a name="vnc_xorg"></a><img src="../image/logo.png" alt="小标题的图示" width="24" align="middle" height="23"><span class="text_h2">11.4.5 同步的 VNC ：可以透过图示同步教学</span><br>
	<div class="block2">
		<p>另外，有些朋友一定会觉得奇怪，那就是，为甚么我的 VNC 服务器的 server / client 端画面并不是同步的呢?
		这是因为 Linux 本身提供多个 VNC server ，她们是各自独立的，所以当然就不会与 tty7 的画面同步了。
		但是如果你想要与 Linux 的 tty7 同步的话，可以利用 VNC 释出的给 X Server 使用的模块来加以设定即可。</p>

		<p>那使用这个模块有甚么好处啊？就是可以让两个图形接口在 server/client 都是一样的，
		所以，如果你想要教你的朋友你是如何设定的，那就可以透过这个机制来处理，你的朋友在远程就能够知道你一步一步进行的过程！
		这样很不赖吧！详细的作法可以参考底下的连结：</p>

		<ul><li><a href="http://phorum.study-area.org/viewtopic.php?t=25713" target="_blank">http://phorum.study-area.org/viewtopic.php?t=25713</a></li></ul>

		<p>我们也来实做一下吧 (在 CentOS 6.x 当中并没有 xorg.conf 这个配置文件喔！所以，如果你要使用这些数据的话，
		恐怕得要自行使用 X -configure 去建置 xorg.conf 后，再挪到 /etc/X11/ 去，然后才改的到设定！)：</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">yum install tigervnc-server-module</span>
[root@www ~]# <span class="term_command">vim /etc/X11/xorg.conf</span>
Section "Screen"
        Identifier "Screen0"
        Device     "Videocard0"
        DefaultDepth     24
        <span class="term_write"># VBird
        Option "passwordFile" "/home/student/.vnc/passwd"</span>
        SubSection "Display"
                Viewport   0 0
                Depth     24
        EndSubSection
EndSection

<span class="term_write"># VBird
Section "Module"
    Load    "vnc"
EndSection</span>
<span class="term_say"># 假设你的 vnc 密码档案放置在 /home/student/.vnc/passwd 里头，
# 这个时候就得要将密码文件内容写到 Screen 这个 section 当中了</span>

[root@www ~]# <span class="term_command">init 3 ; init 5</span>
[root@www ~]# <span class="term_command">netstat -tlunp | grep X</span>
tcp        0      0 0.0.0.0:5900   0.0.0.0:*      LISTEN      7445/Xorg
tcp        0      0 0.0.0.0:6000   0.0.0.0:*      LISTEN      7445/Xorg
tcp        0      0 :::6000        :::*           LISTEN      7445/Xorg
<span class="term_say"># 注意看喔！这几个 port 启动的 PID 都一样喔！所以会启动一个 port 5900 啰！</span>
</pre></td></tr></tbody></table>

		<p>之后你可以使用『 vncviewer 192.168.100.254 』来联机即可，不需要加上 :0 之类的埠口。
		然后你可以看一下客户端与服务器端的图形接口，你会发现到两者移动鼠标时，两者的画面会同步运作喔！
		非常有趣呢！只不过这个动作还是只允许一条 VNC 联机，不能让所有客户端都连到 port 5900 ，这真是太可惜了！</p>
	</div>
</div>
<hr />
    </td>
    <td style="width: 16px; font-size: 6px;">　</td></tr>
<tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
</tbody></table>

<div style="padding-top: 0px; text-align: center;">
<span style="font-size: 80%;">
	<a href="http://linux.vbird.org/" target="_top" title="前往鸟哥的首页">http://linux.vbird.org</a>
	is designed by <a href="mailto:vbird@mail.vbird.idv.tw" title="联络鸟哥(我不要广告信！)">VBird</a>
		during 2001-2011. <a href="http://www.ksu.edu.tw/" target="_blank">ksu.edu</a></span>
         ﻿<div id="apDiv4">
      <p>本网页主要以Firefox配合解析度 1024x768 作为设计依据&nbsp;&nbsp;&nbsp;&nbsp; 鸟哥自由软件整合应用研究室</p></div></div>
</div>
</center>
</body></html>
