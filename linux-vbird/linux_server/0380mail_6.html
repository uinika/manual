<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-TW" lang="zh-TW"><head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf8">
	<meta name="Author" content="VBird, 鸟哥">
	<meta name="Description" content="电子邮件主机之设定，主要介绍 Postfix ，不过亦有提及 Sendmail 的相关技巧">
	<title>鸟哥的 Linux 私房菜 -- Mail Server</title>
    <script src="../script/SpryMenuBar.js" type="text/javascript"></script>
	<script src="../script/index.js" type="text/javascript"></script>
	<link href="../css/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css" />
    <link href="../css/main.css" rel="stylesheet" type="text/css" />
    </head><body style="margin: 0pt; padding: 0pt;" class="table"onload="MM_preloadImages('../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html','../index-2.html')">

<center>
<div id="apDiv5">
<div> <LINK REL="SHORTCUT ICON" HREF="../index-2.html">
<!-- ImageReady Slices (title3.ai) -->
<table id="___01" width="898" height="81" border="0" align="center" cellpadding="0" cellspacing="0";>
	<tr>
		<td colspan="15">
			<img src="image/title/title_01.png" width="900" height="1" alt=""></td>
	</tr>
	<tr>
		<td rowspan="4" bgcolor="#182448"><p><img src="http://linux.vbird.org/cgi-bin/Count.cgi?dd=C&amp;ft=5&amp;sh=T&amp;md=8&amp;pad=Y&amp;df=vbird.dic.ksu.edu.tw.dat" width="93" align="left" title="計數器" /></p>
	    <p><font color="#FFFFFF" size="-1">since2012/04/23</font></p></td>
		<td rowspan="4" align="left" valign="top"><a href="../index.html"><img src="image/title/title_03.png" alt="" width="263" height="79" border="0"></a></td>
		<td colspan="13">
			<img src="image/title/title_04.png" alt="" width="535" height="9" border="0"></td>
	</tr>
	<tr>
		<td rowspan="3">
			<img src="image/title/title_05.png" alt="" width="53" height="70" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../linux_basic/0110whatislinux.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image51','','image/title/title_06.png',1)"><img src="image/title/title3_06.png" name="Image51" width="106" height="25" border="0" id="Image51" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_07.png" alt="" width="27" height="37" border="0"></td>
		<td colspan="3" align="left" valign="top"><a href="0110network_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image52','','image/title/title_08.png',1)"><img src="image/title/title3_08.png" name="Image52" width="107" height="25" border="0" id="Image52" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_09.png" alt="" width="37" height="37" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="../about.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image53','','image/title/title_10.png',1)"><img src="image/title/title3_10.png" name="Image53" width="75" height="25" border="0" id="Image53" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_11.png" alt="" width="35" height="70" border="0"></td>
		<td align="left" valign="top"><a href="mailto:vbird@mail.vbird.idv.tw" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image54','','image/title/title_12.png',1)"><img src="image/title/title3_12.png" name="Image54" width="74" height="25" border="0" id="Image54" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_13.png" alt="" width="21" height="70" border="0"></td>
	</tr>
	<tr>
		<td colspan="2">
			<img src="image/title/title_14.png" alt="" width="106" height="12" border="0"></td>
		<td colspan="3">
			<img src="image/title/title_15.png" alt="" width="107" height="12" border="0"></td>
		<td colspan="2">
			<img src="image/title/title_16.png" width="75" height="12" alt=""></td>
		<td rowspan="2">
			<img src="image/title/title_17.png" alt="" width="74" height="45" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/title_18.png" alt="" width="15" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar1" class="MenuBarHorizontal">
	  <li><a href="../linux_basic/linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image44','','image/title/title_19.png',1)"><img src="image/title/title3_19.png" name="Image44" width="123" height="33" border="0" id="Image44" /></a>
			    <ul>
			      <li><a href="../linux_basic/Mandrake9.0/mandrake9.0.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image46','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image46" width="120" height="26" border="0" id="Image46" alt="" /></a></li>
                  <li><a href="../linux_basic/fedora_4/fc4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image47','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image47" width="120" height="26" border="0" id="Image47" alt="" /></a></li>
                  <li><a href="../linux_basic/linux_basic.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image48','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image48" width="120" height="26" border="0" id="Image48" alt="" /></a></li>
                </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_20.png" alt="" width="42" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar2" class="MenuBarHorizontal">
	  <li><a href="index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image45','','image/title/title_21.png',1)"><img src="image/title/title3_21.png" name="Image45" width="125" height="33" border="0" id="Image45" /></a>
			    <ul>
			      <li><a href="linux_redhat9/redhat9.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image43','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image43" width="120" height="26" border="0" id="Image43" alt=""/></a></li>
			      <li><a href="centos4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image49','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image49" width="120" height="26" border="0" id="Image49" alt="" /></a></li>
			      <li><a href="index.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image50','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image50" width="120" height="26" border="0" id="Image50" alt="" /></a></li>
		        </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_22.png" alt="" width="47" height="33" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/Spacer.gif" width="101" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="263" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="53" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="15" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="91" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="27" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="5" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="42" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="60" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="37" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="28" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="47" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="35" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="74" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="22" height="1" alt=""></td>
	</tr>
</table>
<!-- End ImageReady Slices -->
<script type="text/javascript">
<!--
var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
var MenuBar2 = new Spry.Widget.MenuBar("MenuBar2", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
//-->
</script>
</div>
<table summary="本文内容的排版" style="width: 898px;" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
<tr><td style="width: 16px; font-size: 6px;">　</td>
    <td width="866">

<!-- 本文的档头部分 -->
<div style="text-align:center">
    <a href="http://linux.vbird.org/linux_server/0380mail.php">
    <span class="text_head0">第二十二章、邮件服务器：<span class="text_head_en"> Postfix</span></span></a><br>
</div>
    <div style="text-align:right">
        <span class="text_history">最近更新日期：2011/08/10</span>
    </div>

<!-- 本文的连结区部分 -->
<div class="block1">
<span class="text_h1">
22.6 <a href="#hint">重点回顾</a><br>
22.7 <a href="#ex">本章习题</a><br>
22.8 <a href="#reference">参考数据与延伸阅读</a><br>
<span class="text_h2">
22.9 <a href="http://phorum.vbird.org/viewtopic.php?p=117550" target="_blank">针对本文的建议：http://phorum.vbird.org/viewtopic.php?p=117550</a><br>
</span>
</span></div>
<!-- 本文的正式部分 -->
<hr><a name="hint"></a><img src="../image/logo.png" alt="大标题的图示" width="35" align="middle" height="34"><span class="text_h1">22.6 重点回顾</span><br>
<div class="block1">
<ul class="text_import2">
	<li>电子邮件服务器的设定需要特别留意，以免被作为广告信与垃圾信的跳板；</li>
	<li>Mail server 使用的主机名至少需要 A 的 DNS 标志，不过最好能够具有 MX 标志为宜，且正反解最好成对，
		比较可以避免大型 mail server 的抵挡；</li>
	<li>邮件服务器主要是指 SMTP (简单邮件传送协议) 而已，不过要架设一部可利用类似 Thunderbird 收发的邮件服务器，
		最好能够具有 SMTP 以及 POP3 等通讯协议；</li>
	<li>电子邮件传送的组件，主要有 MUA, MTA, MDA 以及最终的 Mailbox 等等；</li>
	<li>电子邮件服务器最需要搞定的地方其实是 Relay 的功能，千万不可 Open Relay 喔！</li>
	<li>一封电子邮件至少含有 header 以及 body 等数据在内；</li>
	<li>常见的可以启动 SMTP 的软件有 sendmail, postfix 及 qmail 等等。</li>
	<li>为避免收到大量的广告信，建议您不要将 email address 放在因特网上，若需要某些功能必需将邮件地址放在网络上时，
		最好能够拥有两个邮件地址，一个用来公开，一个则用来作为自己的主要联络之用。</li>
</ul>
</div>


<hr><a name="ex"></a><img src="../image/logo.png" alt="大标题的图示" width="35" align="middle" height="34"><span class="text_h1">22.7 本章习题</span><br>
<div class="block1">
<ul>
	<li>当你利用你的 MTA 发信时，结果竟然被退信，退信的讯息 (/var/log/maillog) 最主要的错误是『mail loop to me』，
		请问可能的发生原因及处理方式为何？
	<div class="blockex">
		可能发生的原因是由于你的 MTA 设定项目方面的主机名错误。判断你的 MTA 主机有多个 IP 存在，
		不过你并未完全写入配置文件中，因此造成某些主机名无法被 MTA 所接收之故。在 sendmail 方面，
		你只要将需要的主机名写入 /etc/mail/local-host-names 即可，如果是 postfix ，则在 /etc/postfix/main.cf 
		当中修改 $mydestination 那个设定项目即可。
	</div></li>

	<li>请列出四个 Mail Server 的相关的组件，以及其功用为何？
	<div class="blockex">
		<ul>
		<li>Mail Client ：邮件客户端，其实就是使用 mail 的那位用户所在的计算机即可称为 mail client ；</li>
		<li>Mail User Agent ：为一个应用软件，主要的功能就是收受邮件主机的电子邮件，以及提供用户浏览与编写邮件的功能；</li>
		<li>Mail Transfer Agent ：为在计算机与本地端 Mail server 或 Internet 上面的 Mail server 传送讯息与邮件的主机；</li>
		<li>Mail Dilivery Agent ：主要的功能就是将 MTA 所收受的本机信件，放置到本机账户下的邮件档案中 ( Mailbox )！</li>
		</ul>
	</div></li>

	<li>POP3 与 SMTP 的功能为何？
	<div class="blockex">
		<ul>
		<li>SMTP 为使用于 MUA 或 MTA 与 MTA 之间的传输协议，通常使用 port 25 ，只要主机支持 SMTP ，并且其他 
		relay 的条件能配合，就可以进行邮件传递！</li>
		<li>POP3 可以提供使用者经由 MUA 到 MTA 下载邮件，同时并可将邮件从主机上面删除！</li>
		</ul>
	</div></li>

	<li>请简单的说明 DNS 里面 MX 标志与 Mail 的关系为何？
	<div class="blockex">
		MX recode 可以可以让 mail server 经由 MX 以及 A ( address ) 这个记录来进行 mail gateway 与 mail route 
		的功能！能够达到的作用相当的多！
	</div></li>

	<li>什么是 mailling list ？在 postfix 底下有什么方法可以不藉由其他的软件达到 mailling list 的功能？
	<div class="blockex">
		Mailling list 就是将使用者寄给一个账号邮件时，该账号会主动的将该邮件传送到所有的用户去！有点类似目前的电子报！在 sendmail 
		底下，我们可以透过 aliases (需配合 newaliases) 以及 ~/.forward 来达成喔！
	</div></li>

	<li>如何察看邮件队列的内容，以及邮件队列内容放置在何方？
	<div class="blockex">
		使用 mailq 即可知道目前邮件队列的内容，而邮件队列虽然可以透过 sendmail.cf 来修改，不过，预设情况下，都是以 
		/var/spool/mqueue 为邮件队列目录。 
	</div></li>

	<li>什么是 Open Relay？
	<div class="blockex">
		所谓的 Open Relay 就是，不论发信端来自何处，您的 Open Relay 的主机均可以帮发信端将信件发送出去，这个称为 
		Open Relay 。如果您的 mail server 具有 open relay 的情况，那么很容易遭受到垃圾邮件的填充，
		不但造成网络带宽的耗损，也容易让您的主机被列入黑名单当中！
	</div></li>

	<li>如果要让 Postfix 可以收发来自非本机的外部信件，您可以修改 main.cf 里面的什么参数？
	<div class="blockex">
		需要在 main.cf 里面修改的变量主要有：
		<ol>
		<li>当 Client 来自信任的网域，也就是 IP 符合 $mynetworks 的设定值时；</li>
		<li>当 Client 来自信任的机器，也就是主机名符合 $relay_domains 的设定项目时；</li>
		<li>当 Client 来自不信任的网域，但是去的目的地主机端符合 $relay_domains 的设定时。</li>
		</ol>
	</div></li>

	<li>如何察看您目前的 Postfix 服务器的所有设定参数？(使用什么指令？)
	<div class="blockex">
		利用 postconf -n 可以察看『目前 main.cf 里面设定的参数』，而如果要看所有的参数，则直接使用 postconf 即可！
	</div></li>

	<li>Mail Server 能否运作与 DNS ( MX 与 A recode )的相关性为何？
	<div class="blockex">
		目前因特网社会合法的 Mail server 通常仅会针对具有 MX 标志的邮件主机发出信件而已。
		而如果有多重 MX 时，首先会选择最小 MX 主机寄信，依序处理。而最终依据 MX 主机的 A 标志来查得最终目标。
	</div></li>

	<li>什么是 smtp, pop3 以及 imap 协议，他们的用途分别是什么？
	<div class="blockex">
		<ul>
		<li>smtp：用来传递邮件的协议，通常我们称为 MTA 即是此一协议所达成</li>
		<li>pop3：让 client 端向主机端要求收信的协议，通常预设收信完成后，主机端的 mail box 会被删除；</li>
		<li>imap：与 pop3 类似，不过 imap 允许用户在主机的家目录建立邮件数据匣</li>
		</ul>
	</div></li>
</ul>
</div>


<hr><a name="reference"></a><img src="../image/logo.png" alt="大标题的图示" width="35" align="middle" height="34"><span class="text_h1">22.8 参考数据与延伸阅读</span><br>
<div class="block1">
<ul>
	<li>Sendmail 官方网站： <a href="http://www.sendmail.org/" target="_blank">http://www.sendmail.org</a></li>
	<li>Postfix 官方网站： <a href="http://www.postfix.org/" target="_blank">http://www.postfix.org</a></li>
	<li>Cyrus-SASL 官方网站： <a href="http://asg.web.cmu.edu/cyrus/download/sasl/doc/" target="_blank">http://asg.web.cmu.edu/cyrus/download/sasl/doc/</a></li>
	<li>Procmail 官方网站： <a href="http://www.procmail.org/" target="_blank">http://www.procmail.org</a></li>
	<li>Open Relay Database： <a href="http://www.ordb.org/" target="_blank">http://www.ordb.org/</a>
		(很可惜，已于 2006/12/18 关站)</li>
	<li>Study Area 之邮件架设：<a href="http://www.study-area.org/linux/servers/linux_mail.htm" target="_blank">http://www.study-area.org/linux/servers/linux_mail.htm</a></li>
	<li>SMTP 认证系统的建置：<a href="http://beta.wsl.sinica.edu.tw/~ylchang/Email/sendmail-auth/" target="_blank">http://beta.wsl.sinica.edu.tw/~ylchang/Email/sendmail-auth/</a></li>
	<li>台湾学术网络黑名单网页： <a href="http://rs.edu.tw/tanet/spam.html" target="_blank">http://rs.edu.tw/tanet/spam.html</a></li>
	<li>卧龙小三的 Procmailrc 范例：<a href="ftp://ftp.tnc.edu.tw/pub/Sysop/MAIL/procmailrc" target="_blank">ftp://ftp.tnc.edu.tw/pub/Sysop/MAIL/procmailrc</a></li>
	<li>林克敏主任文件集之 Procmail 范例：<a href="http://freebsd.lab.mlc.edu.tw/procmail.htm" target="_blank">http://freebsd.lab.mlc.edu.tw/procmail.htm</a></li>
	<li>Postgrey 官方网站：<a href="http://isg.ee.ethz.ch/tools/postgrey/" target="_blank">http://isg.ee.ethz.ch/tools/postgrey/</a></li>
	<li>Postfix 针对 Postgrey 的设定： <a href="http://www.postfix.org/SMTPD_POLICY_README.html" target="_blank">http://www.postfix.org/SMTPD_POLICY_README.html</a></li>
	<li>一些 postfix 的 relay 机制设定： <a href="http://jimsun.linxnet.com/misc/postfix-anti-UCE.txt" target="_blank">http://jimsun.linxnet.com/misc/postfix-anti-UCE.txt</a></li>
	<li>小州的 postfix 设定： <a href="http://phorum.study-area.org/viewtopic.php?t=30716" target="_blank">http://phorum.study-area.org/viewtopic.php?t=30716</a></li>
	<li>POSTFIX 技术手札，Ralf Hildebrandt/Patrick Koetter 合着，上奇出版，2005年。</li>
	<li>TWU2 兄在酷学园所发表的自制邮件过滤软件： <a href="http://phorum.study-area.org/viewtopic.php?t=38649" target="_blank">http://phorum.study-area.org/viewtopic.php?t=38649</a></li>
	<li>Amavis-new 一个在 MTA 与队列间的服务：<a href="http://www.ijs.si/software/amavisd/" target="_blank">http://www.ijs.si/software/amavisd/</a></li>
	<li>广告信件分析软件：<a href="http://spamassassin.apache.org/index.html" target="_blank">http://spamassassin.apache.org/index.html</a></li>
	<li>Steven 的垃圾信抵挡机制：<a href="http://www.l-penguin.idv.tw/article/postfix_spam-spamassassin.htm" target="_blank">http://www.l-penguin.idv.tw/article/postfix_spam-spamassassin.htm</a></li>
</ul>
</div>
<hr />
    </td>
    <td style="width: 16px; font-size: 6px;">　</td></tr>
<tr><td style="width: 16px; height: 16px;">　</td>
    <td style="width: 866px; height: 16px;">　</td>
    <td style="width: 16px; height: 16px;">　</td></tr>
</tbody></table>

<div style="padding-top: 0px; text-align: center;">
<span style="font-size: 80%;">
	<a href="http://linux.vbird.org/" target="_top" title="前往鸟哥的首页">http://linux.vbird.org</a>
	is designed by <a href="mailto:vbird@mail.vbird.idv.tw" title="联络鸟哥(我不要广告信！)">VBird</a>
		during 2001-2011. <a href="http://www.ksu.edu.tw/" target="_blank">ksu.edu</a></span>
         ﻿<div id="apDiv4">
      <p>本网页主要以Firefox配合解析度 1024x768 作为设计依据&nbsp;&nbsp;&nbsp;&nbsp; 鸟哥自由软件整合应用研究室</p></div></div>
</div>
</center>
</body></html>
