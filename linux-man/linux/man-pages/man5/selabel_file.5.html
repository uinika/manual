
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
        "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <link rel="stylesheet" type="text/css" href="../../../style.css" title="style" />
    <link rel="stylesheet" type="text/css" href="../style.css" title="style" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />

    <title>selabel_file(5) - Linux manual page</title>
</head>

<body>

<div class="page-top"><a id="top_of_page"></a></div>
<!--%%%TOP_BAR%%%-->
    <div class="nav-bar">
        <table class="nav-table">
            <tr>
                <td class="nav-cell">
                    <p class="nav-text">
                        <a href="http://man7.org/index.html">man7.org</a> &gt; Linux &gt; <a href="../index.html">man-pages</a>
                    </p>
                </td>
                <td class="training-cell">
                    <p class="training-text"><a class="training-link" href="http://man7.org/training/">Linux/UNIX system programming training</a></p>
                </td>
            </tr>
        </table>
    </div>

<hr class="nav-end" />

<!--%%%PAGE_START%%%-->


<table class="sec-table">
<tr>
    <td>
        <p class="section-dir">
<a href="#NAME">NAME</a> | <a href="#SYNOPSIS">SYNOPSIS</a> | <a href="#DESCRIPTION">DESCRIPTION</a> | <a href="#OPTIONS">OPTIONS</a> | <a href="#FILES">FILES</a> | <a href="#FILE_FORMAT">FILE&nbsp;FORMAT</a> | <a href="#File_Contexts_Format">File&nbsp;Contexts&nbsp;Format</a> | <a href="#Substitution_File_Format">Substitution&nbsp;File&nbsp;Format</a> | <a href="#NOTES">NOTES</a> | <a href="#SEE_ALSO">SEE&nbsp;ALSO</a> | <a href="#COLOPHON">COLOPHON</a>
        </p>
    </td>
    <td class="search-box">
        <div class="man-search-box">

            <form method="get" action="http://www.google.com/search">
                <fieldset class="man-search">
                    <input type="text" name="q" size="10" maxlength="255" value="" />
                    <input type="hidden" name="sitesearch" value="man7.org/linux/man-pages" />
                    <input type="submit" name="sa" value="Search online pages" />
                </fieldset>
            </form>

        </div>
    </td>
    <td> </td>
</tr>
</table>

<pre>
<span class="headline">selabel_file(5)           SELinux API documentation          selabel_file(5)</span>
</pre>
<h2><a id="NAME" href="#NAME"></a>NAME  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       selabel_file - userspace SELinux labeling interface and configuration
       file format for the file contexts backend
</pre>
<h2><a id="SYNOPSIS" href="#SYNOPSIS"></a>SYNOPSIS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <b>#include &lt;selinux/label.h&gt;</b>

       <b>int selabel_lookup(struct selabel_handle *</b><i>hnd</i><b>,</b>
                          <b>char **</b><i>context</i><b>,</b>
                          <b>const char *</b><i>path</i><b>, int </b><i>mode</i><b>);</b>

       <b>int selabel_lookup_raw(struct selabel_handle *</b><i>hnd</i><b>,</b>
                          <b>char **</b><i>context</i><b>,</b>
                          <b>const char *</b><i>path</i><b>, int </b><i>mode</i><b>);</b>
</pre>
<h2><a id="DESCRIPTION" href="#DESCRIPTION"></a>DESCRIPTION  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       The file contexts backend maps from pathname/mode combinations into
       security contexts. It is used to find the appropriate context for
       each file when relabeling a file system. The returned <i>context</i> must be
       freed using <a href="../man3/freecon.3.html">freecon(3)</a>.
       <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a> describes the function with its return and error
       codes, however the following <i><a href="../man3/errno.3.html">errno</a></i> is clarified further for the file
       contexts backend:

              <b>ENOENT </b>No context corresponding to the <i>path</i> and <i>mode</i> was found
                     - This will also be returned when the file contexts
                     series of files have a context of <b>&lt;&lt;none&gt;&gt; </b>against the
                     <i>path</i> (see the <b>FILE FORMAT </b>section).

       The <i>path</i> argument should be set to the full pathname of the file
       whose assigned context is being checked. The <i>mode</i> argument should be
       set to the mode bits of the file, as determined by <a href="../man2/lstat.2.html">lstat(2)</a>. <i>mode</i> may
       be zero, however full matching may not occur.

       Any messages generated by <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a> are sent to <i>stderr</i> by
       default, although this can be changed by <a href="../man3/selinux_set_callback.3.html">selinux_set_callback(3)</a>.

       <a href="../man3/selabel_lookup_raw.3.html">selabel_lookup_raw(3)</a> behaves identically to <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a> but
       does not perform context translation.

       The <b>FILES </b>section details the configuration files used to determine a
       file context.
</pre>
<h2><a id="OPTIONS" href="#OPTIONS"></a>OPTIONS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       In addition to the global options described in <a href="../man3/selabel_open.3.html">selabel_open(3)</a>, this
       backend recognizes the following options:

              <b>SELABEL_OPT_PATH</b>
                     A non-null value for this option specifies a path to a
                     file that will be opened in lieu of the standard file
                     contexts file.  This value is also used as the base
                     name for determining the names of local customization
                     files.

              <b>SELABEL_OPT_BASEONLY</b>
                     A non-null value for this option indicates that any
                     local customizations to the file contexts mapping
                     should be ignored.

              <b>SELABEL_OPT_SUBSET</b>
                     A non-null value for this option is interpreted as a
                     path prefix, for example "/etc".  Only file context
                     specifications with starting with a first component
                     that prefix matches the given prefix are loaded.  This
                     may increase lookup performance, however any attempt to
                     look up a path not starting with the given prefix may
                     fail.  This optimization is no longer required due to
                     the use of <i>file_contexts.bin</i> files and is deprecated.
</pre>
<h2><a id="FILES" href="#FILES"></a>FILES  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       The file context files used to retrieve the default context depends
       on the <b>SELABEL_OPT_PATH </b>parameter passed to <a href="../man3/selabel_open.3.html">selabel_open(3)</a>. If <i>NULL</i>,
       then the <b>SELABEL_OPT_PATH </b>value will default to the active policy
       file contexts location (as returned by <a href="../man3/selinux_file_context_path.3.html">selinux_file_context_path(3)</a>),
       otherwise the actual <b>SELABEL_OPT_PATH </b>value specified is used.

       If <b>SELABEL_OPT_BASEONLY </b>is set, then the following files will be
       processed:

              1.  The mandatory file contexts file that is either the fully
                  qualified file name from <i>SELABEL_OPT_PATH.value</i> or if
                  <i>NULL</i>, then the path returned by
                  <a href="../man3/selinux_file_context_path.3.html">selinux_file_context_path(3)</a>.

              2.  The optional local and distribution substitution files
                  that perform path aliasing on the 'in memory' version of
                  the file contexts file.
                  These files have the same name as the mandatory file
                  contexts file with the extensions <i>.subs</i> and <i>.subs_dist</i>
                  added.

       If the <b>SELABEL_OPT_BASEONLY </b>is not set, then the following files will
       be processed:

              1.  The mandatory file contexts file that is either the fully
                  qualified file name from <i>SELABEL_OPT_PATH.value</i> or if
                  <i>NULL</i>, then the path returned by
                  <a href="../man3/selinux_file_context_path.3.html">selinux_file_context_path(3)</a>.

              2.  The optional local customizations file that has the same
                  name as the mandatory file contexts file with the
                  extension <i>.local</i> added.
                  <a href="../man3/selinux_file_context_local_path.3.html">selinux_file_context_local_path(3)</a> will return the default
                  path to this file.

              3.  The optional user home directory customizations file that
                  has the same name as the mandatory file contexts file with
                  the extension <i>.homedirs</i> added.
                  <a href="../man3/selinux_file_context_homedir_path.3.html">selinux_file_context_homedir_path(3)</a> will return the
                  default path to this file.

              4.  The optional local and distribution substitution files
                  that perform any path aliasing on the 'in memory' version
                  of the file contexts file (and the <i>.local</i> and/or <i>.homedirs</i>
                  if present). These files have the same name as the
                  mandatory file contexts file with the extensions <i>.subs</i> and
                  <i>.subs_dist</i> added.
                  <b>selinux_file_context_subs_path</b>(3) and
                  <b>selinux_file_context_subs_dist_path</b>(3) will return the
                  default paths to these files.

       The default file context series of files are:
              <i>/etc/selinux/{SELINUXTYPE}/contexts/files/file_contexts</i>
              <i>/etc/selinux/{SELINUXTYPE}/contexts/files/file_contexts.local</i>
              <i>/etc/selinux/{SELINUXTYPE}/contexts/files/file_contexts.homedirs</i>
              <i>/etc/selinux/{SELINUXTYPE}/contexts/files/file_contexts.subs</i>
              <i>/etc/selinux/{SELINUXTYPE}/contexts/files/file_contexts.subs_dist</i>

       Where <i>{SELINUXTYPE}</i> is the entry from the selinux configuration file
       <i>config</i> (see <a href="selinux_config.5.html">selinux_config(5)</a>).

       Only the <i>file_contexts</i> file is mandatory, the remainder are optional.

       The entries within the file contexts series of files are shown in the
       <b>FILE FORMAT </b>section.
</pre>
<h2><a id="FILE_FORMAT" href="#FILE_FORMAT"></a>FILE FORMAT  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
</pre>
<h2><a id="File_Contexts_Format" href="#File_Contexts_Format"></a>File Contexts Format  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Each line within the <i>file_contexts</i> and the two customization files
       (<i>.local</i> and <i>.homedirs</i>) is as follows:

              <i>pathname [file_type] context</i>

       Where:
              <i>pathname</i>
                     An entry that defines the pathname that may be in the
                     form of a regular expression.
              <i>file_type</i>
                     An optional file type consisting of:
                            <i>-b</i> - Block Device      <i>-c</i> - Character Device
                            <i>-d</i> - Directory         <i>-p</i> - Named Pipe
                            <i>-l</i> - Symbolic Link     <i>-s</i> - Socket
                            <i>--</i> - Ordinary file
              <i>context</i>
                     This entry can be either:

                            a.  The security context that will be assigned
                                to the file (i.e. returned as <i>context</i>).

                            b.  A value of <b>&lt;&lt;none&gt;&gt; </b>can be used to indicate
                                that the matching files should not be re-
                                labeled and causes <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a> to
                                return -1 with <i><a href="../man3/errno.3.html">errno</a></i> set to <b>ENOENT</b>.

       Example:
              # ./contexts/files/file_contexts
              # pathname file_type  context
              /.*                   system_u:object_r:default_t:s0
              /[^/]+        --      system_u:object_r:etc_runtime_t:s0
              /tmp/.*               &lt;&lt;none&gt;&gt;
</pre>
<h2><a id="Substitution_File_Format" href="#Substitution_File_Format"></a>Substitution File Format  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Each line within the substitution files (<i>.subs</i> and <i>.subs_dist</i>) has
       the form:
              <i>subs_pathname pathname</i>

       Where:
              <i>pathname</i>
                     A path that matches an entry in one or more of the file
                     contexts policy configuration file.
              <i>subs_pathname</i>
                     The path that will be aliased (considered equivalent)
                     with pathname by the look up process.

       Example:
              # ./contexts/files/file_contexts.subs
              # pathname  subs_pathname
              /myweb      /var/www
              /myspool    /var/spool/mail

              Using the above example, when <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a> is passed a
              path of <i>/myweb/index.html</i> the function will substitute the
              <i>/myweb</i> component with <i>/var/www</i>, therefore the path used is:

                     <i>/var/www/index.html</i>
</pre>
<h2><a id="NOTES" href="#NOTES"></a>NOTES  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       1.  If contexts are to be validated, then the global option
           <b>SELABEL_OPT_VALIDATE </b>must be set before calling <a href="../man3/selabel_open.3.html">selabel_open(3)</a>.
           If this is not set, then it is possible for an invalid context to
           be returned.

       2.  If the size of file contexts series of files contain many
           entries, then <a href="../man3/selabel_open.3.html">selabel_open(3)</a> may have a delay as it reads in the
           files, and if requested validates the entries.

       3.  Depending on the version of SELinux it is possible that a
           <i>file_contexts.template</i> file may also be present, however this is
           now deprecated.
           The template file has the same format as the <i>file_contexts</i> file
           and may also contain the keywords <b>HOME_ROOT</b>, <b>HOME_DIR</b>, <b>ROLE </b>and
           <b>USER</b>. This functionality has now been moved to the policy store
           and managed by <a href="../man8/semodule.8.html">semodule(8)</a> and <a href="../man8/genhomedircon.8.html">genhomedircon(8)</a>.
</pre>
<h2><a id="SEE_ALSO" href="#SEE_ALSO"></a>SEE ALSO  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <a href="../man8/selinux.8-2.html">selinux(8)</a>, <a href="../man3/selabel_open.3.html">selabel_open(3)</a>, <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a>, <a href="../man3/selabel_stats.3.html">selabel_stats(3)</a>,
       <a href="../man3/selabel_close.3.html">selabel_close(3)</a>, <a href="../man3/selinux_set_callback.3.html">selinux_set_callback(3)</a>,
       <a href="../man3/selinux_file_context_path.3.html">selinux_file_context_path(3)</a>, <a href="../man3/freecon.3.html">freecon(3)</a>, <a href="selinux_config.5.html">selinux_config(5)</a>,
       <a href="../man2/lstat.2.html">lstat(2)</a>, <b>selinux_file_context_subs_path</b>(3),
       <b>selinux_file_context_subs_dist_path</b>(3),
       <a href="../man3/selinux_file_context_homedir_path.3.html">selinux_file_context_homedir_path(3)</a>,
       <a href="../man3/selinux_file_context_local_path.3.html">selinux_file_context_local_path(3)</a>, <a href="../man8/semodule.8.html">semodule(8)</a>, <a href="../man8/genhomedircon.8.html">genhomedircon(8)</a>
</pre>
<h2><a id="COLOPHON" href="#COLOPHON"></a>COLOPHON  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       This page is part of the <i>selinux</i> (Security-Enhanced Linux user-space
       libraries and tools) project.  Information about the project can be
       found at ⟨<a href="https://github.com/SELinuxProject/selinux/wiki">https://github.com/SELinuxProject/selinux/wiki</a>⟩.  If you
       have a bug report for this manual page, see 
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki/Contributing">https://github.com/SELinuxProject/selinux/wiki/Contributing</a>⟩.  This
       page was obtained from the project's upstream Git repository 
       ⟨<a href="https://github.com/SELinuxProject/selinux">https://github.com/SELinuxProject/selinux</a>⟩ on 2017-07-05.  If you
       discover any rendering problems in this HTML version of the page, or
       you believe there is a better or more up-to-date source for the page,
       or you have corrections or improvements to the information in this
       COLOPHON (which is <i>not</i> part of the original manual page), send a mail
       to man-pages@man7.org

<span class="footline">Security Enhanced Linux          01 Dec 2011                 selabel_file(5)</span>
</pre>

<hr class="end-man-text" />
<p>Pages that refer to this page: 
    <a href="../man3/selabel_lookup_best_match.3.html">selabel_lookup_best_match(3)</a>,&nbsp; 
    <a href="../man3/selabel_open.3.html">selabel_open(3)</a>,&nbsp; 
    <a href="../man3/selabel_partial_match.3.html">selabel_partial_match(3)</a>,&nbsp; 
    <a href="../man3/selinux_restorecon_default_handle.3.html">selinux_restorecon_default_handle(3)</a>,&nbsp; 
    <a href="../man8/restorecon_xattr.8.html">restorecon_xattr(8)</a>
</p>
<hr/>

 
<hr class="start-footer" />

<div class="footer"> 

<table class="colophon-table">
    <tr>
    <td class="pub-info">
        <p>
            HTML rendering created 2017-07-13
            by <a href="http://man7.org/mtk/index.html">Michael Kerrisk</a>, 
            author of 
            <a href="http://man7.org/tlpi/"><em>The Linux Programming Interface</em></a>, 
            maintainer of the 
            <a href="https://www.kernel.org/doc/man-pages/">Linux <em>man-pages</em> project</a>.
        </p>
        <p>
            For details of in-depth
            <strong>Linux/UNIX system programming training courses</strong>
            that I teach, look <a href="http://man7.org/training/">here</a>.
        </p>
        <p>
            Hosting by <a href="http://www.jambit.com/index_en.html">jambit GmbH</a>.
        </p>
        <p>
            <a href="http://validator.w3.org/check?uri=referer">
            <img src="http://www.w3.org/Icons/valid-xhtml11"
                alt="Valid XHTML 1.1" height="31" width="88" />
            </a>
        </p>
    </td>
    <td class="colophon-divider">
    </td>
    <td class="tlpi-cover">
        <a href="http://man7.org/tlpi/"><img src="../../../tlpi/cover/TLPI-front-cover-vsmall.png" alt="Cover of TLPI" /></a>
    </td>
    </tr>
</table>

</div>

<hr class="end-footer" />



<!--BEGIN-SITETRACKING-->
<!-- SITETRACKING.man7.org_linux_man-pages -->

<!-- Start of StatCounter Code (xhtml) -->

<script type="text/javascript">
//<![CDATA[
var sc_project=7422636; 
var sc_invisible=1; 
var sc_security="9b6714ff"; 
//]]>
</script>
<script type="text/javascript"
src="../../../../www.statcounter.com/counter/counter_xhtml.js"></script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
class="statcounter"><img class="statcounter"
src="http://c.statcounter.com/7422636/0/9b6714ff/1/"
alt="website statistics" /></a></div></noscript>

<!-- End of StatCounter Code -->


<!-- Start of Google Analytics Code -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9830363-8']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- End of Google Analytics Code -->

<!--END-SITETRACKING-->

</body>
</html>
