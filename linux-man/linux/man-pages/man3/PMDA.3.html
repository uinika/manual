
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
        "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <link rel="stylesheet" type="text/css" href="../../../style.css" title="style" />
    <link rel="stylesheet" type="text/css" href="../style.css" title="style" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />

    <title>pmda(3) - Linux manual page</title>
</head>

<body>

<div class="page-top"><a id="top_of_page"></a></div>
<!--%%%TOP_BAR%%%-->
    <div class="nav-bar">
        <table class="nav-table">
            <tr>
                <td class="nav-cell">
                    <p class="nav-text">
                        <a href="http://man7.org/index.html">man7.org</a> &gt; Linux &gt; <a href="../index.html">man-pages</a>
                    </p>
                </td>
                <td class="training-cell">
                    <p class="training-text"><a class="training-link" href="http://man7.org/training/">Linux/UNIX system programming training</a></p>
                </td>
            </tr>
        </table>
    </div>

<hr class="nav-end" />

<!--%%%PAGE_START%%%-->


<table class="sec-table">
<tr>
    <td>
        <p class="section-dir">
<a href="#NAME">NAME</a> | <a href="#C_SYNOPSIS">C&nbsp;SYNOPSIS</a> | <a href="#DESCRIPTION">DESCRIPTION</a> | <a href="#COMMUNICATING_WITH_PMCD">COMMUNICATING&nbsp;WITH&nbsp;PMCD</a> | <a href="#DEFAULT_CALLBACKS_FOR_HANDLING_PDUs">DEFAULT&nbsp;CALLBACKS&nbsp;FOR&nbsp;HANDLING&nbsp;PDUs</a> | <a href="#INSTANCES_AND_INSTANCE_DOMAINS">INSTANCES&nbsp;AND&nbsp;INSTANCE&nbsp;DOMAINS</a> | <a href="#NAMESPACE">NAMESPACE</a> | <a href="#METRIC_DESCRIPTIONS">METRIC&nbsp;DESCRIPTIONS</a> | <a href="#DSO_PMDA">DSO&nbsp;PMDA</a> | <a href="#DAEMON_PMDA">DAEMON&nbsp;PMDA</a> | <a href="#HELP_TEXT">HELP&nbsp;TEXT</a> | <a href="#INSTALLATION_AND_REMOVAL">INSTALLATION&nbsp;AND&nbsp;REMOVAL</a> | <a href="#INSTALLATION_REFINEMENTS">INSTALLATION&nbsp;REFINEMENTS</a> | <a href="#DIAGNOSTICS">DIAGNOSTICS</a> | <a href="#CAVEAT">CAVEAT</a> | <a href="#FILES">FILES</a> | <a href="#PCP_ENVIRONMENT">PCP&nbsp;ENVIRONMENT</a> | <a href="#SEE_ALSO">SEE&nbsp;ALSO</a> | <a href="#COLOPHON">COLOPHON</a>
        </p>
    </td>
    <td class="search-box">
        <div class="man-search-box">

            <form method="get" action="http://www.google.com/search">
                <fieldset class="man-search">
                    <input type="text" name="q" size="10" maxlength="255" value="" />
                    <input type="hidden" name="sitesearch" value="man7.org/linux/man-pages" />
                    <input type="submit" name="sa" value="Search online pages" />
                </fieldset>
            </form>

        </div>
    </td>
    <td> </td>
</tr>
</table>

<pre>
<span class="headline">PMDA(3)                   Library Functions Manual                   PMDA(3)</span>
</pre>
<h2><a id="NAME" href="#NAME"></a>NAME  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <b>PMDA  </b>-  introduction to the Performance Metrics Domain Agent support
       library
</pre>
<h2><a id="C_SYNOPSIS" href="#C_SYNOPSIS"></a>C SYNOPSIS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <b>#include &lt;pcp/pmapi.h&gt;</b>
       <b>#include &lt;pcp/impl.h&gt;</b>
       <b>#include &lt;pcp/pmda.h&gt;</b>

       <b>cc ... -lpcp_pmda -lpcp</b>
</pre>
<h2><a id="DESCRIPTION" href="#DESCRIPTION"></a>DESCRIPTION  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       To assist in the development of Performance Metric Domain Agents
       (<b>PMDA</b>s) for the Performance Co-Pilot (PCP), a procedural interface is
       provided that extends the Performance Metrics Application Programming
       Interface ( <a href="PMAPI.3.html">PMAPI(3)</a>) library.  These procedures are designed to
       enable a programmer to quickly build a PMDA which can then be tested
       and refined.  However, this also implies that a PMDA has a particular
       structure which may not be suitable for all PMDA implementations.

       Once you are familiar with the PCP and PMDA frameworks, you can
       quickly implement a new PMDA with only a few data structures and
       functions.  This is covered in far greater detail in the <i>Performance</i>
       <i>Co-Pilot Programmer's Guide</i>.

       A PMDA is responsible for a set of performance metrics, in the sense
       that it must respond to requests from <a href="../man1/pmcd.1.html">pmcd(1)</a> for information about
       performance metrics, instance domains, and instantiated values.

       This man page contains sections of the <b>simple PMDA </b>which is located
       at <i>$PCP_PMDAS_DIR</i>/simple.
</pre>
<h2><a id="COMMUNICATING_WITH_PMCD" href="#COMMUNICATING_WITH_PMCD"></a>COMMUNICATING WITH PMCD  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Two approaches may be used for connecting a PMDA to a <a href="../man1/pmcd.1.html">pmcd(1)</a>
       process.  A Dynamic Shared Object (DSO) can be attached by <a href="../man1/pmcd.1.html">pmcd(1)</a>
       using <a href="dlopen.3.html">dlopen(3)</a> when the <a href="../man1/pmcd.1.html">pmcd(1)</a> process is started.  A procedural
       interface referenced through a shared data structure is used to
       handle requests from <a href="../man1/pmcd.1.html">pmcd(1)</a> to the PMDA .

       The preferred approach is for a separate process (daemon) to
       communicate with <a href="../man1/pmcd.1.html">pmcd(1)</a> using the Performance Data Units (PDU)
       Inter-Process Communication (IPC) protocol.

       All PMDAs are launched and controlled by the <a href="../man1/pmcd.1.html">pmcd(1)</a> process on the
       local host.  The requests from the clients are received by <a href="../man1/pmcd.1.html">pmcd(1)</a>
       and forwarded to the appropriate PMDAs.  Responses, when required,
       are returned through <a href="../man1/pmcd.1.html">pmcd(1)</a> to the clients.  The requests (PDUs)
       that may be sent to a PMDA from <a href="../man1/pmcd.1.html">pmcd(1)</a> are <b>PDU_FETCH</b>, <b>PDU_PROFILE</b>,
       <b>PDU_INSTANCE_REQ</b>, <b>PDU_DESC_REQ</b>, <b>PDU_TEXT_REQ </b>and <b>PDU_RESULT</b>.  If the
       PMDA implements any dynamic metrics it may also receive
       <b>PDU_PMNS_CHILD</b>, <b>PDU_PMNS_IDS</b>, <b>PDU_PMNS_NAMES </b>and <b>PDU_PMNS_TRAVERSE</b>
       PDUs.
</pre>
<h2><a id="DEFAULT_CALLBACKS_FOR_HANDLING_PDUs" href="#DEFAULT_CALLBACKS_FOR_HANDLING_PDUs"></a>DEFAULT CALLBACKS FOR HANDLING PDUs  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       To allow a consistent framework, <a href="pmdaMain.3.html">pmdaMain(3)</a> can be used by a daemon
       PMDA to handle the communication protocol using the same callbacks as
       a DSO PMDA.  The structure <b>pmdaInterface </b>is used to convey the common
       procedural interface and state information that is used by <a href="../man1/pmcd.1.html">pmcd(1)</a>
       and a PMDA.  This state information includes tables describing the
       supported metrics and instance domains.

       As most of the procedural interface is identical for all PMDAs, they
       are provided as part of this support library (<a href="pmdaProfile.3.html">pmdaProfile(3)</a>,
       <a href="pmdaFetch.3.html">pmdaFetch(3)</a>, <a href="pmdaInstance.3.html">pmdaInstance(3)</a>, <a href="pmdaDesc.3.html">pmdaDesc(3)</a>, <a href="pmdaText.3.html">pmdaText(3)</a> and
       <a href="pmdaStore.3.html">pmdaStore(3)</a>).  However, these routines require access to the
       <b>pmdaInterface </b>state information so it must be correctly initialized
       using <a href="pmdaConnect.3.html">pmdaConnect(3)</a>, <a href="pmdaDaemon.3.html">pmdaDaemon(3)</a>, <a href="pmdaOpenLog.3.html">pmdaOpenLog(3)</a>, <a href="pmdaDSO.3.html">pmdaDSO(3)</a>,
       <a href="pmdaGetOpt.3.html">pmdaGetOpt(3)</a> and <a href="pmdaInit.3.html">pmdaInit(3)</a>.
</pre>
<h2><a id="INSTANCES_AND_INSTANCE_DOMAINS" href="#INSTANCES_AND_INSTANCE_DOMAINS"></a>INSTANCES AND INSTANCE DOMAINS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Three structures are declared in <i>/usr/include/pcp/pmda.h</i> which
       provide a framework for declaring the metrics and instances supported
       by the PMDA.

       Every instance requires a unique integer identifier and a unique
       name, as defined by the structure <b>pmdaInstid</b>:

            /*
             * Instance description: index and name
             */

            typedef struct {
                int         i_inst;        /* internal instance identifier */
                char        *i_name;       /* external instance identifier */
            } pmdaInstid;

       An instance domain requires its own unique identification (<b>pmInDom</b>),
       the number of instances the domain represents, and a pointer to an
       array of instance descriptions.  This is defined in the structure
       <b>pmdaIndom</b>:

            /*
             * Instance domain description: unique instance id,
             * number of instances in this domain, and the list of
             * instances (not null terminated).
             */

            typedef struct {
                pmInDom     it_indom;       /* indom, filled in */
                int         it_numinst;     /* number of instances */
                pmdaInstid  *it_set;        /* instance identifiers */
            } pmdaIndom;

       The <b>simple PMDA </b>has one instance domain for <i>simple</i>.<i>color</i> with three
       instances (<i>red</i>, <i>green</i> and <i>blue</i>), and a second instance domain for
       <i>simple</i>.<i>now</i> with instances which can be specified at run-time.  These
       instance domains are defined as:

            static pmdaInstid _color[] = {
                { 0, "red" }, { 1, "green" }, { 2, "blue" }
            };
            static pmdaInstid *_timenow = NULL;

            static pmdaIndom indomtab[] = {
            #define COLOR_INDOM 0
                { COLOR_INDOM, 3, _color },
            #define NOW_INDOM 1
                { NOW_INDOM, 0, NULL },
            };

       The preprocessor macros <b>COLOR_INDOM </b>and <b>NOW_INDOM </b>are used in the
       metric description table to identify the instance domains of
       individual metrics.  These correspond to the <i>serial</i> value in the
       instance domain <b>pmInDom </b>structure (the <i>domain</i> field is set by
       <a href="pmdaInit.3.html">pmdaInit(3)</a> at run-time).  The serial value must be unique for each
       instance domain within the PMDA.

       The indom table shown above which is usually passed to <a href="pmdaInit.3.html">pmdaInit(3)</a>
       does not need to be created if one wants to write one's own Fetch and
       Instance functions.  See <a href="pmdaInit.3.html">pmdaInit(3)</a> for more details.
</pre>
<h2><a id="NAMESPACE" href="#NAMESPACE"></a>NAMESPACE  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Every PMDA has its own unique <b>namespace </b>using the format defined in
       <a href="../man5/pmns.5.html">pmns(5)</a>.  In summary, the namespace matches the names of the metrics
       to the unique identifier.  The <b>simple PMDA </b>defines five metrics:
       <i>simple</i>.<i>numfetch</i>, <i>simple</i>.<i>color</i>, <i>simple</i>.<i>time</i>.<i>user, simple</i>.<i>time</i>.<i>sys</i> and
       <i>simple</i>.<i>now</i>.  The namespace for these metrics is defined in
       <i>$PCP_PMDAS_DIR</i>/simple/pmns and is installed as:

            simple {
                numfetch    253:0:0
                color       253:0:1
                time
                now         253:2:4
            }

            simple.time {
                user        253:1:2
                sys         253:1:3
            }

       The domain number of <i>253</i> is obtained from <i>$PCP_VAR_DIR</i>/pmns/stdpmid.
       New PMDAs should specify a unique domain number in this file, and
       obtain the number during installation.  This allows the domain number
       to change by modifying only the file <i>$PCP_VAR_DIR</i>/pmns/stdpmid.

       The <i>simple.time</i> and <i>simple.now</i> metrics are defined in separate
       clusters to the other metrics which allows a PMDA to support more
       than 1024 metrics, as well as grouping similar metrics together.
       Therefore, the item numbers for a new cluster may be identical to the
       item numbers in other clusters.  The <b>simple PMDA </b>continues to
       increment the item numbers to permit direct mapping (see
       <a href="pmdaInit.3.html">pmdaInit(3)</a>).

       The namespace file should be installed and removed with the agent
       using <a href="../man1/pmnsadd.1.html">pmnsadd(1)</a> and <a href="../man1/pmnsdel.1.html">pmnsdel(1)</a>.  See the later sections on
       INSTALLATION and REMOVAL.

       A simple ASCII namespace can be constructed by creating a file
       similar to <i>$PCP_PMDAS_DIR</i>/simple/root:

            /*
             * fake "root" for validating the local PMNS subtree
             */

            #include "$PCP_VAR_DIR/pmns/stdpmid"

            root { simple }

            #include "pmns"

       and can be referred to with the <b>-n </b>option in most PCP tools.
</pre>
<h2><a id="METRIC_DESCRIPTIONS" href="#METRIC_DESCRIPTIONS"></a>METRIC DESCRIPTIONS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Each metric requires a description (<b>pmDesc</b>), which contains its
       Performance Metric Identifier (PMID), data type specification,
       instance domain, semantics and units (see <a href="pmLookupDesc.3.html">pmLookupDesc(3)</a>).  A handle
       is also provided for application specific information in the
       <b>pmdaMetric </b>structure:

            /*
             * Metric description: handle for extending description,
             * and the description.
             */

            typedef struct {
                void*       m_user;         /* for users external use */
                pmDesc      m_desc;         /* metric description */
            } pmdaMetric;

       The <b>simple PMDA </b>defines the metrics as:

            static pmdaMetric metrictab[] = {
            /* numfetch */
                { (void *)0,
                  { PMDA_PMID(0,0), PM_TYPE_U32, PM_INDOM_NULL, PM_SEM_INSTANT,
                    { 0,0,0,0,0,0} }, },
            /* color */
                { (void *)0,
                  { PMDA_PMID(0,1), PM_TYPE_32, COLOR_INDOM, PM_SEM_INSTANT,
                    { 0,0,0,0,0,0} }, },
            /* time.user */
                { (void*)0,
                  { PMDA_PMID(1,2), PM_TYPE_DOUBLE, PM_INDOM_NULL, PM_SEM_COUNTER,
                      { 0, 1, 0, 0, PM_TIME_SEC, 0 } }, },
            /* time.sys */
                { (void*)0,
                  { PMDA_PMID(1,3), PM_TYPE_DOUBLE, PM_INDOM_NULL, PM_SEM_COUNTER,
                      { 0, 1, 0, 0, PM_TIME_SEC, 0 } }, },
            /* now */
                { NULL,
                  { PMDA_PMID(2,4), PM_TYPE_U32, NOW_INDOM, PM_SEM_INSTANT,
                    { 0,0,0,0,0,0 } }, },
            };

       The macro <b>PMDA_PMID </b>(defined in <i>/usr/include/pcp/pmda.h</i>) is used to
       specify each metric's <i>cluster</i> and <i>unit</i> number in the <b>__pmID_int</b>
       structure defined in <i>/usr/include/pcp/impl.h</i>.  As with instance
       domains, the <i>domain</i> field is set by <a href="pmdaInit.3.html">pmdaInit(3)</a> at run-time, however,
       the default domain is assumed to be defined by the PMDA in the macro
       <b>MYDOMAIN</b>.

       The metric table shown above which is usually passed to <a href="pmdaInit.3.html">pmdaInit(3)</a>
       does not need to be created if one wants to write one's own Fetch and
       Descriptor functions.  See <a href="pmdaInit.3.html">pmdaInit(3)</a> for more details.
</pre>
<h2><a id="DSO_PMDA" href="#DSO_PMDA"></a>DSO PMDA  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       A PMDA that is run as a DSO is opened by <a href="../man1/pmcd.1.html">pmcd(1)</a> with <a href="dlopen.3.html">dlopen(3)</a>.
       <a href="../man1/pmcd.1.html">pmcd(1)</a> will call the PMDA's initialization function that is
       specified in <i>$PCP_PMCDCONF_PATH</i>.  This function is passed a pointer
       to a <b>pmdaInterface </b>structure which must be completed.  Any callbacks
       which are <i>not</i> the default PMDA support library callbacks must be
       specified in the <b>pmdaInterface </b>structure.

       The <b>simple PMDA </b>uses its own store and fetch callback.
       <b>simple_fetch</b>() calls <a href="pmdaFetch.3.html">pmdaFetch(3)</a> which requires a callback to be set
       with <a href="pmdaSetFetchCallBack.3.html">pmdaSetFetchCallBack(3)</a> as can be seen in
       <i>$PCP_PMDAS_DIR</i>/simple/simple.c.

       The flag <b>_isDSO </b>is used to determine if the PMDA is a daemon or a DSO
       so that the correct initialization routine, <a href="pmdaDaemon.3.html">pmdaDaemon(3)</a> or
       <a href="pmdaDSO.3.html">pmdaDSO(3)</a>, is called.
</pre>
<h2><a id="DAEMON_PMDA" href="#DAEMON_PMDA"></a>DAEMON PMDA  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       A PMDA that is run as a daemon is forked and executed by <a href="../man1/pmcd.1.html">pmcd(1)</a>.
       Therefore, unlike a DSO PMDA, the starting point for a daemon PMDA is
       <b>main</b>().  The agent should parse the command line arguments, create a
       log file and initialize some data structures that <a href="../man1/pmcd.1.html">pmcd(1)</a> would
       initialize for a DSO agent.

       The <b>pmdaInterface </b>structure must be completely defined by the daemon
       PMDA.  The function <a href="pmdaDaemon.3.html">pmdaDaemon(3)</a> can be called at the start of
       <b>main</b>() to set most of these fields.  Command line parsing can be
       simplified by using <a href="pmdaGetOpt.3.html">pmdaGetOpt(3)</a>, which is similar to <b>getopt</b>(2), but
       extracts a common set of options into the <b>pmdaInterface </b>structure.
       <i>stderr</i> can be mapped to a log file using <a href="pmdaOpenLog.3.html">pmdaOpenLog(3)</a> to simplify
       debugging and error messages.  The connection to <a href="../man1/pmcd.1.html">pmcd(1)</a> can be made
       with <a href="pmdaConnect.3.html">pmdaConnect(3)</a> and the loop which handles the incoming PDUs,
       <a href="pmdaMain.3.html">pmdaMain(3)</a>, should be the last function called.  This can be seen in
       <i>$PCP_PMDAS_DIR</i>/simple/simple.c.

       The <b>simple_init</b>() routine is common to an agent that can be run as
       both a Daemon and DSO PMDA.
</pre>
<h2><a id="HELP_TEXT" href="#HELP_TEXT"></a>HELP TEXT  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Each PMDA must be able to provide <a href="../man1/pmcd.1.html">pmcd(1)</a> with the help text for each
       metric.  Most PMDAs use specially created files with indexes to
       support efficient retrieval of the help text.  Tools are provided
       with PCP to create the help text files of appropriate format. See
       <a href="../man1/newhelp.1.html">newhelp(1)</a>.
</pre>
<h2><a id="INSTALLATION_AND_REMOVAL" href="#INSTALLATION_AND_REMOVAL"></a>INSTALLATION AND REMOVAL  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       A series of shell procedures are defined in
       <i>$PCP_SHARE_DIR</i>/lib/pmdaproc.sh which greatly simplify the
       installation and removal of a PMDA.

       The <i>Install</i> scripts for most PMDAs should only need to specify the
       name of the PMDA in <b>iam</b>, call <b>pmdaSetup </b>which sets up some default
       variables, checks permissions (you have to be ``root'' to install or
       remove a PMDA), checks that you're in the right directory (somewhere
       that ends with /pmdas/<i>$iam</i>), optionally generate the Performance
       Metrics Name Space (PMNS) and PMDA domain number files for Perl or
       Python PMDAs, checks the PMDA domain number is valid, etc., specify
       the communication protocols, and finally call <b>pmdaInstall </b>to do all
       the work of updating the PMNS, updating the <a href="../man1/pmcd.1.html">pmcd(1)</a> control file,
       notifying or restarting <a href="../man1/pmcd.1.html">pmcd(1)</a>,

       Beyond <b>pmdaSetup </b>and <b>pmdaInstall</b>, another optional helper routines is
       <b>pmdaChooseConfigFile </b>that may be used to interactively select or
       create a PMDA-specific configuration file, e.g. <a href="../man1/pmdalogger.1.html">pmdalogger(1)</a>.

       The <i>Remove</i> scripts are even simpler as setting up the communication
       protocols are not required, so set the name of the PMDA in <i>iam</i>, then
       call <b>pmdaSetup </b>followed by a call to <b>pmdaRemove</b>.

       Further information is contained in the
       <i>$PCP_SHARE_DIR</i>/lib/pmdaproc.sh file and the following section.
</pre>
<h2><a id="INSTALLATION_REFINEMENTS" href="#INSTALLATION_REFINEMENTS"></a>INSTALLATION REFINEMENTS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       As outlined below there are a number of variables that can be set in
       a PMDA's <i>Install</i> script to influence the behaviour of the
       installation procedures.  These would typically need to be set before
       the call to <b>pmdaInstall</b>, but in some instances (like <i>$iam</i> and the
       cases specifically noted below), before the call to <b>pmdaSetup</b>.

       The following variables control the communication options between the
       PMDA and <a href="../man1/pmcd.1.html">pmcd(1)</a>.  At least one of <i>$daemon_opt</i>, <i>$dso_opt</i>, <i>$perl_opt</i>
       or <i>$python_opt</i> must be set to define the supported mode(s) of
       communication.  If more than one of these is set the user will be
       prompted to make a selection when the <i>Install</i> script is run.

       <i>daemon_opt</i>      We are willing to install the PMDA as a daemon.
                       Default: true

       <i>dso_opt</i>         We are willing to install the PMDA as a DSO, so
                       <a href="../man1/pmcd.1.html">pmcd(1)</a> will use the dynamic linking loader to attach
                       the PMDA's DSO at run-time and communication from
                       <a href="../man1/pmcd.1.html">pmcd(1)</a> to the PMDA and back uses procedure calls,
                       not an IPC channel.
                       Default: false

       <i>dso_entry</i>       For a DSO PMDA, this is the name of the PMDA's
                       initialization routine.
                       Default: <i>${iam}</i>_init

       <i>dso_name</i>        For a DSO PMDA, this is the full pathanme of the
                       PMDA's DSO file.
                       Default: <i>$PCP_PMDAS_DIR</i>/<i>$iam</i>/pmda_<i>$iam</i>.<i>$dso_suffix</i>

       <i>pipe_opt</i>        For a daemon PMDA, is the default IPC channel via a
                       <a href="../man2/pipe.2.html">pipe(2)</a>?
                       Default: Platform-specific, so <b>true </b>for most, but
                       <b>false </b>for Windows

       <i>perl_opt</i>        We are willing to install the PMDA as a Perl script
                       and <a href="../man1/pmcd.1.html">pmcd(1)</a> will use the <b>perl</b>(1) interpreter to run
                       the PMDA.
                       Default: false

       <i>pmda_dir</i>        Full pathname to the directory where the PMDA's
                       installation files (executable, script, PMNS source,
                       help text source, etc) are to be found.
                       Default: output from pwd(1)

                       If set, must be done before the call to <b>pmdaSetup</b>.

       <i>pmda_name</i>       For a daemon PMDA, this is the name of the PMDA's
                       executable binary relative to the <i>$pmda_dir</i>
                       directory.
                       Default: pmda<i>$iam</i>

       <i>python_opt</i>      We are willing to install the PMDA as a Python script
                       and <a href="../man1/pmcd.1.html">pmcd(1)</a> will use the <b>python</b>(1) interpreter to run
                       the PMDA.
                       Default: false

       <i>pmda_interface</i>  There are multiple versions of the interface protocol
                       between a PMDA and the libpcp_pmda library.  If the
                       PMDA is built to be installed as a daemon or a DSO,
                       it will included a call to <a href="pmdaDaemon.3.html">pmdaDaemon(3)</a> or
                       <a href="pmdaDSO.3.html">pmdaDSO(3)</a>, and the <i>interface</i> argument there will be
                       one of the <b>PMDA_INTERFACE </b>macros from &lt;pcp/pmda.h&gt;.
                       The value that is used there should match the value
                       for <i>pmda_interface</i>.  The value is only used in the
                       installation procedure to determine the format of
                       help text to be generated by <a href="../man1/newhelp.1.html">newhelp(1)</a> and in this
                       context all values of <i>pmda_interface</i> greater than 1
                       are equivalent (the format changed between
                       <b>PMDA_INTERFACE_1 </b>and <b>PMDA_INTERFACE_2</b>).
                       Default: 3

       <i>socket_inet_def</i> For a daemon PMDA using a <a href="../man2/socket.2.html">socket(2)</a> as the IPC
                       channel the default Internet port number or service
                       name (if known).
                       Default: ""

       <i>socket_opt</i>      For a daemon PMDA, is the default IPC channel via a
                       <a href="../man2/socket.2.html">socket(2)</a>?
                       Default: Platform-specific, so <b>false </b>for most, but
                       <b>true </b>for Windows

       The following variables control the PMNS options.

       <i>pmns_dupok</i>      Most PMDAs do not have duplicate names for the same
                       PMID in their PMNS.  But if this is not the case,
                       <i>pmns_dupok</i> should be set to <b>true</b>.
                       Default: false

       <i>pmns_name</i>       Each PMDA will add one or more non-leaf nodes to the
                       top of the PMNS.  The most common case is that all of
                       the metrics for a PMDA will be placed below the node
                       named <i>$iam</i>.  If this is not the case, and especially
                       when the PMDA adds more than one non-leaf node at the
                       top of the PMNS, <i>pmns_name</i> needs to be set to the
                       list of node names (separated by white space), e.g.
                       for <a href="../man1/pmdaproc.1.html">pmdaproc(1)</a> <i>pmns_name</i> is set to "proc cgroup
                       hotproc".
                       Default: <i>$iam</i>

                       It is most important that if <i>pmns_name</i> is set to a
                       non-default value in the <i>Install</i> script then it must
                       also be set to the same value in the <i>Remove</i> script.

       <i>pmns_source</i>     The name of the PMDA's PMNS source file.  By default,
                       the name is interpreted as a relative pathname from
                       the <i>$pmda_dir</i> directory.
                       Default: pmns

       The following variables provide assorted additional options
       associated with the installation of a PMDA.

       <i>args</i>            Additional command line args for the PMDA.  These
                       will be appended to the PMDA's control line in
                       <i>$PCP_PMCDCONF_PATH</i>.
                       Default: ""

       <i>check_delay</i>     Delay (in seconds) after finishing the PMDA
                       installation (or removal) before checking the
                       availability of metrics from the PMDA.  May need to
                       be increased if the PMDA has a lengthy startup
                       procedure.
                       Default: 0.3

       <i>signal_delay</i>    Delay (in seconds) after notifying <a href="../man1/pmcd.1.html">pmcd(1)</a> with a
                       signal.  Required to allow <a href="../man1/pmcd.1.html">pmcd(1)</a> to complete
                       processing before proceeding to the next step of the
                       installation (or removal).
                       Default: 1

       <i>configdir</i>       Determines the directory in which a PMDA's
                       configuration file will be stored.  Used by
                       <b>pmdaChooseConfigFile </b>so should be set before calling
                       that procedure.
                       Default: <i>$PCP_VAR_DIR</i>/config/<i>$iam</i>

       <i>configfile</i>      Preferred configuration file for the PMDA.  Used by
                       <b>pmdaChooseConfigFile </b>so should be set before calling
                       that procedure.
                       Default: ""

       <i>default_configfile</i>
                       Default configuration file for the PMDA.  Used by
                       <b>pmdaChooseConfigFile </b>so should be set before calling
                       that procedure.
                       Default: ""

       <i>dso_suffix</i>      Standard suffix for a DSO.  Should not need to be
                       changed under normal circumstances.
                       Default: Platform-specific, so 'so' for Linux,
                       'dylib' for Mac OS X, 'dll' for Windows, etc.

                       If set, must be done before the call to <b>pmdaSetup</b>.

       <i>help_source</i>     The name of the help text source file that should be
                       used as input to <b>pmnewhelp</b>(1).  By default, the name
                       is interpreted as a relative pathname from the
                       <i>$pmda_dir</i> directory.
                       Default: help

       <i>python_name</i>     Full pathname of the Python script for a Python PMDA.
                       Default: <i>$pmda_dir</i>/pmda<i>$iam</i>.python or
                       <i>$pmda_dir</i>/pmda<i>$iam</i>.py

       The shell procedures in <i>$PCP_SHARE_DIR</i>/lib/pmdaproc.sh manipulate a
       number of temporary files using the variable <i>$tmp</i> as the prefix for
       the name of the temporary files.  <i>$tmp</i> is a directory that is
       created, used and removed internally within the procedures of
       <i>$PCP_SHARE_DIR</i>/lib/pmdaproc.sh but can also be used as the prefix for
       temporary files needed by a PMDA's <i>Install</i> or <i>Remove</i> scripts.  When
       used in this way, <i>$tmp</i> should be followed by a ``/'' and then a
       suffix, e.g. <i>$tmp</i>/myfoo.  The <i>Install</i> and <i>Remove</i> scripts should not
       use other temporary file name prefixes nor use <b>sh</b>(1) <b>trap </b>statements
       to clean up temporary files as this is all done within
       <i>$PCP_SHARE_DIR</i>/lib/pmdaproc.sh.
</pre>
<h2><a id="DIAGNOSTICS" href="#DIAGNOSTICS"></a>DIAGNOSTICS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Any PMDA which uses this library can set <a href="PMAPI.3.html">PMAPI(3)</a> debug control
       variable <b>pmDebug </b>(with -D on the command line) to <b>DBG_TRACE_LIBPMDA</b>
       to enable the display of debugging information which may be useful
       during development (see <a href="../man1/pmdbg.1.html">pmdbg(1)</a>).

       The <i>status</i> field of the <b>pmdaInterface </b>structure should be zero after
       <b>pmdaDaemon</b>, <b>pmdaDSO</b>, <b>pmdaGetOpt</b>, <b>pmdaConnect </b>and <b>pmdaInit </b>are called.
       A value less than zero indicates that initialization has failed.

       Some error messages that are common to most functions in this library
       are:

       <b>PMDA interface version </b><i>interface</i> <b>not supported</b>
                      Most of the functions require that the <i>comm.version</i>
                      field of the <b>pmdaInterface </b>structure be set to
                      <b>PMDA_INTERFACE_2 </b>or later.  <b>PMDA_INTERFACE_2 </b>or
                      <b>PMDA_INTERFACE_3 </b>implies that the <i>version.two</i> fields
                      are correctly initialized, while <b>PMDA_INTERFACE_4</b>
                      implies that the <i>version.four</i> fields are correctly
                      initialized (see <a href="pmdaDaemon.3.html">pmdaDaemon(3)</a> and <a href="pmdaDSO.3.html">pmdaDSO(3)</a>).
</pre>
<h2><a id="CAVEAT" href="#CAVEAT"></a>CAVEAT  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Failing to complete any of the data structures or calling any of the
       library routines out of order may cause unexpected behavior in the
       PMDA.

       Due to changes to the <a href="PMAPI.3.html">PMAPI(3)</a> and <a href="PMDA.3.html">PMDA(3)</a> API in the PCP 2.0
       release, as described in the product release notes, PMDAs built using
       PCP 2.0 must specify <b>PMDA_INTERFACE_2 </b>or later and link with
       <i>libpcp_pmda.so.2</i> and <i>libpcp.so.2</i>.  Pre-existing Daemon PMDAs
       specifying <b>PMDA_PROTOCOL_1 </b>will continue to function using the
       backwards compatible <i>libpcp_pmda.so.1</i> and <i>libpcp.so.1</i> libraries and
       may be recompiled using the headers installed in <i>/usr/include/pcp1.x/</i>
       without any modification.  These backwards compatible headers and
       libraries are contained in the <i>pcp.sw.compat</i> subsystem.
</pre>
<h2><a id="FILES" href="#FILES"></a>FILES  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <i>/usr/include/pcp/pmda.h</i>
                 Header file for the PMDA support library.

       <i>/usr/lib/libpcp_pmda.so</i>
                 Dynamic library containing PMDA support library routines.

       <i>$PCP_PMDAS_DIR</i>/trivial
                 The source of the <b>trivial PMDA</b>.

       <i>$PCP_PMDAS_DIR</i>/simple
                 The source of the <b>simple PMDA</b>.

       <i>$PCP_PMDAS_DIR</i>/txmon
                 The source of the <b>txmon PMDA</b>.

       <i>$PCP_PMCDCONF_PATH</i>
                 Configuration file for <a href="../man1/pmcd.1.html">pmcd(1)</a>.

       <i>$PCP_VAR_DIR</i>/pmns
                 Location of namespace descriptions for every PMDA.

       <i>$PCP_VAR_DIR</i>/pmns/stdpmid
                 The unique domain identifiers for each PMDA.

       <i>$PCP_SHARE_DIR</i>/lib/pmdaproc.sh
                 Shell procedures for installing and removing a PMDA.
</pre>
<h2><a id="PCP_ENVIRONMENT" href="#PCP_ENVIRONMENT"></a>PCP ENVIRONMENT  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Environment variables with the prefix <b>PCP_ </b>are used to parameterize
       the file and directory names used by PCP.  On each installation, the
       file <i>/etc/pcp.conf</i> contains the local values for these variables.
       The <i>$PCP_CONF</i> variable may be used to specify an alternative
       configuration file, as described in <a href="../man5/pcp.conf.5.html">pcp.conf(5)</a>.  Values for these
       variables may be obtained programmatically using the <a href="pmGetConfig.3.html">pmGetConfig(3)</a>
       function.
</pre>
<h2><a id="SEE_ALSO" href="#SEE_ALSO"></a>SEE ALSO  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <a href="../man1/dbpmda.1.html">dbpmda(1)</a>, <a href="../man1/newhelp.1.html">newhelp(1)</a>, <a href="../man1/pmcd.1.html">pmcd(1)</a>, <a href="../man1/pmnsadd.1.html">pmnsadd(1)</a>, <a href="../man1/pmnsdel.1.html">pmnsdel(1)</a>, <a href="PMAPI.3.html">PMAPI(3)</a>,
       <a href="pmdaConnect.3.html">pmdaConnect(3)</a>, <a href="pmdaDaemon.3.html">pmdaDaemon(3)</a>, <a href="pmdaDesc.3.html">pmdaDesc(3)</a>, <a href="pmdaDSO.3.html">pmdaDSO(3)</a>, <a href="pmdaFetch.3.html">pmdaFetch(3)</a>,
       <a href="pmdaGetOpt.3.html">pmdaGetOpt(3)</a>, <a href="pmdaInit.3.html">pmdaInit(3)</a>, <a href="pmdaInstance.3.html">pmdaInstance(3)</a>, <a href="pmdaMain.3.html">pmdaMain(3)</a>,
       <a href="pmdaOpenLog.3.html">pmdaOpenLog(3)</a>, <a href="pmdaProfile.3.html">pmdaProfile(3)</a>, <a href="pmdaStore.3.html">pmdaStore(3)</a>, <a href="pmdaText.3.html">pmdaText(3)</a>,
       <a href="pmLookupDesc.3.html">pmLookupDesc(3)</a> and <a href="../man5/pmns.5.html">pmns(5)</a>.

       For a complete description of the <i>pcp_pmda</i> library and the PMDA
       development process, refer to the Insight book <i>Performance Co-Pilot</i>
       <i>Programmer's Guide</i>.
</pre>
<h2><a id="COLOPHON" href="#COLOPHON"></a>COLOPHON  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       This page is part of the <i>PCP</i> (Performance Co-Pilot) project.
       Information about the project can be found at ⟨<a href="http://www.pcp.io/">http://www.pcp.io/</a>⟩.
       If you have a bug report for this manual page, send it to
       pcp@oss.sgi.com.  This page was obtained from the project's upstream
       Git repository ⟨git://git.pcp.io/pcp⟩ on 2017-07-05.  If you discover
       any rendering problems in this HTML version of the page, or you
       believe there is a better or more up-to-date source for the page, or
       you have corrections or improvements to the information in this
       COLOPHON (which is <i>not</i> part of the original manual page), send a mail
       to man-pages@man7.org

<span class="footline">Performance Co-Pilot                 PCP                             PMDA(3)</span>
</pre>

<hr class="end-man-text" />
<p>Pages that refer to this page: 
    <a href="../man1/dbpmda.1.html">dbpmda(1)</a>,&nbsp; 
    <a href="../man1/genpmda.1.html">genpmda(1)</a>,&nbsp; 
    <a href="../man1/pmdaroot.1.html">pmdaroot(1)</a>,&nbsp; 
    <a href="../man1/pmdasimple.1.html">pmdasimple(1)</a>,&nbsp; 
    <a href="../man1/pmdatrivial.1.html">pmdatrivial(1)</a>,&nbsp; 
    <a href="../man1/pmdatxmon.1.html">pmdatxmon(1)</a>,&nbsp; 
    <a href="../man1/pmdaweblog.1.html">pmdaweblog(1)</a>,&nbsp; 
    <a href="pmapi.3-2.html">pmapi(3)</a>,&nbsp; 
    <a href="pmda.3-2.html">pmda(3)</a>,&nbsp; 
    <a href="pmdaattribute.3-2.html">pmdaattribute(3)</a>,&nbsp; 
    <a href="pmdacache.3.html">pmdacache(3)</a>,&nbsp; 
    <a href="pmdachildren.3-2.html">pmdachildren(3)</a>,&nbsp; 
    <a href="pmdaconnect.3-2.html">pmdaconnect(3)</a>,&nbsp; 
    <a href="pmdadaemon.3-2.html">pmdadaemon(3)</a>,&nbsp; 
    <a href="pmdadesc.3-2.html">pmdadesc(3)</a>,&nbsp; 
    <a href="pmdadso.3-2.html">pmdadso(3)</a>,&nbsp; 
    <a href="pmdaeventarray.3.html">pmdaeventarray(3)</a>,&nbsp; 
    <a href="pmdaeventclient.3.html">pmdaeventclient(3)</a>,&nbsp; 
    <a href="pmdaeventqueue.3.html">pmdaeventqueue(3)</a>,&nbsp; 
    <a href="pmdafetch.3-2.html">pmdafetch(3)</a>,&nbsp; 
    <a href="pmdagetoptions.3-2.html">pmdagetoptions(3)</a>,&nbsp; 
    <a href="pmdahelp.3.html">pmdahelp(3)</a>,&nbsp; 
    <a href="pmdainit.3-2.html">pmdainit(3)</a>,&nbsp; 
    <a href="pmdainstance.3-2.html">pmdainstance(3)</a>,&nbsp; 
    <a href="pmdainterfacemoved.3-2.html">pmdainterfacemoved(3)</a>,&nbsp; 
    <a href="pmdamain.3-2.html">pmdamain(3)</a>,&nbsp; 
    <a href="pmdaname.3-2.html">pmdaname(3)</a>,&nbsp; 
    <a href="pmdaopenlog.3-2.html">pmdaopenlog(3)</a>,&nbsp; 
    <a href="pmdapmid.3-2.html">pmdapmid(3)</a>,&nbsp; 
    <a href="pmdaprofile.3-2.html">pmdaprofile(3)</a>,&nbsp; 
    <a href="pmdarootconnect.3-2.html">pmdarootconnect(3)</a>,&nbsp; 
    <a href="pmdastore.3-2.html">pmdastore(3)</a>,&nbsp; 
    <a href="pmdatext.3-2.html">pmdatext(3)</a>,&nbsp; 
    <a href="pmdatrace.3.html">pmdatrace(3)</a>,&nbsp; 
    <a href="pmjsonget.3-2.html">pmjsonget(3)</a>
</p>
<hr/>

 
<hr class="start-footer" />

<div class="footer"> 

<table class="colophon-table">
    <tr>
    <td class="pub-info">
        <p>
            HTML rendering created 2017-07-13
            by <a href="http://man7.org/mtk/index.html">Michael Kerrisk</a>, 
            author of 
            <a href="http://man7.org/tlpi/"><em>The Linux Programming Interface</em></a>, 
            maintainer of the 
            <a href="https://www.kernel.org/doc/man-pages/">Linux <em>man-pages</em> project</a>.
        </p>
        <p>
            For details of in-depth
            <strong>Linux/UNIX system programming training courses</strong>
            that I teach, look <a href="http://man7.org/training/">here</a>.
        </p>
        <p>
            Hosting by <a href="http://www.jambit.com/index_en.html">jambit GmbH</a>.
        </p>
        <p>
            <a href="http://validator.w3.org/check?uri=referer">
            <img src="http://www.w3.org/Icons/valid-xhtml11"
                alt="Valid XHTML 1.1" height="31" width="88" />
            </a>
        </p>
    </td>
    <td class="colophon-divider">
    </td>
    <td class="tlpi-cover">
        <a href="http://man7.org/tlpi/"><img src="../../../tlpi/cover/TLPI-front-cover-vsmall.png" alt="Cover of TLPI" /></a>
    </td>
    </tr>
</table>

</div>

<hr class="end-footer" />



<!--BEGIN-SITETRACKING-->
<!-- SITETRACKING.man7.org_linux_man-pages -->

<!-- Start of StatCounter Code (xhtml) -->

<script type="text/javascript">
//<![CDATA[
var sc_project=7422636; 
var sc_invisible=1; 
var sc_security="9b6714ff"; 
//]]>
</script>
<script type="text/javascript"
src="../../../../www.statcounter.com/counter/counter_xhtml.js"></script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
class="statcounter"><img class="statcounter"
src="http://c.statcounter.com/7422636/0/9b6714ff/1/"
alt="website statistics" /></a></div></noscript>

<!-- End of StatCounter Code -->


<!-- Start of Google Analytics Code -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9830363-8']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- End of Google Analytics Code -->

<!--END-SITETRACKING-->

</body>
</html>
