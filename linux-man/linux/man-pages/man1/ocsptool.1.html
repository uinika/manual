
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
        "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <link rel="stylesheet" type="text/css" href="../../../style.css" title="style" />
    <link rel="stylesheet" type="text/css" href="../style.css" title="style" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />

    <title>ocsptool(1) - Linux manual page</title>
</head>

<body>

<div class="page-top"><a id="top_of_page"></a></div>
<!--%%%TOP_BAR%%%-->
    <div class="nav-bar">
        <table class="nav-table">
            <tr>
                <td class="nav-cell">
                    <p class="nav-text">
                        <a href="http://man7.org/index.html">man7.org</a> &gt; Linux &gt; <a href="../index.html">man-pages</a>
                    </p>
                </td>
                <td class="training-cell">
                    <p class="training-text"><a class="training-link" href="http://man7.org/training/">Linux/UNIX system programming training</a></p>
                </td>
            </tr>
        </table>
    </div>

<hr class="nav-end" />

<!--%%%PAGE_START%%%-->


<table class="sec-table">
<tr>
    <td>
        <p class="section-dir">
<a href="#NAME">NAME</a> | <a href="#SYNOPSIS">SYNOPSIS</a> | <a href="#DESCRIPTION">DESCRIPTION</a> | <a href="#OPTIONS">OPTIONS</a> | <a href="#EXAMPLES">EXAMPLES</a> | <a href="#EXIT_STATUS">EXIT&nbsp;STATUS</a> | <a href="#SEE_ALSO">SEE&nbsp;ALSO</a> | <a href="#AUTHORS">AUTHORS</a> | <a href="#COPYRIGHT">COPYRIGHT</a> | <a href="#BUGS">BUGS</a> | <a href="#NOTES">NOTES</a> | <a href="#COLOPHON">COLOPHON</a>
        </p>
    </td>
    <td class="search-box">
        <div class="man-search-box">

            <form method="get" action="http://www.google.com/search">
                <fieldset class="man-search">
                    <input type="text" name="q" size="10" maxlength="255" value="" />
                    <input type="hidden" name="sitesearch" value="man7.org/linux/man-pages" />
                    <input type="submit" name="sa" value="Search online pages" />
                </fieldset>
            </form>

        </div>
    </td>
    <td> </td>
</tr>
</table>

<pre>
<span class="headline">ocsptool(1)                     User Commands                    ocsptool(1)</span>
</pre>
<h2><a id="NAME" href="#NAME"></a>NAME  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <b>ocsptool </b>- GnuTLS OCSP tool
</pre>
<h2><a id="SYNOPSIS" href="#SYNOPSIS"></a>SYNOPSIS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <b>ocsptool </b>[<b>-flags</b>] [<b>-flag </b>[<i>value</i>]] [<b>--option-name</b>[[=| ]<i>value</i>]]

       All arguments must be options.
</pre>
<h2><a id="DESCRIPTION" href="#DESCRIPTION"></a>DESCRIPTION  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Ocsptool is a program that can parse and print information about OCSP
       requests/responses, generate requests and verify responses.
</pre>
<h2><a id="OPTIONS" href="#OPTIONS"></a>OPTIONS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <b>-d </b><i>number</i>, <b>--debug</b>=<i>number</i>
              Enable debugging.  This option takes an integer number as its
              argument.  The value of <i>number</i> is constrained to being:
                  in the range  0 through 9999

              Specifies the debug level.

       <b>-V</b>, <b>--verbose</b>
              More verbose output.  This option may appear an unlimited
              number of times.

       <b>--infile</b>=<i>file</i>
              Input file.

       <b>--outfile</b>=<i>string</i>
              Output file.

       <b>--ask </b>[=<i>server name|url</i>]
              Ask an OCSP/HTTP server on a certificate validity.  This
              option must appear in combination with the following options:
              load-cert, load-issuer.

              Connects to the specified HTTP OCSP server and queries on the
              validity of the loaded certificate.

       <b>-e</b>, <b>--verify-response</b>
              Verify response.

       <b>-i</b>, <b>--request-info</b>
              Print information on a OCSP request.

       <b>-j</b>, <b>--response-info</b>
              Print information on a OCSP response.

       <b>-q</b>, <b>--generate-request</b>
              Generate an OCSP request.

       <b>--nonce</b>, <b>--no-nonce</b>
              Use (or not) a nonce to OCSP request.  The <i>no-nonce</i> form will
              disable the option.

       <b>--load-issuer</b>=<i>file</i>
              Read issuer certificate from file.

       <b>--load-cert</b>=<i>file</i>
              Read certificate to check from file.

       <b>--load-trust</b>=<i>file</i>
              Read OCSP trust anchors from file.  This option must not
              appear in combination with any of the following options: load-
              signer.

       <b>--load-signer</b>=<i>file</i>
              Read OCSP response signer from file.  This option must not
              appear in combination with any of the following options: load-
              trust.

       <b>--inder</b>, <b>--no-inder</b>
              Use DER format for input certificates and private keys.  The
              <i>no-inder</i> form will disable the option.

       <b>-Q </b><i>file</i>, <b>--load-request</b>=<i>file</i>
              Read DER encoded OCSP request from file.

       <b>-S </b><i>file</i>, <b>--load-response</b>=<i>file</i>
              Read DER encoded OCSP response from file.

       <b>--ignore-errors</b>
              Ignore any verification errors.

       <b>-h</b>, <b>--help</b>
              Display usage information and exit.

       <b>-!</b>, <b>--more-help</b>
              Pass the extended usage information through a pager.

       <b>-v </b>[{<i>v|c|n</i> <b>--version </b>[{<i>v|c|n</i>}]}]
              Output version of program and exit.  The default mode is `v',
              a simple version.  The `c' mode will print copyright
              information and `n' will print the full copyright notice.
</pre>
<h2><a id="EXAMPLES" href="#EXAMPLES"></a>EXAMPLES  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <b>Print information about an OCSP request</b>

       To parse an OCSP request and print information about the content, the
       <b>-i </b>or <b>--request-info </b>parameter may be used as follows.  The <b>-Q</b>
       parameter specify the name of the file containing the OCSP request,
       and it should contain the OCSP request in binary DER format.

           $ ocsptool -i -Q ocsp-request.der

       The input file may also be sent to standard input like this:

           $ cat ocsp-request.der | ocsptool --request-info

       <b>Print information about an OCSP response</b>

       Similar to parsing OCSP requests, OCSP responses can be parsed using
       the <b>-j </b>or <b>--response-info </b>as follows.

           $ ocsptool -j -Q ocsp-response.der
           $ cat ocsp-response.der | ocsptool --response-info

       <b>Generate an OCSP request</b>

       The <b>-q </b>or <b>--generate-request </b>parameters are used to generate an OCSP
       request.  By default the OCSP request is written to standard output
       in binary DER format, but can be stored in a file using <b>--outfile</b>.
       To generate an OCSP request the issuer of the certificate to check
       needs to be specified with <b>--load-issuer </b>and the certificate to check
       with <b>--load-cert</b>.  By default PEM format is used for these files,
       although <b>--inder </b>can be used to specify that the input files are in
       DER format.

           $ ocsptool -q --load-issuer issuer.pem --load-cert client.pem            --outfile ocsp-request.der

       When generating OCSP requests, the tool will add an OCSP extension
       containing a nonce.  This behaviour can be disabled by specifying
       <b>--no-nonce</b>.

       <b>Verify signature in OCSP response</b>

       To verify the signature in an OCSP response the <b>-e </b>or
       <b>--verify-response </b>parameter is used.  The tool will read an OCSP
       response in DER format from standard input, or from the file
       specified by <b>--load-response</b>.  The OCSP response is verified against
       a set of trust anchors, which are specified using <b>--load-trust</b>.  The
       trust anchors are concatenated certificates in PEM format.  The
       certificate that signed the OCSP response needs to be in the set of
       trust anchors, or the issuer of the signer certificate needs to be in
       the set of trust anchors and the OCSP Extended Key Usage bit has to
       be asserted in the signer certificate.

           $ ocsptool -e --load-trust issuer.pem            --load-response ocsp-response.der

       The tool will print status of verification.

       <b>Verify signature in OCSP response against given certificate</b>

       It is possible to override the normal trust logic if you know that a
       certain certificate is supposed to have signed the OCSP response, and
       you want to use it to check the signature.  This is achieved using
       <b>--load-signer </b>instead of <b>--load-trust</b>.  This will load one
       certificate and it will be used to verify the signature in the OCSP
       response.  It will not check the Extended Key Usage bit.

           $ ocsptool -e --load-signer ocsp-signer.pem            --load-response ocsp-response.der

       This approach is normally only relevant in two situations.  The first
       is when the OCSP response does not contain a copy of the signer
       certificate, so the <b>--load-trust </b>code would fail.  The second is if
       you want to avoid the indirect mode where the OCSP response signer
       certificate is signed by a trust anchor.

       <b>Real-world example</b>

       Here is an example of how to generate an OCSP request for a
       certificate and to verify the response.  For illustration we'll use
       the <b>blog.josefsson.org </b>host, which (as of writing) uses a certificate
       from CACert.  First we'll use <b>gnutls-cli </b>to get a copy of the server
       certificate chain.  The server is not required to send this
       information, but this particular one is configured to do so.

           $ echo | gnutls-cli -p 443 blog.josefsson.org --print-cert &gt; chain.pem

       Use a text editor on <b>chain.pem </b>to create three files for each
       separate certificates, called <b>cert.pem </b>for the first certificate for
       the domain itself, secondly <b>issuer.pem </b>for the intermediate
       certificate and <b>root.pem </b>for the final root certificate.

       The domain certificate normally contains a pointer to where the OCSP
       responder is located, in the Authority Information Access Information
       extension.  For example, from <b>certtool -i &lt; cert.pem </b>there is this
       information:

           Authority Information Access Information (not critical):
           Access Method: 1.3.6.1.5.5.7.48.1 (id-ad-ocsp)
           Access Location URI: <a href="http://ocsp.cacert.org/">http://ocsp.CAcert.org/</a>

       This means the CA support OCSP queries over HTTP.  We are now ready
       to create a OCSP request for the certificate.

           $ ocsptool --ask ocsp.CAcert.org --load-issuer issuer.pem            --load-cert cert.pem --outfile ocsp-response.der

       The request is sent via HTTP to the OCSP server address specified. If
       the address is omitted ocsptool will use the address stored in the
       certificate.
</pre>
<h2><a id="EXIT_STATUS" href="#EXIT_STATUS"></a>EXIT STATUS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       One of the following exit values will be returned:

       0  (EXIT_SUCCESS)
              Successful program execution.

       1  (EXIT_FAILURE)
              The operation failed or the command syntax was not valid.

       70  (EX_SOFTWARE)
              libopts had an internal operational error.  Please report it
              to autogen-users@lists.sourceforge.net.  Thank you.
</pre>
<h2><a id="SEE_ALSO" href="#SEE_ALSO"></a>SEE ALSO  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
           certtool (1)
</pre>
<h2><a id="AUTHORS" href="#AUTHORS"></a>AUTHORS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Nikos Mavrogiannopoulos, Simon Josefsson and others; see
       /usr/share/doc/gnutls/AUTHORS for a complete list.
</pre>
<h2><a id="COPYRIGHT" href="#COPYRIGHT"></a>COPYRIGHT  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Copyright (C) 2000-2017 Free Software Foundation, and others all
       rights reserved.  This program is released under the terms of the GNU
       General Public License, version 3 or later.
</pre>
<h2><a id="BUGS" href="#BUGS"></a>BUGS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       Please send bug reports to: bugs@gnutls.org
</pre>
<h2><a id="NOTES" href="#NOTES"></a>NOTES  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       This manual page was <i>AutoGen</i>-erated from the <b>ocsptool </b>option
       definitions.
</pre>
<h2><a id="COLOPHON" href="#COLOPHON"></a>COLOPHON  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       This page is part of the <i>GnuTLS</i> (GnuTLS Transport Layer Security
       Library) project.  Information about the project can be found at 
       ⟨<a href="http://www.gnutls.org/">http://www.gnutls.org/</a>⟩.  If you have a bug report for this manual
       page, send it to bugs@gnutls.org..  This page was obtained from the
       tarball gnutls-3.5.9.tar.xz fetched from 
       ⟨<a href="http://www.gnutls.org/download.html">http://www.gnutls.org/download.html</a>⟩ on 2017-07-05.  If you discover
       any rendering problems in this HTML version of the page, or you
       believe there is a better or more up-to-date source for the page, or
       you have corrections or improvements to the information in this
       COLOPHON (which is <i>not</i> part of the original manual page), send a mail
       to man-pages@man7.org

<span class="footline">3.5.9                            12 Feb 2017                     ocsptool(1)</span>
</pre>

<hr class="end-man-text" />

 
<hr class="start-footer" />

<div class="footer"> 

<table class="colophon-table">
    <tr>
    <td class="pub-info">
        <p>
            HTML rendering created 2017-07-13
            by <a href="http://man7.org/mtk/index.html">Michael Kerrisk</a>, 
            author of 
            <a href="http://man7.org/tlpi/"><em>The Linux Programming Interface</em></a>, 
            maintainer of the 
            <a href="https://www.kernel.org/doc/man-pages/">Linux <em>man-pages</em> project</a>.
        </p>
        <p>
            For details of in-depth
            <strong>Linux/UNIX system programming training courses</strong>
            that I teach, look <a href="http://man7.org/training/">here</a>.
        </p>
        <p>
            Hosting by <a href="http://www.jambit.com/index_en.html">jambit GmbH</a>.
        </p>
        <p>
            <a href="http://validator.w3.org/check?uri=referer">
            <img src="http://www.w3.org/Icons/valid-xhtml11"
                alt="Valid XHTML 1.1" height="31" width="88" />
            </a>
        </p>
    </td>
    <td class="colophon-divider">
    </td>
    <td class="tlpi-cover">
        <a href="http://man7.org/tlpi/"><img src="../../../tlpi/cover/TLPI-front-cover-vsmall.png" alt="Cover of TLPI" /></a>
    </td>
    </tr>
</table>

</div>

<hr class="end-footer" />



<!--BEGIN-SITETRACKING-->
<!-- SITETRACKING.man7.org_linux_man-pages -->

<!-- Start of StatCounter Code (xhtml) -->

<script type="text/javascript">
//<![CDATA[
var sc_project=7422636; 
var sc_invisible=1; 
var sc_security="9b6714ff"; 
//]]>
</script>
<script type="text/javascript"
src="../../../../www.statcounter.com/counter/counter_xhtml.js"></script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
class="statcounter"><img class="statcounter"
src="http://c.statcounter.com/7422636/0/9b6714ff/1/"
alt="website statistics" /></a></div></noscript>

<!-- End of StatCounter Code -->


<!-- Start of Google Analytics Code -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9830363-8']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- End of Google Analytics Code -->

<!--END-SITETRACKING-->

</body>
</html>
