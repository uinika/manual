
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
        "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <link rel="stylesheet" type="text/css" href="../../../style.css" title="style" />
    <link rel="stylesheet" type="text/css" href="../style.css" title="style" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />

    <title>perf-top(1) - Linux manual page</title>
</head>

<body>

<div class="page-top"><a id="top_of_page"></a></div>
<!--%%%TOP_BAR%%%-->
    <div class="nav-bar">
        <table class="nav-table">
            <tr>
                <td class="nav-cell">
                    <p class="nav-text">
                        <a href="http://man7.org/index.html">man7.org</a> &gt; Linux &gt; <a href="../index.html">man-pages</a>
                    </p>
                </td>
                <td class="training-cell">
                    <p class="training-text"><a class="training-link" href="http://man7.org/training/">Linux/UNIX system programming training</a></p>
                </td>
            </tr>
        </table>
    </div>

<hr class="nav-end" />

<!--%%%PAGE_START%%%-->


<table class="sec-table">
<tr>
    <td>
        <p class="section-dir">
<a href="#NAME">NAME</a> | <a href="#SYNOPSIS">SYNOPSIS</a> | <a href="#DESCRIPTION">DESCRIPTION</a> | <a href="#OPTIONS">OPTIONS</a> | <a href="#INTERACTIVE_PROMPTING_KEYS">INTERACTIVE&nbsp;PROMPTING&nbsp;KEYS</a> | <a href="#OVERHEAD_CALCULATION">OVERHEAD&nbsp;CALCULATION</a> | <a href="#SEE_ALSO">SEE&nbsp;ALSO</a> | <a href="#COLOPHON">COLOPHON</a>
        </p>
    </td>
    <td class="search-box">
        <div class="man-search-box">

            <form method="get" action="http://www.google.com/search">
                <fieldset class="man-search">
                    <input type="text" name="q" size="10" maxlength="255" value="" />
                    <input type="hidden" name="sitesearch" value="man7.org/linux/man-pages" />
                    <input type="submit" name="sa" value="Search online pages" />
                </fieldset>
            </form>

        </div>
    </td>
    <td> </td>
</tr>
</table>

<pre>
<span class="headline">PERF-TOP(1)                      perf Manual                     PERF-TOP(1)</span>
</pre>
<h2><a id="NAME" href="#NAME"></a>NAME  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       perf-top - System profiling tool.
</pre>
<h2><a id="SYNOPSIS" href="#SYNOPSIS"></a>SYNOPSIS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <i>perf top</i> [-e &lt;EVENT&gt; | --event=EVENT] [&lt;options&gt;]
</pre>
<h2><a id="DESCRIPTION" href="#DESCRIPTION"></a>DESCRIPTION  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       This command generates and displays a performance counter profile in
       real time.
</pre>
<h2><a id="OPTIONS" href="#OPTIONS"></a>OPTIONS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       -a, --all-cpus
           System-wide collection. (default)

       -c &lt;count&gt;, --count=&lt;count&gt;
           Event period to sample.

       -C &lt;cpu-list&gt;, --cpu=&lt;cpu&gt;
           Monitor only on the list of CPUs provided. Multiple CPUs can be
           provided as a comma-separated list with no space: 0,1. Ranges of
           CPUs are specified with -: 0-2. Default is to monitor all CPUS.

       -d &lt;seconds&gt;, --delay=&lt;seconds&gt;
           Number of seconds to delay between refreshes.

       -e &lt;event&gt;, --event=&lt;event&gt;
           Select the PMU event. Selection can be a symbolic event name (use
           <i>perf list</i> to list all events) or a raw PMU event (eventsel+umask)
           in the form of rNNN where NNN is a hexadecimal event descriptor.

       -E &lt;entries&gt;, --entries=&lt;entries&gt;
           Display this many functions.

       -f &lt;count&gt;, --count-filter=&lt;count&gt;
           Only display functions with more events than this.

       --group
           Put the counters into a counter group.

       -F &lt;freq&gt;, --freq=&lt;freq&gt;
           Profile at this frequency.

       -i, --inherit
           Child tasks do not inherit counters.

       -k &lt;path&gt;, --vmlinux=&lt;path&gt;
           Path to vmlinux. Required for annotation functionality.

       -m &lt;pages&gt;, --mmap-pages=&lt;pages&gt;
           Number of mmap data pages (must be a power of two) or size
           specification with appended unit character - B/K/M/G. The size is
           rounded up to have nearest pages power of two value.

       -p &lt;pid&gt;, --pid=&lt;pid&gt;
           Profile events on existing Process ID (comma separated list).

       -t &lt;tid&gt;, --tid=&lt;tid&gt;
           Profile events on existing thread ID (comma separated list).

       -u, --uid=
           Record events in threads owned by uid. Name or number.

       -r &lt;priority&gt;, --realtime=&lt;priority&gt;
           Collect data with this RT SCHED_FIFO priority.

       --sym-annotate=&lt;symbol&gt;
           Annotate this symbol.

       -K, --hide_kernel_symbols
           Hide kernel symbols.

       -U, --hide_user_symbols
           Hide user symbols.

       --demangle-kernel
           Demangle kernel symbols.

       -D, --dump-symtab
           Dump the symbol table used for profiling.

       -v, --verbose
           Be more verbose (show counter open errors, etc).

       -z, --zero
           Zero history across display updates.

       -s, --sort
           Sort by key(s): pid, comm, dso, symbol, parent, srcline, weight,
           local_weight, abort, in_tx, transaction, overhead, sample,
           period. Please see description of --sort in the perf-report man
           page.

       --fields=
           Specify output field - multiple keys can be specified in CSV
           format. Following fields are available: overhead, overhead_sys,
           overhead_us, overhead_children, sample and period. Also it can
           contain any sort key(s).

               By default, every sort keys not specified in --field will be appended
               automatically.

       -n, --show-nr-samples
           Show a column with the number of samples.

       --show-total-period
           Show a column with the sum of periods.

       --dsos
           Only consider symbols in these dsos. This option will affect the
           percentage of the overhead column. See --percentage for more
           info.

       --comms
           Only consider symbols in these comms. This option will affect the
           percentage of the overhead column. See --percentage for more
           info.

       --symbols
           Only consider these symbols. This option will affect the
           percentage of the overhead column. See --percentage for more
           info.

       -M, --disassembler-style=
           Set disassembler style for objdump.

       --source
           Interleave source code with assembly code. Enabled by default,
           disable with --no-source.

       --asm-raw
           Show raw instruction encoding of assembly instructions.

       -g
           Enables call-graph (stack chain/backtrace) recording.

       --call-graph [mode,type,min[,limit],order[,key][,branch]]
           Setup and enable call-graph (stack chain/backtrace) recording,
           implies -g. See --call-graph section in perf-record and
           perf-report man pages for details.

       --children
           Accumulate callchain of children to parent entry so that then can
           show up in the output. The output will have a new "Children"
           column and will be sorted on the data. It requires
           -g/--call-graph option enabled. See the ‘overhead calculation’
           section for more details. Enabled by default, disable with
           --no-children.

       --max-stack
           Set the stack depth limit when parsing the callchain, anything
           beyond the specified depth will be ignored. This is a trade-off
           between information loss and faster processing especially for
           workloads that can have a very long callchain stack.

               Default: /proc/sys/kernel/perf_event_max_stack when present, 127 otherwise.

       --ignore-callees=&lt;regex&gt;
           Ignore callees of the function(s) matching the given regex. This
           has the effect of collecting the callers of each such function
           into one place in the call-graph tree.

       --percent-limit
           Do not show entries which have an overhead under that percent.
           (Default: 0).

       --percentage
           Determine how to display the overhead percentage of filtered
           entries. Filters can be applied by --comms, --dsos and/or
           --symbols options and Zoom operations on the TUI (thread, dso,
           etc).

               "relative" means it's relative to filtered entries only so that the
               sum of shown entries will be always 100%. "absolute" means it retains
               the original value before and after the filter is applied.

       -w, --column-widths=&lt;width[,width...]&gt;
           Force each column width to the provided list, for large terminal
           readability. 0 means no limit (default behavior).

       --proc-map-timeout
           When processing pre-existing threads /proc/XXX/mmap, it may take
           a long time, because the file may be huge. A time out is needed
           in such cases. This option sets the time out limit. The default
           value is 500 ms.

       -b, --branch-any
           Enable taken branch stack sampling. Any type of taken branch may
           be sampled. This is a shortcut for --branch-filter any. See
           --branch-filter for more infos.

       -j, --branch-filter
           Enable taken branch stack sampling. Each sample captures a series
           of consecutive taken branches. The number of branches captured
           with each sample depends on the underlying hardware, the type of
           branches of interest, and the executed code. It is possible to
           select the types of branches captured by enabling filters. For a
           full list of modifiers please see the perf record manpage.

               The option requires at least one branch type among any, any_call, any_ret, ind_call, cond.
               The privilege levels may be omitted, in which case, the privilege levels of the associated
               event are applied to the branch filter. Both kernel (k) and hypervisor (hv) privilege
               levels are subject to permissions.  When sampling on multiple events, branch stack sampling
               is enabled for all the sampling events. The sampled branch type is the same for all events.
               The various filters must be specified as a comma separated list: --branch-filter any_ret,u,k
               Note that this feature may not be available on all processors.

       --raw-trace
           When displaying traceevent output, do not use print fmt or
           plugins.

       --hierarchy
           Enable hierarchy output.
</pre>
<h2><a id="INTERACTIVE_PROMPTING_KEYS" href="#INTERACTIVE_PROMPTING_KEYS"></a>INTERACTIVE PROMPTING KEYS  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       [d]
           Display refresh delay.

       [e]
           Number of entries to display.

       [E]
           Event to display when multiple counters are active.

       [f]
           Profile display filter (&gt;= hit count).

       [F]
           Annotation display filter (&gt;= % of total).

       [s]
           Annotate symbol.

       [S]
           Stop annotation, return to full profile display.

       [z]
           Toggle event count zeroing across display updates.

       [qQ]
           Quit.

       Pressing any unmapped key displays a menu, and prompts for input.
</pre>
<h2><a id="OVERHEAD_CALCULATION" href="#OVERHEAD_CALCULATION"></a>OVERHEAD CALCULATION  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       The overhead can be shown in two columns as <i>Children</i> and <i>Self</i> when
       perf collects callchains. The <i>self</i> overhead is simply calculated by
       adding all period values of the entry - usually a function (symbol).
       This is the value that perf shows traditionally and sum of all the
       <i>self</i> overhead values should be 100%.

       The <i>children</i> overhead is calculated by adding all period values of
       the child functions so that it can show the total overhead of the
       higher level functions even if they don’t directly execute much.
       <i>Children</i> here means functions that are called from another (parent)
       function.

       It might be confusing that the sum of all the <i>children</i> overhead
       values exceeds 100% since each of them is already an accumulation of
       <i>self</i> overhead of its child functions. But with this enabled, users
       can find which function has the most overhead even if samples are
       spread over the children.

       Consider the following example; there are three functions like below.

           .ft C
           void foo(void) {
               /* do something */
           }

           void bar(void) {
               /* do something */
               foo();
           }

           int main(void) {
               bar()
               return 0;
           }
           .ft

       In this case <i>foo</i> is a child of <i>bar</i>, and <i>bar</i> is an immediate child of
       <i>main</i> so <i>foo</i> also is a child of <i>main</i>. In other words, <i>main</i> is a parent
       of <i>foo</i> and <i>bar</i>, and <i>bar</i> is a parent of <i>foo</i>.

       Suppose all samples are recorded in <i>foo</i> and <i>bar</i> only. When it’s
       recorded with callchains the output will show something like below in
       the usual (self-overhead-only) output of perf report:

           .ft C
           Overhead  Symbol
           ........  .....................
             60.00%  foo
                     |
                     --- foo
                         bar
                         main
                         __libc_start_main

             40.00%  bar
                     |
                     --- bar
                         main
                         __libc_start_main
           .ft

       When the --children option is enabled, the <i>self</i> overhead values of
       child functions (i.e. <i>foo</i> and <i>bar</i>) are added to the parents to
       calculate the <i>children</i> overhead. In this case the report could be
       displayed as:

           .ft C
           Children      Self  Symbol
           ........  ........  ....................
            100.00%     0.00%  __libc_start_main
                     |
                     --- __libc_start_main

            100.00%     0.00%  main
                     |
                     --- main
                         __libc_start_main

            100.00%    40.00%  bar
                     |
                     --- bar
                         main
                         __libc_start_main

             60.00%    60.00%  foo
                     |
                     --- foo
                         bar
                         main
                         __libc_start_main
           .ft

       In the above output, the <i>self</i> overhead of <i>foo</i> (60%) was add to the
       <i>children</i> overhead of <i>bar</i>, <i>main</i> and <i>__libc_start_main</i>. Likewise, the
       <i>self</i> overhead of <i>bar</i> (40%) was added to the <i>children</i> overhead of <i>main</i>
       and <i>\_\_libc_start_main</i>.

       So <i>\_\_libc_start_main</i> and <i>main</i> are shown first since they have same
       (100%) <i>children</i> overhead (even though they have zero <i>self</i> overhead)
       and they are the parents of <i>foo</i> and <i>bar</i>.

       Since v3.16 the <i>children</i> overhead is shown by default and the output
       is sorted by its values. The <i>children</i> overhead is disabled by
       specifying --no-children option on the command line or by adding
       <i>report.children = false</i> or <i>top.children = false</i> in the perf config
       file.
</pre>
<h2><a id="SEE_ALSO" href="#SEE_ALSO"></a>SEE ALSO  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       <a href="perf-stat.1.html">perf-stat(1)</a>, <a href="perf-list.1.html">perf-list(1)</a>, <a href="perf-report.1.html">perf-report(1)</a>
</pre>
<h2><a id="COLOPHON" href="#COLOPHON"></a>COLOPHON  &nbsp; &nbsp; &nbsp; &nbsp; <a href="#top_of_page"><span class="top-link">top</span></a></h2><pre>
       This page is part of the <i>perf</i> (Performance analysis tools for Linux
       (in Linux source tree)) project.  Information about the project can
       be found at ⟨<a href="https://perf.wiki.kernel.org/index.php/Main_Page">https://perf.wiki.kernel.org/index.php/Main_Page</a>⟩.  If
       you have a bug report for this manual page, send it to
       linux-kernel@vger.kernel.org.  This page was obtained from the
       project's upstream Git repository 
       ⟨<a href="http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git">http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git</a>⟩ on
       2017-07-05.  If you discover any rendering problems in this HTML ver‐
       sion of the page, or you believe there is a better or more up-to-date
       source for the page, or you have corrections or improvements to the
       information in this COLOPHON (which is <i>not</i> part of the original man‐
       ual page), send a mail to man-pages@man7.org

<span class="footline">perf                             02/18/2017                      PERF-TOP(1)</span>
</pre>

<hr class="end-man-text" />
<p>Pages that refer to this page: 
    <a href="perf.1.html">perf(1)</a>,&nbsp; 
    <a href="perf-buildid-list.1.html">perf-buildid-list(1)</a>,&nbsp; 
    <a href="perf-kvm.1.html">perf-kvm(1)</a>,&nbsp; 
    <a href="perf-list.1.html">perf-list(1)</a>,&nbsp; 
    <a href="perf-stat.1.html">perf-stat(1)</a>
</p>
<hr/>

 
<hr class="start-footer" />

<div class="footer"> 

<table class="colophon-table">
    <tr>
    <td class="pub-info">
        <p>
            HTML rendering created 2017-07-13
            by <a href="http://man7.org/mtk/index.html">Michael Kerrisk</a>, 
            author of 
            <a href="http://man7.org/tlpi/"><em>The Linux Programming Interface</em></a>, 
            maintainer of the 
            <a href="https://www.kernel.org/doc/man-pages/">Linux <em>man-pages</em> project</a>.
        </p>
        <p>
            For details of in-depth
            <strong>Linux/UNIX system programming training courses</strong>
            that I teach, look <a href="http://man7.org/training/">here</a>.
        </p>
        <p>
            Hosting by <a href="http://www.jambit.com/index_en.html">jambit GmbH</a>.
        </p>
        <p>
            <a href="http://validator.w3.org/check?uri=referer">
            <img src="http://www.w3.org/Icons/valid-xhtml11"
                alt="Valid XHTML 1.1" height="31" width="88" />
            </a>
        </p>
    </td>
    <td class="colophon-divider">
    </td>
    <td class="tlpi-cover">
        <a href="http://man7.org/tlpi/"><img src="../../../tlpi/cover/TLPI-front-cover-vsmall.png" alt="Cover of TLPI" /></a>
    </td>
    </tr>
</table>

</div>

<hr class="end-footer" />



<!--BEGIN-SITETRACKING-->
<!-- SITETRACKING.man7.org_linux_man-pages -->

<!-- Start of StatCounter Code (xhtml) -->

<script type="text/javascript">
//<![CDATA[
var sc_project=7422636; 
var sc_invisible=1; 
var sc_security="9b6714ff"; 
//]]>
</script>
<script type="text/javascript"
src="../../../../www.statcounter.com/counter/counter_xhtml.js"></script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/"
class="statcounter"><img class="statcounter"
src="http://c.statcounter.com/7422636/0/9b6714ff/1/"
alt="website statistics" /></a></div></noscript>

<!-- End of StatCounter Code -->


<!-- Start of Google Analytics Code -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9830363-8']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- End of Google Analytics Code -->

<!--END-SITETRACKING-->

</body>
</html>
